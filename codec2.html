<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Prevent Flash of Incorrect Theme (FOIT) -->
    <script>
    (function(){var t=localStorage.getItem('android-media-framework-theme');if(t)document.documentElement.setAttribute('data-theme',t);else if(window.matchMedia&&window.matchMedia('(prefers-color-scheme:light)').matches)document.documentElement.setAttribute('data-theme','light');})();
    </script>
    <title>Android Codec 2.0 Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700;900&family=IBM+Plex+Mono:wght@400;500;600&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/design-system.css">

        <style>
        /* Subsection titles (repeated h3 pattern) */
        .subsection-title {
            color: var(--color-accent);
            font-size: 1.5rem;
            margin-top: 2.5rem;
            margin-bottom: 1.25rem;
            font-weight: 600;
            font-family: var(--font-body);
        }
        /* Version history table */
        .version-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .version-table thead tr {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.2));
        }
        .version-table th,
        .version-table td {
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: left;
        }
        .version-table tbody tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.02);
        }
        .version-table .version-label { color: var(--color-text-secondary); font-size: 0.85em; }
        .version-table .text-new { color: #10b981; }
        .version-table .text-deprecated { color: #f59e0b; }
        .version-table .text-info { color: #3b82f6; }
        [data-theme="light"] .version-table th,
        [data-theme="light"] .version-table td {
            border-color: rgba(0, 0, 0, 0.1);
        }
        [data-theme="light"] .version-table thead tr {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(139, 92, 246, 0.15));
        }
        [data-theme="light"] .version-table tbody tr:nth-child(even) {
            background: rgba(0, 0, 0, 0.02);
        }
    </style>
</head>

<body>
    <nav class="nav">
        <a href="index.html" class="nav-button">
            ← AOSP Media Framework
        </a>
    </nav>

    <div class="container">
        <header>
            <h1 class="page-title">⚙️ Codec 2.0</h1>
            <p class="page-subtitle">차세대 Android 미디어 코덱 아키텍처</p>
        </header>

        <!-- Section 1: Overview -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">1</span>
                Overview: Codec 2.0이란?
            </h2>
            <p class="section-description">
                Codec 2.0은 Android Q(10)에서 도입된 차세대 멀티미디어 프레임워크로, 기존 ACodec/OpenMAX를 대체합니다.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🎯</span>
                        주요 목표
                    </h3>
                    <div class="card-description">
                        <p><strong>성능 및 보안 향상</strong></p>
                        <ul>
                            <li>Zero-Copy 버퍼 관리로 성능 향상</li>
                            <li>HAL 기반 보안 강화</li>
                            <li>Mainline 모듈로 독립 업데이트</li>
                            <li>하드웨어 가속 최적화</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔄</span>
                        기존 시스템 대체
                    </h3>
                    <div class="card-description">
                        <p><strong>ACodec + OpenMAX IL 대체</strong></p>
                        <ul>
                            <li>더 단순하고 유연한 API</li>
                            <li>컴포넌트 체이닝 지원</li>
                            <li>필터 플러그인 지원</li>
                            <li>구성 쿼리 기능 향상</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">⚡</span>
                        Zero-Copy 버퍼
                    </h3>
                    <div class="card-description">
                        <p><strong>핵심 성능 최적화</strong></p>
                        <ul>
                            <li>데이터 복사 오버헤드 제거</li>
                            <li>C2Buffer를 통한 효율적 전달</li>
                            <li>C2Allocator로 메모리 관리</li>
                            <li>ION/Gralloc 활용</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔌</span>
                        HAL 인터페이스
                    </h3>
                    <div class="card-description">
                        <p><strong>android.hardware.media.c2</strong></p>
                        <ul>
                            <li>HIDL/AIDL 기반 HAL</li>
                            <li>벤더 구현 분리</li>
                            <li>프로세스 간 통신 최적화</li>
                            <li>독립적인 업데이트 가능</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Architecture -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">2</span>
                전체 아키텍처
            </h2>
            <p class="section-description">
                MediaCodec API부터 하드웨어 코덱까지 Codec 2.0의 전체 구조를 시각화합니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph APP ["Application Layer"]
                    MEDIA_APP[Media App]
                    end

                    subgraph FRAMEWORK ["Android Framework"]
                    MEDIACODEC[MediaCodec API]
                    CCODEC[CCodec<br />Entry Point]
                    BUFFER_CH[CCodecBufferChannel<br />Buffer Delivery]
                    end

                    subgraph CODEC2_CLIENT ["Codec2 Client"]
                    C2_CLIENT[Codec2Client]
                    LISTENER[mClientListener<br />Callbacks]
                    end

                    subgraph HAL ["HAL Interface - android.hardware.media.c2"]
                    HIDL_AIDL[HIDL/AIDL<br />IPC Layer]
                    end

                    subgraph VENDOR ["Vendor Implementation"]
                    COMP_STORE[C2ComponentStore<br />Library Entry Point]
                    C2_COMP[C2Component<br />Encoder/Decoder]
                    C2_INTF[C2Component Interface<br />Configuration]
                    C2_ALLOC[C2Allocator<br />Memory Management]
                    C2_POOL[C2BlockPool<br />Buffer Pool]
                    end

                    subgraph HW ["Hardware"]
                    HW_CODEC[Hardware Codec<br />DSP/GPU]
                    ION[ION Allocator]
                    GRALLOC[Gralloc<br />Graphics Buffer]
                    end

                    MEDIA_APP --> MEDIACODEC
                    MEDIACODEC --> CCODEC
                    CCODEC --> BUFFER_CH
                    CCODEC --> C2_CLIENT
                    C2_CLIENT --> LISTENER
                    C2_CLIENT --> HIDL_AIDL

                    HIDL_AIDL --> COMP_STORE
                    COMP_STORE --> C2_COMP
                    C2_COMP --> C2_INTF
                    C2_COMP --> C2_ALLOC
                    C2_ALLOC --> C2_POOL

                    C2_COMP --> HW_CODEC
                    C2_ALLOC --> ION
                    C2_ALLOC --> GRALLOC

                </div>
            </div>

            <div class="highlight-box">
                <strong>핵심 컴포넌트:</strong>
                <ul>
                    <li><strong>CCodec</strong>: Stagefright와 Codec 2.0 프레임워크 간 인터페이스</li>
                    <li><strong>Codec2Client</strong>: CCodec이 Codec 2.0 컴포넌트와 상호작용하는 클라이언트</li>
                    <li><strong>C2ComponentStore</strong>: 벤더별 코덱 라이브러리 진입점</li>
                    <li><strong>C2Component</strong>: 실제 인코더/디코더 구현체</li>
                    <li><strong>C2Allocator</strong>: Zero-Copy를 위한 메모리 할당 및 관리</li>
                </ul>
            </div>
        </section>

        <!-- Section 3: Component Lifecycle -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">3</span>
                컴포넌트 생명주기
            </h2>
            <p class="section-description">
                C2Component의 생성부터 소멸까지의 전체 생명주기를 설명합니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant App
                    participant MC as MediaCodec
                    participant CC as CCodec
                    participant C2C as Codec2Client
                    participant HAL as HIDL/AIDL
                    participant CS as C2ComponentStore
                    participant COMP as C2Component

                    App->>MC: createByCodecName()
                    MC->>CC: CCodec 생성
                    CC->>C2C: Codec2Client::CreateFromService()
                    C2C->>HAL: HAL Service 연결
                    HAL->>CS: getComponentStore()
                    CS-->>HAL: ComponentStore 반환
                    HAL-->>C2C: Store 반환

                    App->>MC: configure()
                    MC->>CC: configure()
                    CC->>C2C: createComponent()
                    C2C->>HAL: createComponent(name)
                    HAL->>CS: createComponent()
                    CS->>COMP: C2Component 인스턴스 생성
                    COMP-->>CS: Component 반환
                    CS-->>HAL: Component 반환
                    HAL-->>C2C: Component 반환
                    C2C-->>CC: Component 반환

                    CC->>C2C: query() - 파라미터 조회
                    C2C->>COMP: Component Interface 접근
                    COMP-->>C2C: 설정값 반환

                    App->>MC: start()
                    MC->>CC: start()
                    CC->>C2C: start()
                    C2C->>HAL: start()
                    HAL->>COMP: start()

                    loop 데이터 처리
                    App->>MC: queueInputBuffer()
                    MC->>CC: C2Work 생성
                    CC->>C2C: queue(C2Work)
                    C2C->>HAL: queue(work)
                    HAL->>COMP: process(work)
                    COMP->>COMP: 인코딩/디코딩
                    COMP-->>HAL: onWorkDone()
                    HAL-->>C2C: onWorkDone()
                    C2C-->>CC: Listener 콜백
                    CC-->>MC: 출력 버퍼 전달
                    MC-->>App: dequeueOutputBuffer()
                    end

                    App->>MC: stop()
                    MC->>CC: stop()
                    CC->>C2C: stop()
                    C2C->>HAL: stop()
                    HAL->>COMP: stop()

                    App->>MC: release()
                    MC->>CC: release()
                    CC->>C2C: release()
                    C2C->>HAL: release()
                    HAL->>COMP: release()
                    COMP->>COMP: 리소스 정리
                </div>
            </div>
        </section>

        <!-- Section 4: C2Component State Machine -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">4</span>
                C2Component 상태 머신
            </h2>
            <p class="section-description">
                C2Component는 명확한 상태 전환(State Machine) 모델을 따릅니다. 각 상태에서 허용되는 동작이 정의되어 있으며, 잘못된 전환은 에러를 발생시킵니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    stateDiagram-v2
                    [*] --> RELEASED
                    RELEASED --> LOADED : create()
                    LOADED --> RUNNING : start()
                    RUNNING --> LOADED : stop()
                    RUNNING --> RUNNING : flush() / drain()
                    RUNNING --> TRIPPED : 치명적 에러
                    TRIPPED --> LOADED : reset()
                    LOADED --> RELEASED : release()
                    TRIPPED --> RELEASED : release()
                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">⬜</span>
                        RELEASED
                    </h3>
                    <div class="card-description">
                        <p><strong>초기/종료 상태</strong></p>
                        <ul>
                            <li>컴포넌트 인스턴스 미존재</li>
                            <li><code>create()</code>로 LOADED 전환</li>
                            <li>모든 리소스 해제 완료</li>
                            <li>이 상태에서는 <code>query()</code>만 허용</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🟡</span>
                        LOADED
                    </h3>
                    <div class="card-description">
                        <p><strong>설정 가능 상태</strong></p>
                        <ul>
                            <li><code>config()</code>로 파라미터 설정 (해상도, 프로파일 등)</li>
                            <li><code>query()</code>로 지원 능력 조회</li>
                            <li><code>start()</code>로 RUNNING 전환</li>
                            <li><code>release()</code>로 RELEASED 전환</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🟢</span>
                        RUNNING
                    </h3>
                    <div class="card-description">
                        <p><strong>데이터 처리 상태</strong></p>
                        <ul>
                            <li><code>queue()</code>로 C2Work 제출</li>
                            <li><code>flush()</code>: RUNNING 유지하며 대기열 비우기</li>
                            <li><code>drain()</code>: 남은 출력 완료 대기</li>
                            <li><code>stop()</code>으로 LOADED 전환</li>
                            <li>일부 튜닝 파라미터 동적 변경 가능</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔴</span>
                        TRIPPED (에러)
                    </h3>
                    <div class="card-description">
                        <p><strong>에러 복구 대기 상태</strong></p>
                        <ul>
                            <li>HW 크래시, 메모리 부족 등으로 자동 전환</li>
                            <li>데이터 처리(queue) 불가</li>
                            <li><code>reset()</code>으로 LOADED 복구</li>
                            <li><code>release()</code>로 완전 해제</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <strong>💡 상태 전환 핵심 규칙</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>주요 설정 변경은 LOADED에서만</strong>: 해상도, 코덱 프로파일, 색상 포맷 등은 <code>start()</code> 전에 설정</li>
                    <li><strong>flush vs stop</strong>: <code>flush()</code>는 RUNNING 유지하며 대기열만 비움 (Seek 시 사용). <code>stop()</code>은 LOADED로 돌아감</li>
                    <li><strong>TRIPPED 복구</strong>: <code>reset()</code> 후 반드시 <code>config()</code>로 재설정 → <code>start()</code> 순서를 따라야 함</li>
                    <li><strong>MediaCodec 매핑</strong>: MediaCodec의 CONFIGURED/STARTED/ERROR가 C2Component의 LOADED/RUNNING/TRIPPED에 대응</li>
                </ul>
            </div>
        </section>

        <!-- Section 4: Buffer Management -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">5</span>
                Zero-Copy 버퍼 관리
            </h2>
            <p class="section-description">
                Codec 2.0의 핵심 기능인 Zero-Copy 버퍼 메커니즘을 상세히 설명합니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    flowchart TB
                    START[앱에서 인코딩/디코딩 요청] --> ALLOC{버퍼 할당 필요?}

                    ALLOC -->|Yes| C2ALLOC[C2Allocator 호출]
                    C2ALLOC --> POOL[C2BlockPool에서<br />메모리 블록 획득]

                    POOL --> TYPE{버퍼 타입}
                    TYPE -->|Linear| ION_ALLOC[ION Allocator<br />연속 메모리]
                    TYPE -->|Graphic| GRALLOC_ALLOC[Gralloc<br />그래픽 버퍼]

                    ION_ALLOC --> C2BUFFER[C2Buffer 생성]
                    GRALLOC_ALLOC --> C2BUFFER

                    ALLOC -->|No| C2BUFFER

                    C2BUFFER --> C2WORK[C2Work에 C2Buffer 첨부]
                    C2WORK --> QUEUE[Component에 queue]

                    QUEUE --> PROCESS[Component에서 처리]
                    PROCESS --> ZEROCOPY{Zero-Copy 가능?}

                    ZEROCOPY -->|Yes| DIRECT[메모리 직접 접근<br />복사 없음]
                    ZEROCOPY -->|No| COPY[필요시 복사]

                    DIRECT --> OUTPUT[출력 C2Buffer 생성]
                    COPY --> OUTPUT

                    OUTPUT --> RETURN[앱으로 반환]
                    RETURN --> RECYCLE[C2BlockPool로 재활용]
                    RECYCLE --> END[완료]

                </div>
            </div>

            <h3 class="subsection-title">
                🔧 버퍼 관리 컴포넌트
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📦</span>
                        C2Buffer
                    </h3>
                    <div class="card-description">
                        <p><strong>미디어 데이터 컨테이너</strong></p>
                        <ul>
                            <li>오디오/비디오 프레임 담기</li>
                            <li>메타데이터 포함</li>
                            <li>Zero-Copy 지원</li>
                            <li>프로세스 간 전달 가능</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🎛️</span>
                        C2Allocator
                    </h3>
                    <div class="card-description">
                        <p><strong>메모리 할당 관리자</strong></p>
                        <ul>
                            <li>버퍼 메모리 할당</li>
                            <li>재활용 및 상태 추적</li>
                            <li>ION/Gralloc 활용</li>
                            <li>메모리 효율성 최적화</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🏊</span>
                        C2BlockPool
                    </h3>
                    <div class="card-description">
                        <p><strong>버퍼 풀 관리</strong></p>
                        <ul>
                            <li>메모리 블록 풀링</li>
                            <li>빠른 할당/해제</li>
                            <li>메모리 재사용</li>
                            <li>성능 향상</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">⚡</span>
                        Zero-Copy 장점
                    </h3>
                    <div class="card-description">
                        <p><strong>성능 최적화</strong></p>
                        <ul>
                            <li>CPU 사용량 감소</li>
                            <li>메모리 대역폭 절약</li>
                            <li>지연 시간 단축</li>
                            <li>전력 소비 감소</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: C2Component Structure -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">6</span>
                C2Component 구조
            </h2>
            <p class="section-description">
                실제 인코더/디코더를 구현하는 C2Component의 내부 구조를 설명합니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph COMPONENT ["C2Component"]
                    COMP_INTF[C2Component Interface<br />파라미터 설정]
                    COMP_IMPL[Component Implementation<br />실제 코덱 로직]

                    subgraph CONFIG ["Configuration"]
                    PARAMS[C2Param<br />설정 파라미터]
                    QUERY[Query<br />능력 조회]
                    TUNING[Tuning<br />동적 조정]
                    end

                    subgraph PROCESSING ["Processing"]
                    INPUT_Q[Input Queue<br />입력 대기열]
                    WORK_PROC[Work Processor<br />작업 처리]
                    OUTPUT_Q[Output Queue<br />출력 대기열]
                    end

                    subgraph CALLBACKS ["Callbacks"]
                    WORK_DONE[onWorkDone<br />작업 완료]
                    TRIGGERED[onTriggered<br />이벤트 발생]
                    ERROR[onError<br />에러 처리]
                    end
                    end

                    COMP_INTF --> CONFIG
                    COMP_IMPL --> PROCESSING
                    COMP_IMPL --> CALLBACKS

                    INPUT_Q --> WORK_PROC
                    WORK_PROC --> OUTPUT_Q

                    WORK_PROC --> WORK_DONE
                    WORK_PROC --> TRIGGERED
                    WORK_PROC --> ERROR

                </div>
            </div>

            <h3 class="subsection-title">
                🔍 주요 인터페이스
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">⚙️</span>
                        C2Component Interface
                    </h3>
                    <div class="card-description">
                        <p><strong>설정 및 쿼리</strong></p>
                        <ul>
                            <li><code>query()</code>: 파라미터 조회</li>
                            <li><code>config()</code>: 파라미터 설정</li>
                            <li><code>querySupportedParams()</code>: 지원 파라미터 확인</li>
                            <li><code>querySupportedValues()</code>: 지원 값 범위</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔄</span>
                        Work Processing
                    </h3>
                    <div class="card-description">
                        <p><strong>데이터 처리</strong></p>
                        <ul>
                            <li><code>queue()</code>: C2Work 제출</li>
                            <li><code>flush()</code>: 대기열 비우기</li>
                            <li><code>drain()</code>: 출력 완료 대기</li>
                            <li><code>start()</code> / <code>stop()</code>: 상태 제어</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📊</span>
                        C2Param
                    </h3>
                    <div class="card-description">
                        <p><strong>파라미터 타입</strong></p>
                        <ul>
                            <li>비트레이트, 프레임레이트</li>
                            <li>해상도, 색상 포맷</li>
                            <li>프로파일, 레벨</li>
                            <li>버퍼 크기, 지연 시간</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🎯</span>
                        Listener Callbacks
                    </h3>
                    <div class="card-description">
                        <p><strong>이벤트 알림</strong></p>
                        <ul>
                            <li><code>onWorkDone()</code>: 작업 완료</li>
                            <li><code>onTriggered()</code>: 트리거 이벤트</li>
                            <li><code>onError()</code>: 에러 발생</li>
                            <li><code>onFramesRendered()</code>: 프레임 렌더링</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 7: C2 Filter Plugin Architecture -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">7</span>
                C2 Filter Plugin 아키텍처
            </h2>
            <p class="section-description">
                Codec 2.0은 디코더/인코더 출력에 필터 컴포넌트를 체이닝하여 후처리를 수행할 수 있는 플러그인 시스템을 제공합니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    flowchart LR
                    subgraph INPUT["입력"]
                        STREAM["압축 스트림"]
                    end
                    subgraph DECODE["디코딩"]
                        DECODER["C2 Decoder"]
                    end
                    subgraph FILTERS["Filter Chain"]
                        F1["Filter 1<br/>HDR to SDR"]
                        F2["Filter 2<br/>Color Convert"]
                        F3["Filter 3<br/>Scale/Crop"]
                    end
                    subgraph OUTPUT["출력"]
                        SURFACE["Surface"]
                    end
                    STREAM --> DECODER
                    DECODER --> F1
                    F1 --> F2
                    F2 --> F3
                    F3 --> SURFACE
                </div>
            </div>

            <h3 class="subsection-title">
                🔌 주요 필터 유형
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🌈</span>
                        HDR → SDR Tone Mapping
                    </h3>
                    <div class="card-description">
                        <p><strong>디스플레이 호환성 보장</strong></p>
                        <ul>
                            <li>HDR10/HLG/Dolby Vision → SDR 변환</li>
                            <li>AOSP 기본 톤매핑 필터 제공</li>
                            <li>벤더 GPU 가속 구현 가능</li>
                            <li>Android 13+에서 자동 적용</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🎨</span>
                        Color Space Conversion
                    </h3>
                    <div class="card-description">
                        <p><strong>색공간 변환</strong></p>
                        <ul>
                            <li>YUV ↔ RGB 변환</li>
                            <li>BT.601 / BT.709 / BT.2020 간 변환</li>
                            <li>10-bit → 8-bit 다운샘플링</li>
                            <li>Gralloc 버퍼 포맷 호환성 보장</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📐</span>
                        Scale / Crop / Rotate
                    </h3>
                    <div class="card-description">
                        <p><strong>공간 변환</strong></p>
                        <ul>
                            <li>해상도 스케일링 (업/다운)</li>
                            <li>Crop 영역 지정</li>
                            <li>회전/미러링 (AAOS 카메라 등)</li>
                            <li>GPU 또는 DPU 하드웨어 가속</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔊</span>
                        오디오 이펙트
                    </h3>
                    <div class="card-description">
                        <p><strong>오디오 후처리</strong></p>
                        <ul>
                            <li>다운믹싱 (5.1ch → 2ch)</li>
                            <li>샘플레이트 변환</li>
                            <li>볼륨/이퀄라이저 적용</li>
                            <li>Dolby Audio 효과 체인</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 class="subsection-title">
                ⚙️ 필터 등록 및 적용
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📝</span>
                        필터 선언 (media_codecs.xml)
                    </h3>
                    <div class="card-description">
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>&lt;MediaCodecs&gt;
    &lt;Settings&gt;
        &lt;Setting name="supports-hdr-editing"
                 value="true" /&gt;
    &lt;/Settings&gt;
    &lt;Decoders&gt;
        &lt;MediaCodec
            name="c2.vendor.filter.tonemapper"
            type="video/raw"
            kind="filter"&gt;
            &lt;Alias name="c2.tonemapper" /&gt;
        &lt;/MediaCodec&gt;
    &lt;/Decoders&gt;
&lt;/MediaCodecs&gt;</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔗</span>
                        필터 체이닝 원리
                    </h3>
                    <div class="card-description">
                        <p><strong>Zero-Copy 체인</strong></p>
                        <ul>
                            <li>필터는 일반 C2Component와 동일한 인터페이스</li>
                            <li>C2Buffer가 필터 간 Zero-Copy로 전달</li>
                            <li>CCodec이 자동으로 필터 체인 구성</li>
                            <li>필터 순서는 시스템이 결정 (종류 기반)</li>
                        </ul>
                        <p style="margin-top: 12px; padding: 10px; background: rgba(59, 130, 246, 0.1); border-left: 3px solid #3b82f6; font-size: 0.9em;">
                            <strong>참고</strong>: 필터 플러그인은 Android 12에서 도입되어 Android 13+에서 안정화되었습니다. 벤더 필터는 <code>C2ComponentStore</code>에 <code>kind="filter"</code>로 등록합니다.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6: HAL Communication -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">8</span>
                HAL 통신 메커니즘
            </h2>
            <p class="section-description">
                HIDL/AIDL을 통한 프레임워크와 벤더 구현 간 통신 방식을 설명합니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant FC as Framework<br />Codec2Client
                    participant HIDL as HIDL/AIDL<br />Binder IPC
                    participant VS as Vendor Service<br />C2ComponentStore
                    participant VC as Vendor<br />C2Component

                    Note over FC,VC: 컴포넌트 생성
                    FC->>HIDL: createComponent(name)
                    HIDL->>VS: createComponent()
                    VS->>VC: new C2Component()
                    VC-->>VS: Component 인스턴스
                    VS-->>HIDL: IComponent 반환
                    HIDL-->>FC: Component Proxy

                    Note over FC,VC: 파라미터 설정
                    FC->>HIDL: config(params)
                    HIDL->>HIDL: 데이터 직렬화
                    HIDL->>VC: config()
                    VC->>VC: 파라미터 적용
                    VC-->>HIDL: 결과
                    HIDL->>HIDL: 데이터 역직렬화
                    HIDL-->>FC: 설정 완료

                    Note over FC,VC: Work 처리
                    FC->>HIDL: queue(workBundle)
                    HIDL->>HIDL: C2Work 직렬화<br />C2Buffer FD 전달
                    HIDL->>VC: queue()
                    VC->>VC: 인코딩/디코딩
                    VC->>HIDL: onWorkDone()
                    HIDL->>HIDL: 결과 직렬화
                    HIDL->>FC: Listener 콜백
                    FC->>FC: 출력 처리
                </div>
            </div>

            <h3 class="subsection-title">
                🔌 HAL 인터페이스 계층
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📡</span>
                        HIDL (Legacy)
                    </h3>
                    <div class="card-description">
                        <p><strong>Hardware Interface Definition Language</strong></p>
                        <ul>
                            <li>Android 10~12에서 주로 사용</li>
                            <li>Binderized HAL</li>
                            <li>프로세스 간 통신</li>
                            <li>안정적인 ABI</li>
                            <li><span style="color: #94a3b8; font-size: 0.9em;">현재도 호환 가능</span></li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🆕</span>
                        AIDL (Current)
                    </h3>
                    <div class="card-description">
                        <p><strong>Android Interface Definition Language</strong></p>
                        <ul>
                            <li><strong>Android 11</strong>: Stable AIDL 도입</li>
                            <li><strong>Android 13+</strong>: HIDL→AIDL 전환 권장</li>
                            <li>향상된 안정성 및 유연성</li>
                            <li>간소화된 구문</li>
                            <li>하위 호환성 유지</li>
                        </ul>
                        <p style="margin-top: 8px; padding: 8px; background: rgba(16, 185, 129, 0.1); border-left: 3px solid #10b981; font-size: 0.85em;">
                            <strong>참고</strong>: OEM은 HIDL과 AIDL 중 선택 가능. AIDL 전환은 권장이지만 필수 아님.
                        </p>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔄</span>
                        데이터 직렬화
                    </h3>
                    <div class="card-description">
                        <p><strong>프로세스 간 데이터 전달</strong></p>
                        <ul>
                            <li>C2Param 직렬화</li>
                            <li>C2Buffer FD 공유</li>
                            <li>Zero-Copy 유지</li>
                            <li>효율적인 IPC</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🛡️</span>
                        보안 및 격리
                    </h3>
                    <div class="card-description">
                        <p><strong>프로세스 분리</strong></p>
                        <ul>
                            <li>벤더 프로세스 격리</li>
                            <li>크래시 영향 최소화</li>
                            <li>권한 분리</li>
                            <li>SELinux 정책 적용</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 7: Codec 2.0 vs OMX -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">9</span>
                Codec 2.0 vs OpenMAX 비교
            </h2>
            <p class="section-description">
                기존 OpenMAX IL과 Codec 2.0의 주요 차이점을 비교합니다.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔴</span>
                        OpenMAX IL (Legacy)
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>버퍼 관리</strong>: 복사 기반, 성능 오버헤드</li>
                            <li><strong>API</strong>: 복잡하고 경직된 구조</li>
                            <li><strong>업데이트</strong>: OS 업데이트 필요</li>
                            <li><strong>확장성</strong>: 제한적</li>
                            <li><strong>HAL</strong>: 직접 통합, 보안 취약</li>
                            <li><strong>필터</strong>: 지원 제한적</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🟢</span>
                        Codec 2.0 (Modern)
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>버퍼 관리</strong>: Zero-Copy, 고성능</li>
                            <li><strong>API</strong>: 단순하고 유연한 구조</li>
                            <li><strong>업데이트</strong>: Mainline 모듈, 독립 업데이트</li>
                            <li><strong>확장성</strong>: 컴포넌트 체이닝, 플러그인</li>
                            <li><strong>HAL</strong>: HIDL/AIDL 기반, 보안 강화</li>
                            <li><strong>필터</strong>: 필터 플러그인 지원 (HDR→SDR 등)</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="warning-box">
                <strong>⚠️ 마이그레이션 고려사항:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>Android 9 (Pie)</strong>: Codec 2.0 도입</li>
                    <li><strong>Android 10 (Q)</strong>: Codec 2.0이 기본값으로 설정</li>
                    <li><strong>Android 11 (R)</strong>: Codec 2.0 완전 전환 권장</li>
                    <li><strong>Android 12 (S)+</strong>: OMX IL <span style="color: #f59e0b;">deprecated</span>, vendor 파티션에서 여전히 사용 가능</li>
                    <li>기존 OMX 코덱은 <code>OMXStore</code> 호환성 레이어를 통해 계속 동작 (legacy 지원)</li>
                    <li>새로운 하드웨어 코덱은 Codec 2.0으로 구현 <strong>필수</strong> (Android 13+)</li>
                    <li>벤더는 <code>C2ComponentStore</code>를 통해 코덱 노출</li>
                </ul>
                <p style="margin-top: 12px; padding: 10px; background: rgba(245, 158, 11, 0.1); border-left: 3px solid #f59e0b; font-size: 0.95rem; line-height: 1.6;">
                    <strong>참고</strong>: OMX IL의 완전 제거 시점은 명확하지 않으며, vendor 파티션에서 레거시 지원을 위해 계속 유지될 수 있습니다.
                    AOSP Media Modules 문서(<a href="https://source.android.com/docs/core/media/media-modules" style="color: #60a5fa;">링크</a>)를 참조하세요.
                </p>
            </div>

            <h3 class="subsection-title">
                📊 Android 버전별 미디어 코덱 API 변천사
            </h3>
            <div style="overflow-x: auto;">
                <table class="version-table">
                    <thead>
                        <tr>
                            <th>Android 버전</th>
                            <th>코덱 스택</th>
                            <th>HAL 인터페이스</th>
                            <th>주요 변경사항</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Android 7.0 (Nougat)</strong><br><small class="version-label">API 24</small></td>
                            <td>OMX IL 1.1.2</td>
                            <td>직접 연결</td>
                            <td>
                                • MediaCodec 샌드박싱 도입<br>
                                • 프로세스 분리 강화
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Android 8.0 (Oreo)</strong><br><small class="version-label">API 26</small></td>
                            <td>OMX IL (Legacy)</td>
                            <td><span class="text-new">HIDL 1.0</span></td>
                            <td>
                                • <strong>Project Treble</strong> 도입<br>
                                • Binderized HAL (HIDL)
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Android 9.0 (Pie)</strong><br><small class="version-label">API 28</small></td>
                            <td><span class="text-info">Codec 2.0 도입</span></td>
                            <td>HIDL 1.0/1.1</td>
                            <td>
                                • Codec 2.0 첫 도입 (선택사항)<br>
                                • Zero-Copy 버퍼 관리
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Android 10 (Q)</strong><br><small class="version-label">API 29</small></td>
                            <td><span class="text-new">Codec 2.0 기본값</span></td>
                            <td>HIDL 1.1/1.2</td>
                            <td>
                                • <strong>Project Mainline</strong> 도입<br>
                                • Media APEX 모듈 독립 업데이트
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Android 11 (R)</strong><br><small class="version-label">API 30</small></td>
                            <td>Codec 2.0</td>
                            <td>HIDL 1.2 / <span class="text-new">AIDL</span></td>
                            <td>
                                • <strong>Stable AIDL</strong> 도입<br>
                                • Codec 2.0 완전 전환 권장
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Android 12 (S)</strong><br><small class="version-label">API 31</small></td>
                            <td>Codec 2.0</td>
                            <td>HIDL/AIDL 혼용</td>
                            <td>
                                • <span class="text-deprecated">OMX IL deprecated</span><br>
                                • vendor 파티션에서 여전히 지원
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Android 13 (T)</strong><br><small class="version-label">API 33</small></td>
                            <td>Codec 2.0 완전 전환</td>
                            <td><span class="text-new">AIDL 권장</span></td>
                            <td>
                                • HIDL→AIDL 전환 권장 시작<br>
                                • 새 HW 코덱 Codec 2.0 필수
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Android 14 (U)</strong><br><small class="version-label">API 34</small></td>
                            <td>Codec 2.0</td>
                            <td>AIDL</td>
                            <td>
                                • AIDL 안정화<br>
                                • Media3 통합 강화
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="highlight-box" style="margin-top: 20px;">
                <strong>💡 Key Insights</strong><br>
                • <strong>Android 9</strong>: Codec 2.0 첫 도입 (선택사항)<br>
                • <strong>Android 10</strong>: Codec 2.0 기본값 + Mainline 모듈화<br>
                • <strong>Android 11</strong>: Stable AIDL 도입 (HIDL과 병행)<br>
                • <strong>Android 12</strong>: OMX IL deprecated (완전 제거 아님)<br>
                • <strong>Android 13+</strong>: AIDL 전환 권장 + Codec 2.0 필수
            </div>
        </section>

        <!-- Section 10: Codec Selection Algorithm -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">10</span>
                코덱 선택 메커니즘
            </h2>
            <p class="section-description">
                여러 코덱이 등록된 환경에서 시스템이 최적의 코덱을 선택하는 알고리즘과 기준을 설명합니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    flowchart TB
                    START["MediaCodec.createDecoderByType(mime)"] --> LIST["MediaCodecList에서<br/>mime 매칭 코덱 검색"]
                    LIST --> RANK["media_codecs.xml<br/>선언 순서대로 정렬"]
                    RANK --> HW_CHECK{HW 코덱<br/>사용 가능?}
                    HW_CHECK -->|Yes| HW_SELECT["HW 코덱 선택<br/>c2.vendor.*.decoder"]
                    HW_CHECK -->|No| SW_SELECT["SW 코덱 폴백<br/>c2.android.*.decoder"]
                    HW_SELECT --> SECURE_CHECK{Secure 재생<br/>필요?}
                    SECURE_CHECK -->|Yes| SECURE["Secure 코덱<br/>*.decoder.secure"]
                    SECURE_CHECK -->|No| INIT["코덱 인스턴스 생성"]
                    SECURE --> INIT
                    SW_SELECT --> INIT
                    INIT --> CONFIGURE["configure&#40;&#41; 호출"]
                </div>
            </div>

            <h3 class="subsection-title">
                📋 선택 기준 및 우선순위
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📑</span>
                        media_codecs.xml 순서
                    </h3>
                    <div class="card-description">
                        <p><strong>선언 순서 = 우선순위</strong></p>
                        <ul>
                            <li>XML에 먼저 선언된 코덱이 높은 우선순위</li>
                            <li>벤더 XML이 플랫폼 XML보다 먼저 로드</li>
                            <li>동일 mime에 여러 코덱이 있으면 순서대로 시도</li>
                            <li><code>MediaCodecList.getCodecInfos()</code>로 전체 순서 확인</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">⚡</span>
                        HW vs SW 코덱
                    </h3>
                    <div class="card-description">
                        <p><strong>하드웨어 우선 정책</strong></p>
                        <ul>
                            <li><strong>HW</strong>: <code>c2.vendor.*</code>, <code>c2.qcom.*</code>, <code>c2.exynos.*</code></li>
                            <li><strong>SW</strong>: <code>c2.android.*</code> (AOSP 기본 제공)</li>
                            <li>HW 코덱이 항상 우선 선택됨</li>
                            <li>HW 실패 시 자동으로 SW 폴백</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🎯</span>
                        명시적 선택
                    </h3>
                    <div class="card-description">
                        <p><strong>createByCodecName() 사용</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>// 특정 코덱 직접 지정
val decoder = MediaCodec
    .createByCodecName(
        "c2.android.avc.decoder"
    )

// 코덱 목록 조회
val list = MediaCodecList(
    MediaCodecList.ALL_CODECS)
for (info in list.codecInfos) {
    Log.d(TAG, "${info.name}")
}</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔍</span>
                        능력 확인
                    </h3>
                    <div class="card-description">
                        <p><strong>CodecCapabilities 조회</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>val caps = codecInfo
    .getCapabilitiesForType(
        "video/avc")
val vc = caps.videoCapabilities

Log.d(TAG,
  "Max: ${vc.supportedWidths.upper}" +
  "x${vc.supportedHeights.upper}")
Log.d(TAG,
  "FPS: ${vc.supportedFrameRates.upper}"
)</code></pre>
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <strong>💡 코덱 네이밍 규칙</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><code>c2.android.*</code>: AOSP 플랫폼 소프트웨어 코덱</li>
                    <li><code>c2.vendor.*</code> / <code>c2.{chipset}.*</code>: 벤더 하드웨어 코덱 (예: <code>c2.qcom.avc.decoder</code>)</li>
                    <li><code>*.secure</code> 접미사: DRM 보호 콘텐츠용 Secure 코덱</li>
                    <li><code>*.encoder</code> / <code>*.decoder</code>: 인코더/디코더 구분</li>
                    <li><code>OMX.*</code>: 레거시 OpenMAX 코덱 (호환성 레이어)</li>
                </ul>
            </div>
        </section>

        <!-- Section 11: Media Resource Management -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">11</span>
                미디어 리소스 관리
            </h2>
            <p class="section-description">
                다중 앱/세션에서 제한된 HW 코덱 리소스를 관리하는 MediaResourceManager의 동작 방식을 설명합니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant A as App A (Foreground)
                    participant B as App B (Background)
                    participant RM as ResourceManager
                    participant HW as HW Codec

                    A->>RM: codec 요청 (video/avc)
                    RM->>HW: allocate()
                    HW-->>RM: codec_1
                    RM-->>A: codec_1 할당

                    B->>RM: codec 요청 (video/avc)
                    RM->>HW: allocate()
                    HW-->>RM: codec_2
                    RM-->>B: codec_2 할당

                    Note over RM,HW: HW 코덱 인스턴스 소진

                    A->>RM: 추가 codec 요청 (video/hevc)
                    RM->>RM: 리소스 부족 + 우선순위 비교
                    RM->>B: onCodecReclaimed()
                    B-->>HW: release(codec_2)
                    RM->>HW: allocate()
                    HW-->>RM: codec_3
                    RM-->>A: codec_3 할당
                </div>
            </div>

            <h3 class="subsection-title">
                🏗️ 리소스 관리 구성 요소
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🎛️</span>
                        MediaResourceManager
                    </h3>
                    <div class="card-description">
                        <p><strong>중앙 리소스 관리 서비스</strong></p>
                        <ul>
                            <li><code>media.resource_manager</code> 시스템 서비스</li>
                            <li>모든 코덱 인스턴스 할당/해제 추적</li>
                            <li>리소스 부족 시 회수(Reclaim) 정책 실행</li>
                            <li><code>dumpsys media.resource_manager</code>로 상태 확인</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📊</span>
                        우선순위 정책
                    </h3>
                    <div class="card-description">
                        <p><strong>프로세스 중요도 기반</strong></p>
                        <ul>
                            <li><strong>Foreground App</strong>: 최고 우선순위</li>
                            <li><strong>Visible App</strong>: PiP, 분할 화면</li>
                            <li><strong>Service</strong>: 백그라운드 서비스</li>
                            <li><strong>Background App</strong>: 최저 우선순위</li>
                            <li>동일 우선순위: 먼저 할당된 세션이 유지</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">♻️</span>
                        코덱 회수 (Reclaim)
                    </h3>
                    <div class="card-description">
                        <p><strong>리소스 부족 시 동작</strong></p>
                        <ul>
                            <li>높은 우선순위 앱이 코덱 요청 시 발동</li>
                            <li>낮은 우선순위 앱의 코덱을 강제 해제</li>
                            <li><code>onError(RESOURCE_RECLAIMED)</code> 콜백 전달</li>
                            <li>해제된 앱은 재생 중단 또는 SW 폴백 필요</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔢</span>
                        인스턴스 제한
                    </h3>
                    <div class="card-description">
                        <p><strong>HW 코덱 동시 사용 제한</strong></p>
                        <ul>
                            <li>칩셋별 최대 동시 인스턴스 수 상이</li>
                            <li>일반적으로 디코더 4~16개, 인코더 2~4개</li>
                            <li>해상도에 따라 가용 인스턴스 변동</li>
                            <li><code>max-supported-instances</code>로 선언</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="warning-box">
                <strong>⚠️ AAOS 멀티 디스플레이 환경에서의 고려사항:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>멀티 디스플레이</strong>: 전면/후면 좌석 동시 미디어 재생 시 HW 코덱 리소스 경합 가능</li>
                    <li><strong>오디오 존</strong>: 멀티존 오디오 환경에서 각 존별 오디오 코덱 인스턴스 필요</li>
                    <li><strong>OEM 정책</strong>: 차량 시스템은 OEM이 커스텀 우선순위 정책 설정 가능 (운전석 &gt; 후석 등)</li>
                    <li><strong>리소스 예약</strong>: 차량 필수 기능(후방 카메라 등)에 대한 코덱 리소스 예약 권장</li>
                </ul>
            </div>
        </section>

        <!-- Section 8: MediaCodec API Usage Examples -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">12</span>
                MediaCodec API 사용 예시
            </h2>
            <p class="section-description">
                앱 개발자가 MediaCodec API를 통해 Codec 2.0을 사용하는 실제 코드 예시입니다.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🎬</span>
                        비디오 디코더 초기화
                    </h3>
                    <div class="card-description">
                        <p><strong>Kotlin 코드 예시</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>// H.264 비디오 디코더 생성
val decoder = MediaCodec.createDecoderByType("video/avc")

// MediaFormat 설정
val format = MediaFormat().apply {
    setString(MediaFormat.KEY_MIME, "video/avc")
    setInteger(MediaFormat.KEY_WIDTH, 1920)
    setInteger(MediaFormat.KEY_HEIGHT, 1080)
    setInteger(MediaFormat.KEY_FRAME_RATE, 30)
}

// Surface 출력 설정 (화면 렌더링)
decoder.configure(format, surface, null, 0)
decoder.start()

// 또는 ByteBuffer 출력 (후처리용)
// decoder.configure(format, null, null, 0)</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📥</span>
                        입력 버퍼 처리
                    </h3>
                    <div class="card-description">
                        <p><strong>압축된 비디오 프레임 입력</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>// 입력 버퍼 인덱스 획득 (타임아웃 10ms)
val inputIndex = decoder.dequeueInputBuffer(10000)

if (inputIndex >= 0) {
    val inputBuffer = decoder.getInputBuffer(inputIndex)
    inputBuffer?.clear()

    // 압축된 H.264 NAL 유닛 복사
    val sampleSize = extractor.readSampleData(inputBuffer, 0)
    val presentationTimeUs = extractor.sampleTime

    decoder.queueInputBuffer(
        inputIndex,
        0,
        sampleSize,
        presentationTimeUs,
        0  // flags
    )

    extractor.advance()
}</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📤</span>
                        출력 버퍼 처리
                    </h3>
                    <div class="card-description">
                        <p><strong>디코딩된 프레임 수신</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>val bufferInfo = MediaCodec.BufferInfo()
val outputIndex = decoder.dequeueOutputBuffer(bufferInfo, 10000)

when (outputIndex) {
    MediaCodec.INFO_OUTPUT_FORMAT_CHANGED -> {
        val newFormat = decoder.outputFormat
        Log.d(TAG, "Output format: $newFormat")
    }
    MediaCodec.INFO_TRY_AGAIN_LATER -> {
        // 출력 버퍼 없음, 대기
    }
    else -> {
        if (outputIndex >= 0) {
            // Surface 렌더링
            decoder.releaseOutputBuffer(outputIndex, true)

            // 또는 ByteBuffer 접근
            // val outputBuffer = decoder.getOutputBuffer(outputIndex)
            // decoder.releaseOutputBuffer(outputIndex, false)
        }
    }
}</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🎥</span>
                        비디오 인코더 예시
                    </h3>
                    <div class="card-description">
                        <p><strong>H.264 인코딩 설정</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>val encoder = MediaCodec.createEncoderByType("video/avc")

val format = MediaFormat.createVideoFormat(
    "video/avc", 1920, 1080
).apply {
    setInteger(MediaFormat.KEY_COLOR_FORMAT,
        MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface)
    setInteger(MediaFormat.KEY_BIT_RATE, 6000000)  // 6Mbps
    setInteger(MediaFormat.KEY_FRAME_RATE, 30)
    setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, 1)  // 1초
    setInteger(MediaFormat.KEY_PROFILE,
        MediaCodecInfo.CodecProfileLevel.AVCProfileHigh)
}

val inputSurface = MediaCodec.createPersistentInputSurface()
encoder.configure(format, null, null,
    MediaCodec.CONFIGURE_FLAG_ENCODE)
encoder.setInputSurface(inputSurface)
encoder.start()</code></pre>
                    </div>
                </div>
            </div>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>💡 Codec 2.0 자동 선택</strong><br/>
                <code>MediaCodec.createDecoderByType()</code>을 사용하면 시스템이 자동으로 최적의 코덱을 선택합니다:
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>Android 10+</strong>: Codec 2.0 구현 우선 선택</li>
                    <li><strong>하드웨어 코덱</strong>: 사용 가능한 경우 자동 사용</li>
                    <li><strong>소프트웨어 폴백</strong>: HW 실패 시 SW 코덱으로 전환</li>
                    <li><strong>명시적 선택</strong>: <code>MediaCodec.createByCodecName("c2.android.avc.decoder")</code></li>
                </ul>
            </div>
        </section>

        <!-- Section 9: Vendor Implementation Guide -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">13</span>
                벤더 구현 가이드
            </h2>
            <p class="section-description">
                하드웨어 제조사가 커스텀 Codec 2.0 컴포넌트를 구현하고 등록하는 방법입니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph Implementation["벤더 구현"]
                        COMP_IMPL["C2Component 구현<br/>(H.264/VP9/AV1 등)"]
                        STORE_IMPL["C2ComponentStore 구현<br/>(Factory)"]
                        SERVICE["Codec2 HAL Service<br/>(HIDL/AIDL)"]
                    end

                    subgraph Build["빌드 설정"]
                        BP["Android.bp<br/>(cc_library_shared)"]
                        XML["media_codecs.xml<br/>(코덱 선언)"]
                        MANIFEST["manifest.xml<br/>(HAL Service)"]
                    end

                    subgraph Registration["등록 및 발견"]
                        HWSERVICE["hwservicemanager<br/>(Service Registry)"]
                        FRAMEWORK["Framework<br/>(Codec2Client)"]
                    end

                    COMP_IMPL --> STORE_IMPL
                    STORE_IMPL --> SERVICE

                    BP --> COMP_IMPL
                    XML --> STORE_IMPL
                    MANIFEST --> SERVICE

                    SERVICE --> HWSERVICE
                    HWSERVICE --> FRAMEWORK
                </div>
            </div>

            <h3 class="subsection-title">
                📝 구현 단계
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">1️⃣</span>
                        C2Component 구현
                    </h3>
                    <div class="card-description">
                        <p><strong>커스텀 코덱 클래스 작성</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>// vendor/mycompany/codec2/MyAvcDecoder.h
class MyAvcDecoder : public SimpleC2Component {
public:
    MyAvcDecoder(const char* name,
                 c2_node_id_t id,
                 const std::shared_ptr&lt;IntfImpl&gt;& intfImpl);

    // 필수 메서드 구현
    c2_status_t onInit() override;
    c2_status_t onStop() override;
    void onReset() override;
    void onRelease() override;
    c2_status_t onFlush_sm() override;
    void process(
        const std::unique_ptr&lt;C2Work&gt;& work,
        const std::shared_ptr&lt;C2BlockPool&gt;& pool
    ) override;

private:
    // 하드웨어 디코더 핸들
    void* mHwHandle;
};</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">2️⃣</span>
                        C2ComponentStore 구현
                    </h3>
                    <div class="card-description">
                        <p><strong>컴포넌트 팩토리</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>// MyComponentStore.cpp
class MyComponentStore : public C2ComponentStore {
public:
    MyComponentStore()
        : mReflector(std::make_shared&lt;C2ReflectorHelper&gt;()) {}

    c2_status_t createComponent(
        c2_node_id_t id,
        std::shared_ptr&lt;C2Component&gt;* component) override {

        if (name == "c2.vendor.avc.decoder") {
            *component = std::make_shared&lt;MyAvcDecoder&gt;(
                name, id, intfImpl);
            return C2_OK;
        }
        return C2_NOT_FOUND;
    }

    std::vector&lt;std::shared_ptr&lt;C2Component::Traits&gt;&gt;
    listComponents() override;
};</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">3️⃣</span>
                        Android.bp 빌드 설정
                    </h3>
                    <div class="card-description">
                        <p><strong>Soong 빌드 파일</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>// Android.bp
cc_library_shared {
    name: "libcodec2_vendor_mycompany",
    vendor: true,

    srcs: [
        "MyAvcDecoder.cpp",
        "MyComponentStore.cpp",
    ],

    shared_libs: [
        "libcodec2",
        "libcodec2_vndk",
        "libcodec2_soft_common",
        "liblog",
        "libutils",
    ],

    cflags: [
        "-Wall",
        "-Werror",
    ],
}</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">4️⃣</span>
                        media_codecs.xml 선언
                    </h3>
                    <div class="card-description">
                        <p><strong>코덱 능력 정의</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code>&lt;!-- device/mycompany/mydevice/media_codecs.xml --&gt;
&lt;MediaCodecs&gt;
    &lt;Decoders&gt;
        &lt;MediaCodec name="c2.vendor.avc.decoder"
                    type="video/avc"&gt;
            &lt;Limit name="size" min="64x64" max="3840x2160"/&gt;
            &lt;Limit name="alignment" value="2x2"/&gt;
            &lt;Limit name="block-size" value="16x16"/&gt;
            &lt;Limit name="frame-rate" range="1-60"/&gt;
            &lt;Limit name="bitrate" range="1-120000000"/&gt;
            &lt;Feature name="adaptive-playback"/&gt;
            &lt;Feature name="secure-playback"/&gt;
        &lt;/MediaCodec&gt;
    &lt;/Decoders&gt;
&lt;/MediaCodecs&gt;</code></pre>
                    </div>
                </div>
            </div>

            <div class="warning-box" style="margin-top: 30px;">
                <strong>⚠️ 벤더 구현 주의사항:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>네이밍 규칙</strong>: <code>c2.vendor.&lt;company&gt;.&lt;codec&gt;.&lt;type&gt;</code> (예: c2.vendor.qcom.avc.decoder)</li>
                    <li><strong>Secure Codec</strong>: DRM 재생을 위해 <code>.secure</code> 서픽스 추가</li>
                    <li><strong>SELinux</strong>: HAL 서비스에 대한 적절한 정책 설정 필요</li>
                    <li><strong>CDD 준수</strong>: CDD(Compatibility Definition Document) 요구사항 만족 필수</li>
                    <li><strong>CTS 테스트</strong>: CTS MediaCodec 테스트 통과 필수</li>
                </ul>
            </div>
        </section>

        <!-- Section 14: Mainline Module (Media APEX) -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">14</span>
                Mainline Module (Media APEX)
            </h2>
            <p class="section-description">
                Android 10의 Project Mainline을 통해 Codec 2.0 핵심 컴포넌트가 OS 업데이트 없이 Google Play를 통해 독립적으로 업데이트됩니다.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph APEX["com.android.media APEX Module"]
                        SW["SW Codecs<br/>c2.android.*"]
                        EXT["Media Extractor<br/>Plugins"]
                        FW["Codec2 Framework<br/>libcodec2 · sfplugin"]
                        LIB["Media Libraries<br/>libstagefright"]
                    end

                    subgraph VENDOR["Vendor Partition"]
                        HW["HW Codecs<br/>c2.vendor.*"]
                        HALIMPL["Codec2 HAL<br/>Service"]
                        DRV["HW Driver<br/>Firmware"]
                    end

                    subgraph UPDATE["업데이트 경로"]
                        PLAY["Google Play<br/>System Update"]
                        OTA["OEM OTA<br/>Full System"]
                    end

                    PLAY --> APEX
                    OTA --> VENDOR
                    APEX --> HALIMPL
                    HALIMPL --> DRV
                </div>
            </div>

            <h3 class="subsection-title">
                📦 APEX 모듈 구성
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">✅</span>
                        APEX에 포함 (독립 업데이트)
                    </h3>
                    <div class="card-description">
                        <p><strong>com.android.media / com.android.media.swcodec</strong></p>
                        <ul>
                            <li>Codec2 프레임워크 (CCodec, Codec2Client)</li>
                            <li>SW 코덱 (c2.android.avc/hevc/vp9/av1 등)</li>
                            <li>MediaExtractor 플러그인 (MP4, MKV, WebM 등)</li>
                            <li>libstagefright 코어 라이브러리</li>
                            <li>MediaCodec API 구현체</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🏭</span>
                        Vendor에 유지 (OTA 필요)
                    </h3>
                    <div class="card-description">
                        <p><strong>벤더 파티션에 남는 컴포넌트</strong></p>
                        <ul>
                            <li>HW 코덱 구현 (c2.vendor.*, c2.qcom.* 등)</li>
                            <li>Codec2 HAL 서비스 (HIDL/AIDL)</li>
                            <li>HW 드라이버 및 펌웨어</li>
                            <li>벤더 커스텀 필터 플러그인</li>
                            <li>media_codecs.xml (벤더 코덱 선언)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔄</span>
                        업데이트 메커니즘
                    </h3>
                    <div class="card-description">
                        <p><strong>Google Play System Update</strong></p>
                        <ul>
                            <li>APEX 패키지 형태로 배포</li>
                            <li>기기 재부팅 없이 적용 (Android 12+)</li>
                            <li>Google이 직접 보안 패치 배포</li>
                            <li>OEM OTA 대비 빠른 보안 대응</li>
                            <li>모든 GMS 기기에 동시 적용</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🛡️</span>
                        보안상 이점
                    </h3>
                    <div class="card-description">
                        <p><strong>신속한 취약점 대응</strong></p>
                        <ul>
                            <li>미디어 파서/코덱 취약점 신속 패치</li>
                            <li>Stagefright 급 보안 이슈 독립 대응</li>
                            <li>SW 코덱 라이브러리 긴급 업데이트</li>
                            <li>OEM 업데이트 지연과 무관하게 적용</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <strong>💡 Mainline과 Vendor 경계의 호환성</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>Stable Interface</strong>: APEX 모듈과 Vendor HAL은 HIDL/AIDL stable interface로 통신하여 버전 독립성 보장</li>
                    <li><strong>VNDK</strong>: Vendor가 사용하는 프레임워크 라이브러리 버전이 고정되어 APEX 업데이트가 벤더 코드를 깨뜨리지 않음</li>
                    <li><strong>AAOS 참고</strong>: 차량용 시스템에서도 Mainline 업데이트가 적용되지만, OEM은 차량 인증 요구사항에 따라 업데이트 적용 시점을 제어할 수 있음</li>
                </ul>
            </div>
        </section>

        <!-- Section 10: Debugging and Troubleshooting -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">15</span>
                디버깅 및 트러블슈팅
            </h2>
            <p class="section-description">
                Codec 2.0 개발 및 통합 과정에서 발생하는 일반적인 문제와 해결 방법입니다.
            </p>

            <h3 class="subsection-title">
                🔍 디버깅 도구
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📱</span>
                        adb logcat 필터링
                    </h3>
                    <div class="card-description">
                        <p><strong>Codec 2.0 관련 로그 추출</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code># Codec2 전체 로그
adb logcat -s Codec2Client Codec2 CCodec

# 특정 컴포넌트만
adb logcat -s c2.android.avc.decoder

# HAL 통신 로그
adb logcat -s android.hardware.media.c2

# 버퍼 관련 디버그
adb logcat | grep -i "c2buffer\|c2work"

# 에러만 필터링
adb logcat *:E | grep -i codec</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📊</span>
                        dumpsys 명령어
                    </h3>
                    <div class="card-description">
                        <p><strong>시스템 상태 조회</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code># 사용 가능한 Codec2 컴포넌트 목록
adb shell dumpsys media.codec2

# MediaCodec 인스턴스 상태
adb shell dumpsys media.player

# 현재 활성화된 코덱 세션
adb shell dumpsys media.codec

# 하드웨어 코덱 사용 현황
adb shell dumpsys media.resource_manager</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">⚙️</span>
                        시스템 속성 (System Properties)
                    </h3>
                    <div class="card-description">
                        <p><strong>런타임 설정 변경</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code># Codec2 강제 활성화
adb shell setprop debug.stagefright.ccodec 1

# OpenMAX 강제 사용 (테스트용)
adb shell setprop debug.stagefright.ccodec 0

# 상세 로그 활성화
adb shell setprop debug.codec2.platform.loglevel 3

# 재부팅 후 적용
adb reboot</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🧪</span>
                        CTS 테스트 실행
                    </h3>
                    <div class="card-description">
                        <p><strong>호환성 테스트</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85rem; line-height: 1.5;"><code># MediaCodec CTS 테스트
adb shell am instrument -w -e class \
  android.media.cts.MediaCodecTest \
  android.media.cts/.MediaCodecTestRunner

# Codec2 특화 테스트
adb shell /data/nativetest64/C2ComponentTest/C2ComponentTest

# 성능 벤치마크
adb shell am start -n \
  com.android.cts.media/.MediaCodecBenchmark</code></pre>
                    </div>
                </div>
            </div>

            <h3 class="subsection-title">
                ⚠️ 일반적인 문제 및 해결책
            </h3>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>문제</th>
                        <th>원인</th>
                        <th>해결 방법</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>코덱을 찾을 수 없음</strong></td>
                        <td>HAL 서비스 미등록 또는 media_codecs.xml 설정 오류</td>
                        <td><code>dumpsys media.codec2</code>로 등록 확인, manifest.xml 및 SELinux 정책 점검</td>
                    </tr>
                    <tr>
                        <td><strong>configure() 실패</strong></td>
                        <td>지원하지 않는 해상도/프로파일/레벨</td>
                        <td>MediaCodecInfo.getCapabilitiesForType()로 지원 범위 확인</td>
                    </tr>
                    <tr>
                        <td><strong>출력 버퍼가 나오지 않음</strong></td>
                        <td>입력 데이터 형식 오류 (SPS/PPS 누락 등)</td>
                        <td>MediaExtractor 사용 또는 올바른 NAL 유닛 구성 확인</td>
                    </tr>
                    <tr>
                        <td><strong>디코딩 화면 깨짐</strong></td>
                        <td>잘못된 타임스탬프, 동기화 실패</td>
                        <td>presentationTimeUs 정확히 설정, releaseOutputBuffer(index, true) 사용</td>
                    </tr>
                    <tr>
                        <td><strong>HW 코덱 크래시</strong></td>
                        <td>벤더 HAL 구현 버그, 메모리 부족</td>
                        <td>SW 코덱으로 폴백, dumpsys로 메모리 사용 확인</td>
                    </tr>
                    <tr>
                        <td><strong>Zero-Copy 동작 안함</strong></td>
                        <td>ION/Gralloc 할당 실패</td>
                        <td>C2Allocator 로그 확인, 버퍼 크기 조정</td>
                    </tr>
                    <tr>
                        <td><strong>DRM 재생 실패</strong></td>
                        <td>Secure 코덱 미지원 또는 HDCP 인증 실패</td>
                        <td>c2.*.decoder.secure 코덱 존재 확인, Widevine 레벨 점검</td>
                    </tr>
                    <tr>
                        <td><strong>성능 저하</strong></td>
                        <td>SW 코덱 사용, 불필요한 복사</td>
                        <td>HW 코덱 우선 선택, Surface 직접 렌더링 사용</td>
                    </tr>
                </tbody>
            </table>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>💡 디버깅 팁</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>로그 레벨 조정</strong>: <code>adb shell setprop log.tag.Codec2 VERBOSE</code></li>
                    <li><strong>프레임 덤프</strong>: MediaMuxer로 디코딩된 YUV 저장 후 분석</li>
                    <li><strong>타이밍 분석</strong>: Systrace로 큐잉/디큐잉 타이밍 프로파일링</li>
                    <li><strong>벤더 로그</strong>: 벤더별 커스텀 로그 태그 확인 (예: qcom.*, exynos.*)</li>
                </ul>
            </div>
        </section>

        <!-- Section 11: AOSP Source Code Reference -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">16</span>
                AOSP 소스 코드 참조
            </h2>
            <p class="section-description">
                Codec 2.0의 실제 구현을 이해하기 위한 주요 AOSP 소스 코드 위치와 역할입니다.
            </p>

            <h3 class="subsection-title">
                📂 주요 디렉토리 구조
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🏗️</span>
                        Framework 레이어
                    </h3>
                    <div class="card-description">
                        <p><strong>frameworks/av/</strong></p>
                        <ul style="font-size: 0.9rem; line-height: 1.6;">
                            <li><code>media/codec2/sfplugin/</code><br/>
                            → CCodec, CCodecBufferChannel 구현</li>
                            <li><code>media/codec2/vndk/</code><br/>
                            → Codec2Client, C2Component 인터페이스</li>
                            <li><code>media/libstagefright/</code><br/>
                            → MediaCodec.cpp (앱 API 진입점)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔌</span>
                        HAL 인터페이스
                    </h3>
                    <div class="card-description">
                        <p><strong>hardware/interfaces/</strong></p>
                        <ul style="font-size: 0.9rem; line-height: 1.6;">
                            <li><code>media/c2/1.0/</code><br/>
                            → HIDL 인터페이스 정의 (Android 10-12)</li>
                            <li><code>media/c2/aidl/</code><br/>
                            → AIDL 인터페이스 정의 (Android 13+)</li>
                            <li><code>media/c2/1.0/default/</code><br/>
                            → 기본 HAL 구현 참조</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">💾</span>
                        소프트웨어 코덱
                    </h3>
                    <div class="card-description">
                        <p><strong>frameworks/av/media/codec2/components/</strong></p>
                        <ul style="font-size: 0.9rem; line-height: 1.6;">
                            <li><code>base/</code><br/>
                            → SimpleC2Component (기본 클래스)</li>
                            <li><code>avc/C2SoftAvcDec.cpp</code><br/>
                            → H.264 SW 디코더 샘플</li>
                            <li><code>vpx/C2SoftVpxDec.cpp</code><br/>
                            → VP8/VP9 SW 디코더</li>
                            <li><code>aom/C2SoftAomDec.cpp</code><br/>
                            → AV1 SW 디코더</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">⚡</span>
                        Core 라이브러리
                    </h3>
                    <div class="card-description">
                        <p><strong>frameworks/av/media/codec2/core/</strong></p>
                        <ul style="font-size: 0.9rem; line-height: 1.6;">
                            <li><code>include/C2Component.h</code><br/>
                            → C2Component 인터페이스</li>
                            <li><code>include/C2Buffer.h</code><br/>
                            → C2Buffer, C2Block 정의</li>
                            <li><code>include/C2Param.h</code><br/>
                            → C2Param 파라미터 타입</li>
                            <li><code>C2AllocatorGralloc.cpp</code><br/>
                            → Gralloc 기반 할당자</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 class="subsection-title">
                🔬 참고할 샘플 구현
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📝</span>
                        H.264 디코더 구현
                    </h3>
                    <div class="card-description">
                        <p><strong>C2SoftAvcDec.cpp</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.8rem; line-height: 1.5;"><code>// frameworks/av/media/codec2/components/avc/C2SoftAvcDec.cpp

class C2SoftAvcDec : public SimpleC2Component {
    void process(
        const std::unique_ptr&lt;C2Work&gt;& work,
        const std::shared_ptr&lt;C2BlockPool&gt;& pool) override {

        // 입력 버퍼에서 H.264 NAL 추출
        C2ReadView rView = work->input.buffers[0]->data().linearBlocks().front().map().get();

        // libavcdec (H.264 SW 디코더) 호출
        mDecHandle->decode(rView.data(), rView.capacity());

        // 출력 버퍼 할당 및 YUV 복사
        std::shared_ptr&lt;C2GraphicBlock&gt; block;
        C2MemoryUsage usage = { C2MemoryUsage::CPU_READ, C2MemoryUsage::CPU_WRITE };
        c2_status_t err = pool->fetchGraphicBlock(mWidth, mHeight, HAL_PIXEL_FORMAT_YV12, usage, &block);

        // 디코딩된 프레임을 출력 Work에 첨부
        auto fillWork = [buffer = createGraphicBuffer(block)](const std::unique_ptr&lt;C2Work&gt;& work) {
            work->worklets.front()->output.buffers.push_back(buffer);
        };
        fillWork(work);
    }
};</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🏭</span>
                        ComponentStore 구현
                    </h3>
                    <div class="card-description">
                        <p><strong>C2SoftCodecComponentStore.cpp</strong></p>
                        <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.8rem; line-height: 1.5;"><code>// frameworks/av/media/codec2/components/base/SimpleC2Component.cpp

std::shared_ptr&lt;C2ComponentStore&gt; GetCodec2PlatformComponentStore() {
    static std::mutex mutex;
    static std::weak_ptr&lt;C2ComponentStore&gt; platformStore;
    std::lock_guard&lt;std::mutex&gt; lock(mutex);
    std::shared_ptr&lt;C2ComponentStore&gt; store = platformStore.lock();

    if (store == nullptr) {
        store = std::make_shared&lt;C2PlatformComponentStore&gt;();
        platformStore = store;
    }
    return store;
}

// 컴포넌트 등록 매크로
REGISTER_C2COMPONENT(C2SoftAvcDec, "c2.android.avc.decoder");
REGISTER_C2COMPONENT(C2SoftVpxDec, "c2.android.vp8.decoder");
REGISTER_C2COMPONENT(C2SoftAomDec, "c2.android.av1.decoder");</code></pre>
                    </div>
                </div>
            </div>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>🔗 유용한 링크</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>AOSP 소스 브라우저</strong>: <a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/av/media/codec2/" target="_blank" style="color: var(--color-accent);">cs.android.com (Codec2)</a></li>
                    <li><strong>Codec2 공식 문서</strong>: <a href="https://source.android.com/docs/core/media/codec2" target="_blank" style="color: var(--color-accent);">source.android.com</a></li>
                    <li><strong>CTS 테스트 코드</strong>: <code>cts/tests/tests/media/codec/</code></li>
                    <li><strong>VTS 테스트 코드</strong>: <code>test/vts-testcase/hal/media/c2/</code></li>
                </ul>
            </div>
        </section>

        <!-- Section 12: Related Pages -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">17</span>
                관련 상세 문서
            </h2>
            <p class="section-description">
                Codec 2.0와 관련된 미디어 프레임워크의 다른 주제들을 탐색하세요.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🏗️</span>
                        Media Framework Core
                    </h3>
                    <div class="card-description">
                        <p>전체 미디어 프레임워크 아키텍처</p>
                        <ul>
                            <li>AOSP 5-Layer 구조</li>
                            <li>Application → HAL 데이터 플로우</li>
                            <li>MediaCodec API 위치</li>
                            <li>Codec2가 전체 구조에서 차지하는 역할</li>
                        </ul>
                        <a href="media-framework-core.html" style="display: inline-block; margin-top: 15px; padding: 10px 20px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(245, 158, 11, 0.2)); border: 1px solid #8b5cf6; border-radius: 8px; color: #a78bfa; text-decoration: none; font-weight: 600;">
                            자세히 보기 →
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📊</span>
                        Media Playback Pipeline
                    </h3>
                    <div class="card-description">
                        <p>미디어 재생 파이프라인 상세</p>
                        <ul>
                            <li>NuPlayer의 Codec2 통합</li>
                            <li>End-to-End 데이터 플로우</li>
                            <li>버퍼 관리 및 A/V 동기화</li>
                            <li>성능 최적화 기법</li>
                        </ul>
                        <a href="media-playback.html" style="display: inline-block; margin-top: 15px; padding: 10px 20px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(245, 158, 11, 0.2)); border: 1px solid #8b5cf6; border-radius: 8px; color: #a78bfa; text-decoration: none; font-weight: 600;">
                            자세히 보기 →
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">📦</span>
                        MediaExtractor
                    </h3>
                    <div class="card-description">
                        <p>컨테이너 파싱 및 디먹싱</p>
                        <ul>
                            <li>MP4/MKV/WebM 파싱</li>
                            <li>트랙 분리 및 메타데이터 추출</li>
                            <li>Codec2로 전달되는 압축 데이터</li>
                            <li>Extractor 플러그인 구조</li>
                        </ul>
                        <a href="media-extractor.html" style="display: inline-block; margin-top: 15px; padding: 10px 20px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(245, 158, 11, 0.2)); border: 1px solid #8b5cf6; border-radius: 8px; color: #a78bfa; text-decoration: none; font-weight: 600;">
                            자세히 보기 →
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔊</span>
                        Audio Framework
                    </h3>
                    <div class="card-description">
                        <p>오디오 처리 파이프라인</p>
                        <ul>
                            <li>오디오 코덱 (AAC, MP3, Opus)</li>
                            <li>AudioFlinger 믹싱 엔진</li>
                            <li>Audio HAL 인터페이스</li>
                            <li>Codec2 오디오 컴포넌트</li>
                        </ul>
                        <a href="audio-framework.html" style="display: inline-block; margin-top: 15px; padding: 10px 20px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(245, 158, 11, 0.2)); border: 1px solid #8b5cf6; border-radius: 8px; color: #a78bfa; text-decoration: none; font-weight: 600;">
                            자세히 보기 →
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🎵</span>
                        Dolby Codecs
                    </h3>
                    <div class="card-description">
                        <p>프리미엄 오디오/비디오 코덱</p>
                        <ul>
                            <li>Dolby Atmos (AC-4, E-AC-3)</li>
                            <li>Dolby Vision (HDR)</li>
                            <li>Codec2 기반 Dolby 통합</li>
                            <li>벤더 구현 가이드</li>
                        </ul>
                        <a href="dolby-codecs.html" style="display: inline-block; margin-top: 15px; padding: 10px 20px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(245, 158, 11, 0.2)); border: 1px solid #8b5cf6; border-radius: 8px; color: #a78bfa; text-decoration: none; font-weight: 600;">
                            자세히 보기 →
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">🔐</span>
                        Widevine DRM
                    </h3>
                    <div class="card-description">
                        <p>DRM 보호 콘텐츠 재생</p>
                        <ul>
                            <li>Widevine L1/L2/L3</li>
                            <li>Secure Codec2 컴포넌트</li>
                            <li>TEE 기반 보안 파이프라인</li>
                            <li>MediaDrm + MediaCodec 통합</li>
                        </ul>
                        <a href="widevine.html" style="display: inline-block; margin-top: 15px; padding: 10px 20px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(245, 158, 11, 0.2)); border: 1px solid #8b5cf6; border-radius: 8px; color: #a78bfa; text-decoration: none; font-weight: 600;">
                            자세히 보기 →
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer
            style="text-align: center; padding: 40px 20px; color: var(--text-muted); border-top: 1px solid var(--border-color); margin-top: 60px;">
            <p>Android Codec 2.0 Architecture</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                Next-Generation Media Codec Framework
            </p>
            <p style="margin-top: 20px;">
                <a href="index.html" style="color: var(--color-accent); text-decoration: none;">
                    ← AOSP Media Framework로 돌아가기
                </a>
            </p>
        </footer>
    </div>

    <script src="scripts/mermaid-theme.js"></script>
    <script>
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(30px)';
            section.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
            observer.observe(section);
        });
    </script>

    <!-- Navigation & Copy Features -->
    <script src="scripts/copy-code.js"></script>
    <script src="scripts/toc-generator.js"></script>
    <script src="scripts/page-navigation.js"></script>
    <!-- Interactive Diagram Features -->
    <script src="scripts/diagram-data.js"></script>
    <script src="scripts/diagram-interactive.js"></script>

    <script src="scripts/theme-toggle.js?v=2"></script>
    <script src="scripts/lang-switch.js"></script>
</body>

</html>