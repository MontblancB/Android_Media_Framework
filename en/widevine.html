<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widevine DRM ì•„í‚¤í…ì²˜ ìƒì„¸ ì‹œê°í™”</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700;900&family=IBM+Plex+Mono:wght@400;500;600&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/design-system.css">

        <style>
        /* Page-specific styles loaded from design-system.css */
    </style>
</head>

<body>
    <nav class="nav">
        <a href="index.html" class="nav-button">
            â† AOSP Media Framework
        </a>
    </nav>

    <div class="container">
        <header>
            <h1 class="page-title">ğŸ”’ Widevine DRM</h1>
            <p class="page-subtitle">Google Widevine Digital Rights Management ì•„í‚¤í…ì²˜ ìƒì„¸ ì‹œê°í™”</p>
        </header>

        <!-- Section 1: Widevine Overview -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">1</span>
                Widevine DRM ê°œìš”
            </h2>
            <p class="section-description">
                Widevineì€ Googleì´ ì†Œìœ í•œ ë””ì§€í„¸ ì €ì‘ê¶Œ ê´€ë¦¬(DRM) ì‹œìŠ¤í…œìœ¼ë¡œ,
                ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ì—ì„œ í”„ë¦¬ë¯¸ì—„ ì½˜í…ì¸ ë¥¼ ë³´í˜¸í•˜ëŠ” ë° ë„ë¦¬ ì‚¬ìš©ë©ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¯</span>
                        ì£¼ìš” ëª©ì 
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>ì €ì‘ê¶Œ ë³´í˜¸ëœ ë¹„ë””ì˜¤ ì½˜í…ì¸  ë³´ì•ˆ</li>
                            <li>ë¶ˆë²• ë³µì œ ë° í™”ë©´ ìº¡ì²˜ ë°©ì§€</li>
                            <li>HD/4K ì½˜í…ì¸  ìŠ¤íŠ¸ë¦¬ë° ë³´í˜¸</li>
                            <li>ë‹¤ì–‘í•œ í”Œë«í¼ ì§€ì› (Web, Android, iOS ë“±)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¢</span>
                        ì£¼ìš” ì‚¬ìš©ì²˜
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>Netflix</strong>: HD/4K ìŠ¤íŠ¸ë¦¬ë°</li>
                            <li><strong>Amazon Prime Video</strong>: í”„ë¦¬ë¯¸ì—„ ì½˜í…ì¸ </li>
                            <li><strong>Disney+</strong>: HDR ì½˜í…ì¸ </li>
                            <li><strong>YouTube</strong>: ìœ ë£Œ ì½˜í…ì¸ </li>
                            <li><strong>Spotify</strong>: ì˜¤ë””ì˜¤ DRM</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        ë³´ì•ˆ ë ˆë²¨
                    </h3>
                    <div class="card-description">
                        <p>Widevineì€ 3ê°€ì§€ ë³´ì•ˆ ë ˆë²¨ì„ ì œê³µ:</p>
                        <ul>
                            <li><span class="security-badge security-l1">L1</span> ìµœê³  ë³´ì•ˆ (í•˜ë“œì›¨ì–´ TEE)</li>
                            <li><span class="security-badge security-l2">L2</span> ì¤‘ê°„ ë³´ì•ˆ (ë¶€ë¶„ TEE)</li>
                            <li><span class="security-badge security-l3">L3</span> ê¸°ë³¸ ë³´ì•ˆ (ì†Œí”„íŠ¸ì›¨ì–´)</li>
                        </ul>
                        <p style="margin-top: 10px; font-size: 0.9em;">
                            ë ˆë²¨ì— ë”°ë¼ ì¬ìƒ ê°€ëŠ¥í•œ í™”ì§ˆì´ ì œí•œë©ë‹ˆë‹¤.
                        </p>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš™ï¸</span>
                        í•µì‹¬ ì»´í¬ë„ŒíŠ¸
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>CDM</strong>: Content Decryption Module</li>
                            <li><strong>OEMCrypto</strong>: í•˜ë“œì›¨ì–´ ì•”í˜¸í™” ëª¨ë“ˆ</li>
                            <li><strong>License Server</strong>: ë¼ì´ì„ ìŠ¤ ë°œê¸‰ ì„œë²„</li>
                            <li><strong>EME</strong>: Encrypted Media Extensions (Web)</li>
                            <li><strong>MediaDrm</strong>: Android DRM API</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Security Levels -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">2</span>
                ë³´ì•ˆ ë ˆë²¨ (L1, L2, L3)
            </h2>
            <p class="section-description">
                Widevineì˜ ë³´ì•ˆ ë ˆë²¨ì€ í•˜ë“œì›¨ì–´ ê¸°ë°˜ ë³´ì•ˆ(TEE) ì‚¬ìš© ì—¬ë¶€ì— ë”°ë¼ êµ¬ë¶„ë˜ë©°,
                ê° ë ˆë²¨ë§ˆë‹¤ ì¬ìƒ ê°€ëŠ¥í•œ ì½˜í…ì¸  í™”ì§ˆì´ ë‹¤ë¦…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph L1["Security Level 1 (ìµœê³  ë³´ì•ˆ)"]
                    L1_TEE["Trusted Execution Environment<br />(ARM TrustZone)"]
                    L1_CRYPT["ì•”í˜¸í™” ì‘ì—…<br />(TEE ë‚´ë¶€)"]
                    L1_DEC["ë¹„ë””ì˜¤ ë””ì½”ë”©<br />(TEE ë‚´ë¶€)"]
                    L1_RENDER["ë Œë”ë§<br />(í•˜ë“œì›¨ì–´ ë³´í˜¸)"]
                    L1_OUT["ì¶œë ¥: HD/4K/HDR"]
                    end

                    subgraph L2["Security Level 2 (ì¤‘ê°„ ë³´ì•ˆ)"]
                    L2_TEE["Trusted Execution Environment"]
                    L2_CRYPT["ì•”í˜¸í™” ì‘ì—…<br />(TEE ë‚´ë¶€)"]
                    L2_DEC["ë¹„ë””ì˜¤ ë””ì½”ë”©<br />(TEE ì™¸ë¶€)"]
                    L2_OUT["ì¶œë ¥: ~540p"]
                    end

                    subgraph L3["Security Level 3 (ê¸°ë³¸ ë³´ì•ˆ)"]
                    L3_SW["ì†Œí”„íŠ¸ì›¨ì–´ DRM<br />(TEE ì—†ìŒ)"]
                    L3_CRYPT["ì•”í˜¸í™” ì‘ì—…<br />(ì‚¬ìš©ì ê³µê°„)"]
                    L3_DEC["ë¹„ë””ì˜¤ ë””ì½”ë”©<br />(ì†Œí”„íŠ¸ì›¨ì–´)"]
                    L3_OUT["ì¶œë ¥: SD (480p)"]
                    end

                    L1_TEE --> L1_CRYPT --> L1_DEC --> L1_RENDER --> L1_OUT
                    L2_TEE --> L2_CRYPT --> L2_DEC --> L2_OUT
                    L3_SW --> L3_CRYPT --> L3_DEC --> L3_OUT

                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ“Š ë³´ì•ˆ ë ˆë²¨ ìƒì„¸ ë¹„êµ
            </h3>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>í•­ëª©</th>
                        <th>L1 (ìµœê³ )</th>
                        <th>L2 (ì¤‘ê°„)</th>
                        <th>L3 (ê¸°ë³¸)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>ì•”í˜¸í™” ì‘ì—…</strong></td>
                        <td>TEE ë‚´ë¶€</td>
                        <td>TEE ë‚´ë¶€</td>
                        <td>ì‚¬ìš©ì ê³µê°„ (ì†Œí”„íŠ¸ì›¨ì–´)</td>
                    </tr>
                    <tr>
                        <td><strong>ë¹„ë””ì˜¤ ë””ì½”ë”©</strong></td>
                        <td>TEE ë‚´ë¶€</td>
                        <td>TEE ì™¸ë¶€</td>
                        <td>ì‚¬ìš©ì ê³µê°„ (ì†Œí”„íŠ¸ì›¨ì–´)</td>
                    </tr>
                    <tr>
                        <td><strong>ë Œë”ë§</strong></td>
                        <td>í•˜ë“œì›¨ì–´ ë³´í˜¸</td>
                        <td>ì†Œí”„íŠ¸ì›¨ì–´/í•˜ë“œì›¨ì–´</td>
                        <td>ì†Œí”„íŠ¸ì›¨ì–´</td>
                    </tr>
                    <tr>
                        <td><strong>ìµœëŒ€ í™”ì§ˆ</strong></td>
                        <td>4K UHD, HDR</td>
                        <td>~540p</td>
                        <td>SD (480p)</td>
                    </tr>
                    <tr>
                        <td><strong>í™”ë©´ ìº¡ì²˜ ë°©ì§€</strong></td>
                        <td>ì™„ë²½ ì°¨ë‹¨</td>
                        <td>ë¶€ë¶„ ì°¨ë‹¨</td>
                        <td>ì œí•œì </td>
                    </tr>
                    <tr>
                        <td><strong>í•˜ë“œì›¨ì–´ ìš”êµ¬ì‚¬í•­</strong></td>
                        <td>TEE í•„ìˆ˜ (ARM TrustZone)</td>
                        <td>ë¶€ë¶„ TEE</td>
                        <td>ì—†ìŒ (ëª¨ë“  ê¸°ê¸°)</td>
                    </tr>
                    <tr>
                        <td><strong>ë³´ì•ˆ ì·¨ì•½ì </strong></td>
                        <td>ë§¤ìš° ë‚®ìŒ</td>
                        <td>ì¤‘ê°„</td>
                        <td>ìƒëŒ€ì ìœ¼ë¡œ ë†’ìŒ</td>
                    </tr>
                    <tr>
                        <td><strong>ì£¼ìš” ì‚¬ìš© ê¸°ê¸°</strong></td>
                        <td>í”Œë˜ê·¸ì‹­ ìŠ¤ë§ˆíŠ¸í°, ì¸ì¦ëœ ê¸°ê¸°</td>
                        <td>ë“œë¬¼ìŒ</td>
                        <td>ì—”íŠ¸ë¦¬ ë ˆë²¨ ê¸°ê¸°, ë£¨íŒ…ëœ ê¸°ê¸°</td>
                    </tr>
                    <tr>
                        <td><strong>Android í†µí•©</strong></td>
                        <td>Stagefright + TrustZone</td>
                        <td>ë¶€ë¶„ í†µí•©</td>
                        <td>ì†Œí”„íŠ¸ì›¨ì–´ DRMë§Œ</td>
                    </tr>
                </tbody>
            </table>

            <div class="content-grid" style="margin-top: 40px;">
                <div class="card">
                    <h3 class="card-title">
                        ğŸ† Level 1 (L1)
                        <span class="tag tag-tee">TEE</span>
                    </h3>
                    <div class="card-description">
                        <p><strong>ì™„ì „í•œ í•˜ë“œì›¨ì–´ ë³´í˜¸</strong></p>
                        <ul>
                            <li>ëª¨ë“  ì²˜ë¦¬ê°€ TEE ë‚´ë¶€ì—ì„œ ì§„í–‰</li>
                            <li>ë³µí˜¸í™” í‚¤ê°€ ì ˆëŒ€ ë…¸ì¶œë˜ì§€ ì•ŠìŒ</li>
                            <li>ARM TrustZone í™œìš©</li>
                            <li>Netflix, Disney+ 4K ì¬ìƒ ê°€ëŠ¥</li>
                            <li>Google ì¸ì¦ í•„ìˆ˜</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        âš ï¸ Level 2 (L2)
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¶€ë¶„ í•˜ë“œì›¨ì–´ ë³´í˜¸</strong></p>
                        <ul>
                            <li>ì•”í˜¸í™”ë§Œ TEEì—ì„œ ì²˜ë¦¬</li>
                            <li>ë””ì½”ë”©ì€ TEE ì™¸ë¶€</li>
                            <li>ì‹œì¥ì—ì„œ ë“œë¬¼ê²Œ ì‚¬ìš©</li>
                            <li>ì¤‘ê°„ í™”ì§ˆ ì œí•œ (540p)</li>
                            <li>ê³¼ë„ê¸°ì  ì†”ë£¨ì…˜</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        â›” Level 3 (L3)
                        <span class="tag tag-software">Software</span>
                    </h3>
                    <div class="card-description">
                        <p><strong>ì†Œí”„íŠ¸ì›¨ì–´ ì „ìš© ë³´í˜¸</strong></p>
                        <ul>
                            <li>TEE ì—†ì´ ì†Œí”„íŠ¸ì›¨ì–´ë¡œë§Œ ë™ì‘</li>
                            <li>ë©”ëª¨ë¦¬ ë¤í”„ ê³µê²©ì— ì·¨ì•½</li>
                            <li>ëª¨ë“  Android ê¸°ê¸° í˜¸í™˜</li>
                            <li>SD í™”ì§ˆ ì œí•œ (480p)</li>
                            <li>ë£¨íŒ…ëœ ê¸°ê¸°ëŠ” L3ë¡œ ê°•ë“±</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Widevine Architecture -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">3</span>
                Widevine ì•„í‚¤í…ì²˜
            </h2>
            <p class="section-description">
                Widevine DRMì˜ ì „ì²´ ì•„í‚¤í…ì²˜ëŠ” CDM, OEMCrypto, ë¼ì´ì„ ìŠ¤ ì„œë²„ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph APP["Application Layer"]
                    PLAYER["Media Player<br />(ExoPlayer/HTML5)"]
                    end

                    subgraph DRM_API["DRM API Layer"]
                    EME["EME (Web)<br />Encrypted Media Extensions"]
                    MEDIADRM["MediaDrm (Android)<br />DRM Framework"]
                    end

                    subgraph CDM["Widevine CDM"]
                    CDM_CORE["CDM Core"]
                    CDM_SESSION["Session Manager"]
                    CDM_PARSER["PSSH Parser"]
                    end

                    subgraph CRYPTO["Crypto Layer"]
                    OEMCRYPTO["OEMCrypto Module"]
                    TEE["Trusted Execution Environment<br />(TrustZone)"]
                    KEYS["Key Storage<br />(Secure)"]
                    end

                    subgraph SERVER["License Server"]
                    LICENSE_SRV["Widevine License Server"]
                    AUTH["Authentication"]
                    KEY_GEN["Key Generation"]
                    end

                    subgraph MEDIA["Media Pipeline"]
                    DEMUX["Demuxer<br />(Encrypted Content)"]
                    DECRYPT["Decryptor"]
                    DECODER["Decoder"]
                    RENDER["Renderer"]
                    end

                    PLAYER --> EME & MEDIADRM
                    EME & MEDIADRM --> CDM_CORE
                    CDM_CORE --> CDM_SESSION & CDM_PARSER
                    CDM_SESSION -->|License Request| LICENSE_SRV
                    LICENSE_SRV --> AUTH --> KEY_GEN
                    KEY_GEN -->|Encrypted License| CDM_SESSION
                    CDM_SESSION --> OEMCRYPTO
                    OEMCRYPTO --> TEE
                    TEE --> KEYS

                    DEMUX --> DECRYPT
                    DECRYPT --> OEMCRYPTO
                    DECRYPT --> DECODER --> RENDER

                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“¦</span>
                        CDM (Content Decryption Module)
                    </h3>
                    <div class="card-description">
                        <p>Widevine í•µì‹¬ ì»´í¬ë„ŒíŠ¸</p>
                        <ul>
                            <li>ë¼ì´ì„ ìŠ¤ ìš”ì²­ ìƒì„±</li>
                            <li>PSSH (Protection System Specific Header) íŒŒì‹±</li>
                            <li>ì„¸ì…˜ ê´€ë¦¬ (Temporary/Persistent)</li>
                            <li>OEMCryptoì™€ í†µì‹ í•˜ì—¬ ë³µí˜¸í™”</li>
                            <li>ë¸Œë¼ìš°ì €/ì•± ìƒŒë“œë°•ìŠ¤ ë‚´ì—ì„œ ë™ì‘</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        OEMCrypto Module
                    </h3>
                    <div class="card-description">
                        <p>í•˜ë“œì›¨ì–´ ë³´ì•ˆ ëª¨ë“ˆ</p>
                        <ul>
                            <li>TEE(Trusted Execution Environment) ë‚´ì—ì„œ ì‹¤í–‰</li>
                            <li>ë³µí˜¸í™” í‚¤ ê´€ë¦¬ ë° ì €ì¥</li>
                            <li>ì•”í˜¸í™”ëœ ì½˜í…ì¸  ë³µí˜¸í™”</li>
                            <li>ì„œëª… í‚¤ ê²€ì¦</li>
                            <li>í•˜ë“œì›¨ì–´ ê¸°ë°˜ ë³´ì•ˆ ì œê³µ (L1)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸŒ</span>
                        EME (Web)
                    </h3>
                    <div class="card-description">
                        <p>ì›¹ ë¸Œë¼ìš°ì € DRM API</p>
                        <ul>
                            <li>W3C í‘œì¤€ (<code>navigator.requestMediaKeySystemAccess()</code>)</li>
                            <li>MediaKeys ê°ì²´ ìƒì„±</li>
                            <li>MediaKeySession ê´€ë¦¬</li>
                            <li>ì•”í˜¸í™”ëœ ë¯¸ë””ì–´ ì¬ìƒ ì§€ì›</li>
                            <li>Chrome, Firefox, Safari ì§€ì›</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“±</span>
                        MediaDrm (Android)
                    </h3>
                    <div class="card-description">
                        <p>Android DRM í”„ë ˆì„ì›Œí¬</p>
                        <ul>
                            <li><code>android.media.MediaDrm</code> API</li>
                            <li>DRM í”ŒëŸ¬ê·¸ì¸ ì•„í‚¤í…ì²˜</li>
                            <li>UUID ê¸°ë°˜ DRM ìŠ¤í‚´ ì‹ë³„</li>
                            <li>CryptoHal/DrmHal (AIDL)</li>
                            <li>ExoPlayer, MediaPlayer í†µí•©</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”‘</span>
                        License Server
                    </h3>
                    <div class="card-description">
                        <p>Widevine ë¼ì´ì„ ìŠ¤ ë°œê¸‰</p>
                        <ul>
                            <li>í´ë¼ì´ì–¸íŠ¸ ì¸ì¦</li>
                            <li>ì½˜í…ì¸  í‚¤ ìƒì„± ë° ì•”í˜¸í™”</li>
                            <li>ë¼ì´ì„ ìŠ¤ ì •ì±… ì ìš© (ë§Œë£Œ ì‹œê°„, ì¬ìƒ íšŸìˆ˜)</li>
                            <li>ê¸°ê¸° í”„ë¡œë¹„ì €ë‹</li>
                            <li>Google ë˜ëŠ” íƒ€ì‚¬ ë¼ì´ì„ ìŠ¤ ì„œë²„</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ›¡ï¸</span>
                        TEE (TrustZone)
                    </h3>
                    <div class="card-description">
                        <p>ì‹ ë¢° ì‹¤í–‰ í™˜ê²½</p>
                        <ul>
                            <li>ARM TrustZone ê¸°ìˆ </li>
                            <li>ê²©ë¦¬ëœ ë³´ì•ˆ ì˜ì—­</li>
                            <li>ë£¨íŠ¸ ê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸</li>
                            <li>Secure World / Normal World ë¶„ë¦¬</li>
                            <li>í•˜ë“œì›¨ì–´ ê¸°ë°˜ í‚¤ ì €ì¥ì†Œ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: License Acquisition Flow -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">4</span>
                ë¼ì´ì„ ìŠ¤ íšë“ í”Œë¡œìš°
            </h2>
            <p class="section-description">
                Widevine ë¼ì´ì„ ìŠ¤ë¥¼ íšë“í•˜ê³  ì½˜í…ì¸ ë¥¼ ì¬ìƒí•˜ëŠ” ì „ì²´ ê³¼ì •ì„ ì‹œê°í™”í•©ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant APP as Media Player
                    participant EME as EME/MediaDrm API
                    participant CDM as Widevine CDM
                    participant LS as License Server
                    participant OEM as OEMCrypto
                    participant TEE as TrustZone (TEE)

                    APP->>EME: ì•”í˜¸í™”ëœ ë¯¸ë””ì–´ ê°ì§€
                    EME->>EME: 'encrypted' ì´ë²¤íŠ¸ ë°œìƒ
                    APP->>EME: requestMediaKeySystemAccess()
                    EME-->>APP: MediaKeys ê°ì²´ ìƒì„±

                    APP->>CDM: createSession()
                    CDM->>CDM: Session ìƒì„±
                    APP->>CDM: generateRequest(initData)
                    CDM->>CDM: PSSH íŒŒì‹±
                    CDM-->>APP: 'message' ì´ë²¤íŠ¸<br />(License Request)

                    APP->>LS: XHR/Fetch<br />(License Request)
                    LS->>LS: í´ë¼ì´ì–¸íŠ¸ ì¸ì¦
                    LS->>LS: ì½˜í…ì¸  í‚¤ ìƒì„±
                    LS-->>APP: Encrypted License

                    APP->>CDM: update(license)
                    CDM->>OEM: ë¼ì´ì„ ìŠ¤ ì „ë‹¬
                    OEM->>TEE: í‚¤ ì €ì¥ (Secure Storage)
                    TEE-->>OEM: ì €ì¥ ì™„ë£Œ
                    OEM-->>CDM: ì¤€ë¹„ ì™„ë£Œ
                    CDM-->>APP: ì¬ìƒ ê°€ëŠ¥

                    loop ì½˜í…ì¸  ì¬ìƒ
                    APP->>CDM: ì•”í˜¸í™”ëœ ì²­í¬
                    CDM->>OEM: ë³µí˜¸í™” ìš”ì²­
                    OEM->>TEE: í‚¤ ë¡œë“œ ë° ë³µí˜¸í™”
                    TEE-->>OEM: ë³µí˜¸í™”ëœ ë°ì´í„°
                    OEM-->>CDM: ë³µí˜¸í™”ëœ ë°ì´í„°
                    CDM-->>APP: ì¬ìƒìš© ë°ì´í„°
                    APP->>APP: ë””ì½”ë”© ë° ë Œë”ë§
                    end
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 30px; margin-bottom: 15px;">
                ğŸ“‹ ë‹¨ê³„ë³„ ìƒì„¸ ì„¤ëª…
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">1ï¸âƒ£ ë¯¸ë””ì–´ ê°ì§€</h3>
                    <div class="card-description">
                        <ul>
                            <li>HTML5 <code>&lt;video&gt;</code> ë˜ëŠ” ì•±ì´ ì•”í˜¸í™”ëœ ë¯¸ë””ì–´ ë¡œë“œ</li>
                            <li><code>encrypted</code> ì´ë²¤íŠ¸ ë°œìƒ</li>
                            <li>initDataì— PSSH ì •ë³´ í¬í•¨</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">2ï¸âƒ£ Key System ì„ íƒ</h3>
                    <div class="card-description">
                        <ul>
                            <li><code>navigator.requestMediaKeySystemAccess()</code></li>
                            <li>"com.widevine.alpha" ì„ íƒ</li>
                            <li>MediaKeys ê°ì²´ ìƒì„±</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">3ï¸âƒ£ ì„¸ì…˜ ìƒì„±</h3>
                    <div class="card-description">
                        <ul>
                            <li>MediaKeySession ê°ì²´ ìƒì„±</li>
                            <li>ì„¸ì…˜ íƒ€ì…: "temporary" ë˜ëŠ” "persistent"</li>
                            <li><code>generateRequest(initData)</code> í˜¸ì¶œ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">4ï¸âƒ£ ë¼ì´ì„ ìŠ¤ ìš”ì²­</h3>
                    <div class="card-description">
                        <ul>
                            <li>CDMì´ ë¼ì´ì„ ìŠ¤ ìš”ì²­ ë©”ì‹œì§€ ìƒì„±</li>
                            <li><code>message</code> ì´ë²¤íŠ¸ë¡œ ì•±ì— ì „ë‹¬</li>
                            <li>ì•±ì´ License Serverë¡œ XHR ì „ì†¡</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">5ï¸âƒ£ ë¼ì´ì„ ìŠ¤ ë°œê¸‰</h3>
                    <div class="card-description">
                        <ul>
                            <li>License Serverê°€ í´ë¼ì´ì–¸íŠ¸ ì¸ì¦</li>
                            <li>ì½˜í…ì¸  í‚¤ ìƒì„± ë° ì•”í˜¸í™”</li>
                            <li>ì•”í˜¸í™”ëœ ë¼ì´ì„ ìŠ¤ ì‘ë‹µ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">6ï¸âƒ£ í‚¤ í”„ë¡œë¹„ì €ë‹</h3>
                    <div class="card-description">
                        <ul>
                            <li><code>session.update(license)</code> í˜¸ì¶œ</li>
                            <li>CDMì´ OEMCryptoë¡œ ë¼ì´ì„ ìŠ¤ ì „ë‹¬</li>
                            <li>TEEì— ë³µí˜¸í™” í‚¤ ì•ˆì „í•˜ê²Œ ì €ì¥</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">7ï¸âƒ£ ì½˜í…ì¸  ë³µí˜¸í™”</h3>
                    <div class="card-description">
                        <ul>
                            <li>ì•”í˜¸í™”ëœ ë¯¸ë””ì–´ ì²­í¬ë¥¼ CDMì— ì „ë‹¬</li>
                            <li>OEMCryptoê°€ TEE ë‚´ì—ì„œ ë³µí˜¸í™”</li>
                            <li>ë³µí˜¸í™”ëœ ë°ì´í„°ë¥¼ í”Œë ˆì´ì–´ì— ë°˜í™˜</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">8ï¸âƒ£ ì¬ìƒ</h3>
                    <div class="card-description">
                        <ul>
                            <li>ë””ì½”ë”ê°€ ë³µí˜¸í™”ëœ ë°ì´í„° ì²˜ë¦¬</li>
                            <li>ë Œë”ëŸ¬ê°€ í™”ë©´ì— ì¶œë ¥</li>
                            <li>A/V ë™ê¸°í™” ìœ ì§€</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: Android Integration -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">5</span>
                Android í†µí•©
            </h2>
            <p class="section-description">
                Widevineì´ Android Media Frameworkì™€ ì–´ë–»ê²Œ í†µí•©ë˜ëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph APP_LAYER["Application Layer"]
                    EXOPLAYER["ExoPlayer / MediaPlayer"]
                    end

                    subgraph FRAMEWORK["Android Framework"]
                    MEDIADRM["MediaDrm API"]
                    MEDIACRYPTO["MediaCrypto"]
                    MEDIACODEC["MediaCodec"]
                    end

                    subgraph NATIVE["Native Layer"]
                    LIBMEDIADRM["libmediadrm"]
                    DRMHAL["DrmHal (AIDL)"]
                    CRYPTOHAL["CryptoHal (AIDL)"]
                    end

                    subgraph VENDOR["Vendor Layer"]
                    WIDEVINE_PLUGIN["Widevine Plugin"]
                    CDM_LIB["libwvdrmengine.so"]
                    OEMCRYPTO_LIB["liboemcrypto.so"]
                    end

                    subgraph SECURE["Secure World"]
                    TEE_OS["TEE OS (TrustZone)"]
                    TRUSTLET["Widevine Trustlet"]
                    KEY_STORE["Secure Key Storage"]
                    end

                    EXOPLAYER --> MEDIADRM
                    EXOPLAYER --> MEDIACRYPTO
                    MEDIACRYPTO --> MEDIACODEC
                    MEDIADRM --> LIBMEDIADRM
                    LIBMEDIADRM --> DRMHAL & CRYPTOHAL
                    DRMHAL --> WIDEVINE_PLUGIN
                    CRYPTOHAL --> WIDEVINE_PLUGIN
                    WIDEVINE_PLUGIN --> CDM_LIB
                    CDM_LIB --> OEMCRYPTO_LIB
                    OEMCRYPTO_LIB --> TEE_OS
                    TEE_OS --> TRUSTLET
                    TRUSTLET --> KEY_STORE

                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“±</span>
                        Application Layer
                    </h3>
                    <div class="card-description">
                        <p>ì•±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¯¸ë””ì–´ í”Œë ˆì´ì–´</p>
                        <ul>
                            <li><strong>ExoPlayer</strong>: Google ê¶Œì¥, DRM ì™„ë²½ ì§€ì›</li>
                            <li><strong>MediaPlayer</strong>: ì‹œìŠ¤í…œ ê¸°ë³¸ í”Œë ˆì´ì–´</li>
                            <li>MediaDrm APIë¡œ ë¼ì´ì„ ìŠ¤ ê´€ë¦¬</li>
                            <li>MediaCryptoë¡œ ë³µí˜¸í™” ì—°ê²°</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”§</span>
                        Framework Layer
                    </h3>
                    <div class="card-description">
                        <p>Android DRM í”„ë ˆì„ì›Œí¬</p>
                        <ul>
                            <li><code>android.media.MediaDrm</code>: DRM ì„¸ì…˜ ê´€ë¦¬</li>
                            <li><code>MediaCrypto</code>: ë³µí˜¸í™” ì„¸ì…˜</li>
                            <li><code>MediaCodec</code>ê³¼ í†µí•©</li>
                            <li>UUIDë¡œ DRM ìŠ¤í‚´ ì‹ë³„</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš™ï¸</span>
                        Native Layer
                    </h3>
                    <div class="card-description">
                        <p>HAL ì¸í„°í˜ì´ìŠ¤</p>
                        <ul>
                            <li><code>libmediadrm</code>: ë„¤ì´í‹°ë¸Œ DRM ë¼ì´ë¸ŒëŸ¬ë¦¬</li>
                            <li><strong>DrmHal</strong>: ë¼ì´ì„ ìŠ¤ ê´€ë¦¬ HAL (AIDL)</li>
                            <li><strong>CryptoHal</strong>: ë³µí˜¸í™” HAL (AIDL)</li>
                            <li>Android 11+ë¶€í„° AIDL ê¸°ë°˜</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”Œ</span>
                        Vendor Layer
                    </h3>
                    <div class="card-description">
                        <p>Widevine í”ŒëŸ¬ê·¸ì¸</p>
                        <ul>
                            <li><code>libwvdrmengine.so</code>: Widevine CDM</li>
                            <li><code>liboemcrypto.so</code>: OEMCrypto êµ¬í˜„</li>
                            <li>ë²¤ë”ë³„ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥</li>
                            <li>Google ì¸ì¦ í•„ìš” (L1)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ›¡ï¸</span>
                        Secure World
                    </h3>
                    <div class="card-description">
                        <p>TrustZone ë³´ì•ˆ ì˜ì—­</p>
                        <ul>
                            <li><strong>TEE OS</strong>: ì‹ ë¢° ì‹¤í–‰ í™˜ê²½ ìš´ì˜ì²´ì œ</li>
                            <li><strong>Widevine Trustlet</strong>: TEE ë‚´ Widevine ì—ì´ì „íŠ¸</li>
                            <li><strong>Secure Key Storage</strong>: í•˜ë“œì›¨ì–´ í‚¤ ì €ì¥ì†Œ</li>
                            <li>Normal Worldì™€ ê²©ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        í™•ì¸ ë°©ë²•
                    </h3>
                    <div class="card-description">
                        <p>Android ê¸°ê¸°ì˜ Widevine ë ˆë²¨ í™•ì¸</p>
                        <ul>
                            <li><strong>DRM Info</strong> ì•± ì„¤ì¹˜ (Play Store)</li>
                            <li><code>MediaDrm.getPropertyString()</code> API ì‚¬ìš©</li>
                            <li>ë³´ì•ˆ ë ˆë²¨ í™•ì¸: L1/L2/L3</li>
                            <li>ë£¨íŒ… ì‹œ L3ë¡œ ê°•ë“±ë  ìˆ˜ ìˆìŒ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6: Security & Best Practices -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">6</span>
                ë³´ì•ˆ ë° ëª¨ë²” ì‚¬ë¡€
            </h2>
            <p class="section-description">
                Widevine DRMì„ ì•ˆì „í•˜ê³  íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ê³¼ ëª¨ë²” ì‚¬ë¡€ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âœ…</span>
                        ë³´ì•ˆ ê°•í™”
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>í•­ìƒ L1 ë ˆë²¨ ê¸°ê¸° ê¶Œì¥</li>
                            <li>HTTPSë¡œ ë¼ì´ì„ ìŠ¤ ìš”ì²­</li>
                            <li>ë¼ì´ì„ ìŠ¤ ë§Œë£Œ ì‹œê°„ ì„¤ì •</li>
                            <li>ì¬ìƒ íšŸìˆ˜ ì œí•œ</li>
                            <li>ê¸°ê¸° í”„ë¡œë¹„ì €ë‹ ê´€ë¦¬</li>
                            <li>ë£¨íŒ… ê°ì§€ êµ¬í˜„</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¬</span>
                        ì½˜í…ì¸  ë³´í˜¸
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>HD/4K ì½˜í…ì¸ ëŠ” L1ë§Œ í—ˆìš©</li>
                            <li>HDCP (High-bandwidth Digital Content Protection) ì ìš©</li>
                            <li>í™”ë©´ ìº¡ì²˜ ë°©ì§€ (L1)</li>
                            <li>ì›Œí„°ë§ˆí‚¹ ì¶”ê°€ ê³ ë ¤</li>
                            <li>ì €ì‘ê¶Œ ì •ë³´ ì‚½ì…</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš ï¸</span>
                        ì•Œë ¤ì§„ ì œí•œì‚¬í•­
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>ë£¨íŒ…ëœ ê¸°ê¸°ëŠ” L3ë¡œ ê°•ë“±</li>
                            <li>Custom ROM ì‚¬ìš© ì‹œ L3</li>
                            <li>Bootloader ì–¸ë½ ì‹œ L3</li>
                            <li>ì†Œí”„íŠ¸ì›¨ì–´ ì—…ë°ì´íŠ¸ í›„ ë ˆë²¨ ë³€ê²½ ê°€ëŠ¥</li>
                            <li>L3 ê¸°ê¸°ëŠ” SD í™”ì§ˆ ì œí•œ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”§</span>
                        ê°œë°œ ê¶Œì¥ì‚¬í•­
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>ExoPlayer ì‚¬ìš© ê¶Œì¥ (Android)</li>
                            <li>Persistent ë¼ì´ì„ ìŠ¤ë¡œ ì˜¤í”„ë¼ì¸ ì¬ìƒ ì§€ì›</li>
                            <li>ë¼ì´ì„ ìŠ¤ ê°±ì‹  ë¡œì§ êµ¬í˜„</li>
                            <li>ì—ëŸ¬ ì²˜ë¦¬ ë° í´ë°±</li>
                            <li>ë³´ì•ˆ ë ˆë²¨ë³„ í™”ì§ˆ ì¡°ì •</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“Š</span>
                        ì„±ëŠ¥ ìµœì í™”
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>ë¼ì´ì„ ìŠ¤ ë¯¸ë¦¬ ë¡œë“œ (Pre-fetch)</li>
                            <li>ì„¸ì…˜ ì¬ì‚¬ìš©</li>
                            <li>í•˜ë“œì›¨ì–´ ë””ì½”ë” í™œìš©</li>
                            <li>ë²„í¼ë§ ìµœì í™”</li>
                            <li>ë„¤íŠ¸ì›Œí¬ ìƒíƒœì— ë”°ë¥¸ ABR</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ›</span>
                        ë””ë²„ê¹… íŒ
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>DRM Info ì•±ìœ¼ë¡œ ë³´ì•ˆ ë ˆë²¨ í™•ì¸</li>
                            <li>Chrome DevToolsì˜ EME ë¡œê·¸ í™œìš©</li>
                            <li>Android Logcatìœ¼ë¡œ MediaDrm ë¡œê·¸ í™•ì¸</li>
                            <li><code>adb shell dumpsys media.drm</code></li>
                            <li>ë¼ì´ì„ ìŠ¤ ìš”ì²­/ì‘ë‹µ ê²€ì¦</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 7: Code Examples -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">7</span>
                ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ
            </h2>
            <p class="section-description">
                Android MediaDrm API, ExoPlayer DRM ì„¤ì •, Web EME êµ¬í˜„ ì˜ˆì‹œì…ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 30px; margin-bottom: 15px;">
                7-1. Android MediaDrm API ì‚¬ìš©
            </h3>
            <div class="code-block">
                <pre><code class="language-kotlin">// Widevine MediaDrm ì´ˆê¸°í™”
val WIDEVINE_UUID = UUID(-0x121074568629b532L, -0x5c37d8232ae2de13L)
// "edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"

val mediaDrm = MediaDrm(WIDEVINE_UUID)

// ë³´ì•ˆ ë ˆë²¨ í™•ì¸
val securityLevel = mediaDrm.getPropertyString(MediaDrm.PROPERTY_SECURITY_LEVEL)
Log.d(TAG, "Widevine Security Level: $securityLevel") // "L1", "L2", or "L3"

// ì„¸ì…˜ ìƒì„±
val sessionId = mediaDrm.openSession()

// ë¼ì´ì„ ìŠ¤ ìš”ì²­ ìƒì„±
val initData = extractInitData(encryptedContent) // PSSH ë°ì´í„°
val keyRequest = mediaDrm.getKeyRequest(
    sessionId,
    initData,
    "video/mp4",
    MediaDrm.KEY_TYPE_STREAMING,
    null // Optional parameters
)

// ë¼ì´ì„ ìŠ¤ ì„œë²„ë¡œ ìš”ì²­
val licenseUrl = "https://license.example.com/widevine"
val licenseResponse = sendLicenseRequest(licenseUrl, keyRequest.data)

// ë¼ì´ì„ ìŠ¤ ì œê³µ
mediaDrm.provideKeyResponse(sessionId, licenseResponse)

// MediaCrypto ìƒì„± (MediaCodecê³¼ ì—°ë™)
val mediaCrypto = MediaCrypto(WIDEVINE_UUID, sessionId)

// MediaCodec ì„¤ì •
val mediaCodec = MediaCodec.createDecoderByType("video/avc")
mediaCodec.configure(format, surface, mediaCrypto, 0)

// ì¬ìƒ ì™„ë£Œ í›„ ì •ë¦¬
mediaDrm.closeSession(sessionId)
mediaDrm.release()
mediaCrypto.release()</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                7-2. ExoPlayer Widevine DRM ì„¤ì •
            </h3>
            <div class="code-block">
                <pre><code class="language-kotlin">// ExoPlayer with Widevine DRM
val drmCallback = HttpMediaDrmCallback(
    "https://license.example.com/widevine",
    DefaultHttpDataSource.Factory()
)

// DRM ì„¸ì…˜ ë§¤ë‹ˆì €
val drmSessionManager = DefaultDrmSessionManager.Builder()
    .setUuidAndExoMediaDrmProvider(
        C.WIDEVINE_UUID,
        FrameworkMediaDrm.DEFAULT_PROVIDER
    )
    .setMultiSession(false)
    .build(drmCallback)

// MediaSource ìƒì„±
val mediaItem = MediaItem.Builder()
    .setUri("https://example.com/encrypted_video.mpd")
    .setDrmConfiguration(
        MediaItem.DrmConfiguration.Builder(C.WIDEVINE_UUID)
            .setLicenseUri("https://license.example.com/widevine")
            .setMultiSession(false)
            .build()
    )
    .build()

val mediaSource = DashMediaSource.Factory(dataSourceFactory)
    .setDrmSessionManagerProvider { drmSessionManager }
    .createMediaSource(mediaItem)

// ExoPlayer ì„¤ì •
val player = ExoPlayer.Builder(context)
    .build()
    .apply {
        setMediaSource(mediaSource)
        prepare()
        playWhenReady = true
    }

// DRM ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
player.addListener(object : Player.Listener {
    override fun onPlayerError(error: PlaybackException) {
        if (error.cause is DrmSession.DrmSessionException) {
            Log.e(TAG, "DRM Error: ${error.message}")
            handleDrmError(error)
        }
    }
})</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                7-3. Web EME (Encrypted Media Extensions) êµ¬í˜„
            </h3>
            <div class="code-block">
                <pre><code class="language-javascript">// Webì—ì„œ Widevine ì‚¬ìš©
const video = document.querySelector('video');

// Widevine Key System í™•ì¸
const config = [{
    initDataTypes: ['cenc'],
    videoCapabilities: [{
        contentType: 'video/mp4; codecs="avc1.42E01E"',
        robustness: 'SW_SECURE_CRYPTO' // or 'HW_SECURE_ALL' for L1
    }],
    audioCapabilities: [{
        contentType: 'audio/mp4; codecs="mp4a.40.2"'
    }]
}];

navigator.requestMediaKeySystemAccess('com.widevine.alpha', config)
    .then(keySystemAccess => {
        return keySystemAccess.createMediaKeys();
    })
    .then(mediaKeys => {
        video.setMediaKeys(mediaKeys);
        const keySession = mediaKeys.createSession();

        // 'encrypted' ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        video.addEventListener('encrypted', event => {
            console.log('Encrypted event:', event.initDataType);

            keySession.generateRequest(event.initDataType, event.initData)
                .then(() => {
                    console.log('License request generated');
                })
                .catch(error => {
                    console.error('generateRequest failed:', error);
                });
        });

        // 'message' ì´ë²¤íŠ¸: ë¼ì´ì„ ìŠ¤ ìš”ì²­
        keySession.addEventListener('message', event => {
            console.log('License request:', event.messageType);

            fetch('https://license.example.com/widevine', {
                method: 'POST',
                headers: { 'Content-Type': 'application/octet-stream' },
                body: event.message
            })
            .then(response => response.arrayBuffer())
            .then(license => {
                return keySession.update(license);
            })
            .then(() => {
                console.log('License updated successfully');
            })
            .catch(error => {
                console.error('License update failed:', error);
            });
        });

        return keySession;
    })
    .catch(error => {
        console.error('MediaKeySystemAccess failed:', error);
    });

// ë¹„ë””ì˜¤ ì¬ìƒ
video.src = 'https://example.com/encrypted_video.mp4';
video.play();</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                7-4. ë¼ì´ì„ ìŠ¤ ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
            </h3>
            <div class="code-block">
                <pre><code class="language-kotlin">// ë¼ì´ì„ ìŠ¤ ì„œë²„ í†µì‹ 
suspend fun sendLicenseRequest(url: String, requestData: ByteArray): ByteArray {
    return withContext(Dispatchers.IO) {
        val connection = URL(url).openConnection() as HttpURLConnection
        try {
            connection.apply {
                requestMethod = "POST"
                doOutput = true
                doInput = true
                setRequestProperty("Content-Type", "application/octet-stream")
                setRequestProperty("User-Agent", "Widevine CDM")
            }

            // ìš”ì²­ ì „ì†¡
            connection.outputStream.use { it.write(requestData) }

            // ì‘ë‹µ ìˆ˜ì‹ 
            if (connection.responseCode == HttpURLConnection.HTTP_OK) {
                connection.inputStream.use { it.readBytes() }
            } else {
                throw IOException("License request failed: ${connection.responseCode}")
            }
        } finally {
            connection.disconnect()
        }
    }
}

// PSSH ë°ì´í„° ì¶”ì¶œ
fun extractInitData(mp4Data: ByteArray): ByteArray? {
    // MP4ì—ì„œ 'pssh' box ì°¾ê¸°
    var offset = 0
    while (offset < mp4Data.size - 8) {
        val boxSize = ByteBuffer.wrap(mp4Data, offset, 4).int
        val boxType = String(mp4Data, offset + 4, 4)

        if (boxType == "pssh") {
            return mp4Data.copyOfRange(offset, offset + boxSize)
        }

        offset += boxSize
    }
    return null
}</code></pre>
            </div>
        </section>

        <!-- Section 8: DRM HAL (AIDL) Implementation -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">8</span>
                DRM HAL (AIDL) êµ¬í˜„
            </h2>
            <p class="section-description">
                Android 11+ì—ì„œ ì‚¬ìš©ë˜ëŠ” AIDL ê¸°ë°˜ DRM/Crypto HAL ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 30px; margin-bottom: 15px;">
                8-1. IDrmPlugin.aidl ì¸í„°í˜ì´ìŠ¤
            </h3>
            <div class="code-block">
                <pre><code class="language-java">// hardware/interfaces/drm/aidl/android/hardware/drm/IDrmPlugin.aidl
package android.hardware.drm;

interface IDrmPlugin {
    // ì„¸ì…˜ ê´€ë¦¬
    byte[] openSession(in SecurityLevel securityLevel);
    void closeSession(in byte[] sessionId);

    // í‚¤ ìš”ì²­/ì‘ë‹µ
    KeyRequest getKeyRequest(
        in byte[] scope,
        in byte[] initData,
        in String mimeType,
        in KeyType keyType,
        in KeyValue[] optionalParameters
    );

    byte[] provideKeyResponse(
        in byte[] scope,
        in byte[] response
    );

    // í”„ë¡œë¹„ì €ë‹
    ProvisionRequest getProvisionRequest(
        in String certificateType,
        in String certificateAuthority
    );

    void provideProvisionResponse(in byte[] response);

    // ì†ì„± ê´€ë¦¬
    String getPropertyString(in String propertyName);
    byte[] getPropertyByteArray(in String propertyName);
    void setPropertyString(in String propertyName, in String value);
    void setPropertyByteArray(in String propertyName, in byte[] value);

    // ë³µí˜¸í™”
    void setCipherAlgorithm(in byte[] sessionId, in String algorithm);
    void setMacAlgorithm(in byte[] sessionId, in String algorithm);

    // ì˜¤í”„ë¼ì¸ ë¼ì´ì„ ìŠ¤
    byte[] getOfflineLicenseKeySetIds();
    void removeOfflineLicense(in byte[] keySetId);
    OfflineLicenseState getOfflineLicenseState(in byte[] keySetId);

    // ë³´ì•ˆ ì •ë³´
    SecurityLevel getSecurityLevel(in byte[] sessionId);
    byte[] getMetrics();
}</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                8-2. ICryptoPlugin.aidl ì¸í„°í˜ì´ìŠ¤
            </h3>
            <div class="code-block">
                <pre><code class="language-java">// hardware/interfaces/drm/aidl/android/hardware/drm/ICryptoPlugin.aidl
package android.hardware.drm;

interface ICryptoPlugin {
    // ë³µí˜¸í™”
    int decrypt(
        in boolean secure,
        in byte[] keyId,
        in byte[] iv,
        in Mode mode,
        in Pattern pattern,
        in SharedBuffer source,
        in long offset,
        in SubSample[] subSamples,
        in DestinationBuffer destination
    );

    // ë©”ëª¨ë¦¬ ì„¤ì •
    void setMediaDrmSession(in byte[] sessionId);
    void setSharedBufferBase(in SharedBuffer base);

    // ë³´ì•ˆ ë ˆë²¨ í™•ì¸
    SecurityLevel getSecurityLevel();

    // ë¡œê·¸ ë©”ì‹œì§€
    void notifyResolution(in int width, in int height);
    void requiresSecureDecoderComponent(in String mime);
}</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                8-3. Widevine HAL êµ¬í˜„ êµ¬ì¡° (C++)
            </h3>
            <div class="code-block">
                <pre><code class="language-cpp">// Widevine HAL êµ¬í˜„ ì˜ˆì‹œ (vendor/widevine/)
namespace aidl::android::hardware::drm {

class WidevineDrmPlugin : public BnDrmPlugin {
public:
    // ì„¸ì…˜ ê´€ë¦¬
    ndk::ScopedAStatus openSession(
        SecurityLevel securityLevel,
        std::vector&lt;uint8_t&gt;* sessionId
    ) override {
        // OEMCrypto_OpenSession í˜¸ì¶œ
        OEMCryptoResult result = OEMCrypto_OpenSession(sessionId->data());
        if (result != OEMCrypto_SUCCESS) {
            return ndk::ScopedAStatus::fromServiceSpecificError(
                static_cast&lt;int32_t&gt;(Status::ERROR_DRM_SESSION_NOT_OPENED)
            );
        }
        return ndk::ScopedAStatus::ok();
    }

    // í‚¤ ìš”ì²­ ìƒì„±
    ndk::ScopedAStatus getKeyRequest(
        const std::vector&lt;uint8_t&gt;& scope,
        const std::vector&lt;uint8_t&gt;& initData,
        const std::string& mimeType,
        KeyType keyType,
        const std::vector&lt;KeyValue&gt;& optionalParameters,
        KeyRequest* keyRequest
    ) override {
        // PSSH íŒŒì‹±
        wv::InitDataParser parser;
        if (!parser.parse(initData)) {
            return ndk::ScopedAStatus::fromServiceSpecificError(
                static_cast&lt;int32_t&gt;(Status::ERROR_DRM_CANNOT_HANDLE)
            );
        }

        // CDMì— ë¼ì´ì„ ìŠ¤ ìš”ì²­ ìƒì„±
        cdm::LicenseRequest request;
        request.set_content_id(parser.getContentId());
        request.set_session_id(scope.data(), scope.size());

        keyRequest->request = request.SerializeAsString();
        keyRequest->requestType = KeyRequestType::INITIAL;
        keyRequest->defaultUrl = "https://license.widevine.com/cenc/getlicense";

        return ndk::ScopedAStatus::ok();
    }

    // í‚¤ ì‘ë‹µ ì œê³µ
    ndk::ScopedAStatus provideKeyResponse(
        const std::vector&lt;uint8_t&gt;& scope,
        const std::vector&lt;uint8_t&gt;& response,
        std::vector&lt;uint8_t&gt;* keySetId
    ) override {
        // ë¼ì´ì„ ìŠ¤ íŒŒì‹±
        cdm::License license;
        if (!license.ParseFromArray(response.data(), response.size())) {
            return ndk::ScopedAStatus::fromServiceSpecificError(
                static_cast&lt;int32_t&gt;(Status::ERROR_DRM_CANNOT_HANDLE)
            );
        }

        // OEMCryptoë¡œ í‚¤ ë¡œë“œ
        for (const auto& key : license.key()) {
            OEMCrypto_LoadKeys(
                scope.data(),
                key.id().data(), key.id().size(),
                key.key_data().data(), key.key_data().size()
            );
        }

        *keySetId = license.key_set_id();
        return ndk::ScopedAStatus::ok();
    }

private:
    wv::CdmEngine cdm_engine_;
};</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                8-4. Binder í†µì‹  ë©”ì»¤ë‹ˆì¦˜
            </h3>
            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant App as MediaDrm (Java)
                    participant JNI as libmediadrm (JNI)
                    participant Binder as Binder IPC
                    participant HAL as DrmPlugin (AIDL)
                    participant OEM as OEMCrypto

                    App->>JNI: openSession()
                    JNI->>Binder: AIDL Call
                    Binder->>HAL: openSession()
                    HAL->>OEM: OEMCrypto_OpenSession()
                    OEM-->>HAL: sessionId
                    HAL-->>Binder: sessionId
                    Binder-->>JNI: sessionId
                    JNI-->>App: sessionId

                    App->>JNI: getKeyRequest()
                    JNI->>Binder: AIDL Call
                    Binder->>HAL: getKeyRequest()
                    HAL->>HAL: Generate Request
                    HAL-->>Binder: KeyRequest
                    Binder-->>JNI: KeyRequest
                    JNI-->>App: KeyRequest
                </div>
            </div>

            <div class="content-grid" style="margin-top: 30px;">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”§</span>
                        HIDL vs AIDL
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>HIDL (Android 8-10)</strong>: Legacy HAL, hwservicemanager</li>
                            <li><strong>AIDL (Android 11+)</strong>: í˜„ëŒ€ì  ì¸í„°í˜ì´ìŠ¤, servicemanager</li>
                            <li>AIDLì´ ë” ê°„ê²°í•˜ê³  ìœ ì§€ë³´ìˆ˜ ì‰¬ì›€</li>
                            <li>HIDLì€ Deprecated, AIDL ë§ˆì´ê·¸ë ˆì´ì…˜ ê¶Œì¥</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 9: OEMCrypto API Details -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">9</span>
                OEMCrypto API ìƒì„¸
            </h2>
            <p class="section-description">
                Widevine OEMCryptoëŠ” TEE ë‚´ì—ì„œ ì‹¤í–‰ë˜ëŠ” í•˜ë“œì›¨ì–´ ë³´ì•ˆ ëª¨ë“ˆì˜ APIì…ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 30px; margin-bottom: 15px;">
                9-1. í•µì‹¬ OEMCrypto í•¨ìˆ˜
            </h3>
            <div class="code-block">
                <pre><code class="language-cpp">// OEMCrypto API (vendor/widevine/libwvdrmengine/oemcrypto/include/OEMCryptoCENC.h)

// ì´ˆê¸°í™”
OEMCryptoResult OEMCrypto_Initialize(void);
OEMCryptoResult OEMCrypto_Terminate(void);

// ì„¸ì…˜ ê´€ë¦¬
OEMCryptoResult OEMCrypto_OpenSession(OEMCrypto_SESSION* session);
OEMCryptoResult OEMCrypto_CloseSession(OEMCrypto_SESSION session);

// í‚¤ ë¡œë“œ
OEMCryptoResult OEMCrypto_LoadKeys(
    OEMCrypto_SESSION session,
    const uint8_t* message,
    size_t message_length,
    const uint8_t* signature,
    size_t signature_length,
    const uint8_t* enc_mac_key_iv,
    const uint8_t* enc_mac_key,
    size_t num_keys,
    const OEMCrypto_KeyObject* key_array
);

// ë³µí˜¸í™”
OEMCryptoResult OEMCrypto_DecryptCENC(
    OEMCrypto_SESSION session,
    const uint8_t* data_addr,
    size_t data_length,
    bool is_encrypted,
    const uint8_t* iv,
    size_t block_offset,
    const OEMCrypto_DestBufferDesc* out_buffer,
    OEMCrypto_DestBufferType out_buffer_type,
    const OEMCrypto_CENCEncryptPatternDesc* pattern
);

// í‚¤ ê°±ì‹ 
OEMCryptoResult OEMCrypto_RefreshKeys(
    OEMCrypto_SESSION session,
    const uint8_t* message,
    size_t message_length,
    const uint8_t* signature,
    size_t signature_length,
    size_t num_keys,
    const OEMCrypto_KeyRefreshObject* key_array
);

// Usage Table (ì‚¬ìš© ì¶”ì )
OEMCryptoResult OEMCrypto_UpdateUsageTable(
    OEMCrypto_SESSION session
);

OEMCryptoResult OEMCrypto_DeactivateUsageEntry(
    const uint8_t* pst,
    size_t pst_length
);

// í”„ë¡œë¹„ì €ë‹
OEMCryptoResult OEMCrypto_GetDeviceID(
    uint8_t* device_id,
    size_t* id_length
);

OEMCryptoResult OEMCrypto_GetKeyData(
    uint8_t* key_data,
    size_t* key_data_length
);

// HDCP
OEMCryptoResult OEMCrypto_GetHDCPCapability(
    OEMCrypto_HDCP_Capability* current,
    OEMCrypto_HDCP_Capability* maximum
);</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                9-2. TEE í†µì‹  í”„ë¡œí† ì½œ
            </h3>
            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant CDM as Widevine CDM<br/>(Normal World)
                    participant OEM as OEMCrypto<br/>(REE)
                    participant TEE_OS as TEE OS<br/>(TrustZone)
                    participant Trust as Widevine Trustlet<br/>(Secure World)

                    CDM->>OEM: OEMCrypto_LoadKeys()
                    OEM->>TEE_OS: SMC (Secure Monitor Call)
                    TEE_OS->>Trust: Invoke Trustlet
                    Trust->>Trust: Decrypt & Verify Keys
                    Trust->>Trust: Store in Secure RAM
                    Trust-->>TEE_OS: Success
                    TEE_OS-->>OEM: Return to REE
                    OEM-->>CDM: OEMCrypto_SUCCESS

                    CDM->>OEM: OEMCrypto_DecryptCENC()
                    OEM->>TEE_OS: SMC with encrypted data
                    TEE_OS->>Trust: Decrypt Request
                    Trust->>Trust: Load Key from Secure RAM
                    Trust->>Trust: AES-CTR Decrypt
                    Trust-->>TEE_OS: Decrypted Data
                    TEE_OS-->>OEM: Decrypted Buffer
                    OEM-->>CDM: Decrypted Data
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                9-3. Keybox í”„ë¡œë¹„ì €ë‹
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”‘</span>
                        Keyboxë€?
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>ê¸°ê¸° ê³ ìœ ì˜ ì•”í˜¸í™” í‚¤ ì„¸íŠ¸</li>
                            <li>ì œì¡° ê³¼ì •ì—ì„œ ì•ˆì „í•˜ê²Œ ì£¼ì…</li>
                            <li>Device ID, Encryption Key í¬í•¨</li>
                            <li>TEE ë‚´ Secure Storageì— ì €ì¥</li>
                            <li>Google ì¸ì¦ í•„ìˆ˜ (L1)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ­</span>
                        í”„ë¡œë¹„ì €ë‹ í”„ë¡œì„¸ìŠ¤
                    </h3>
                    <div class="card-description">
                        <ol>
                            <li>ì œì¡°ì‚¬ê°€ Googleì— Keybox ìš”ì²­</li>
                            <li>Googleì´ ì•”í˜¸í™”ëœ Keybox ìƒì„±</li>
                            <li>ì œì¡° ë¼ì¸ì—ì„œ TEEì— ì£¼ì…</li>
                            <li>OEMCrypto_GetDeviceID()ë¡œ ê²€ì¦</li>
                            <li>ë¼ì´ì„ ìŠ¤ ì„œë²„ê°€ Device ID ì¸ì¦</li>
                        </ol>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                9-4. Usage Table ê´€ë¦¬
            </h3>
            <div class="code-block">
                <pre><code class="language-cpp">// Usage Table: ì˜¤í”„ë¼ì¸ ë¼ì´ì„ ìŠ¤ ì‚¬ìš© ì¶”ì 
struct OEMCrypto_UsageEntry {
    uint8_t pst[32];              // Provider Session Token
    uint64_t time_of_first_use;   // ì²« ì‚¬ìš© ì‹œê°„
    uint64_t time_of_last_use;    // ë§ˆì§€ë§‰ ì‚¬ìš© ì‹œê°„
    uint32_t usage_count;         // ì‚¬ìš© íšŸìˆ˜
    OEMCrypto_UsageEntryStatus status;
};

// Usage Table ì—…ë°ì´íŠ¸
OEMCryptoResult OEMCrypto_UpdateUsageTable(OEMCrypto_SESSION session) {
    // í˜„ì¬ ì„¸ì…˜ì˜ ì‚¬ìš© ì •ë³´ë¥¼ Usage Tableì— ê¸°ë¡
    // TEE ë‚´ Secure Storageì— ì˜êµ¬ ì €ì¥
    // ë¼ì´ì„ ìŠ¤ ì •ì±… ìœ„ë°˜ ì‹œ ì¬ìƒ ì°¨ë‹¨
    return OEMCrypto_SUCCESS;
}

// ë¹„í™œì„±í™”
OEMCryptoResult OEMCrypto_DeactivateUsageEntry(
    const uint8_t* pst,
    size_t pst_length
) {
    // íŠ¹ì • PSTì˜ Usage Entry ì‚­ì œ
    // ì˜¤í”„ë¼ì¸ ë¼ì´ì„ ìŠ¤ í•´ì œ ì‹œ ì‚¬ìš©
    return OEMCrypto_SUCCESS;
}</code></pre>
            </div>

            <table class="comparison-table" style="margin-top: 30px;">
                <thead>
                    <tr>
                        <th>OEMCrypto í•¨ìˆ˜</th>
                        <th>ì‹¤í–‰ ìœ„ì¹˜</th>
                        <th>ìš©ë„</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>OEMCrypto_Initialize</td>
                        <td>REE â†’ TEE</td>
                        <td>OEMCrypto ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ˆê¸°í™”</td>
                    </tr>
                    <tr>
                        <td>OEMCrypto_OpenSession</td>
                        <td>TEE</td>
                        <td>ì•”í˜¸í™” ì„¸ì…˜ ìƒì„±</td>
                    </tr>
                    <tr>
                        <td>OEMCrypto_LoadKeys</td>
                        <td>TEE (Trustlet)</td>
                        <td>ë¼ì´ì„ ìŠ¤ì—ì„œ ì½˜í…ì¸  í‚¤ ì¶”ì¶œ ë° ì €ì¥</td>
                    </tr>
                    <tr>
                        <td>OEMCrypto_DecryptCENC</td>
                        <td>TEE (Trustlet)</td>
                        <td>ì•”í˜¸í™”ëœ ë¯¸ë””ì–´ ë°ì´í„° ë³µí˜¸í™”</td>
                    </tr>
                    <tr>
                        <td>OEMCrypto_GetDeviceID</td>
                        <td>TEE (Keybox)</td>
                        <td>ê¸°ê¸° ê³ ìœ  ID ì¡°íšŒ</td>
                    </tr>
                    <tr>
                        <td>OEMCrypto_UpdateUsageTable</td>
                        <td>TEE (Secure Storage)</td>
                        <td>ì˜¤í”„ë¼ì¸ ë¼ì´ì„ ìŠ¤ ì‚¬ìš© ì¶”ì </td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Section 10: Widevine Certification Process -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">10</span>
                Widevine ì¸ì¦ í”„ë¡œì„¸ìŠ¤
            </h2>
            <p class="section-description">
                Widevine L1 ë³´ì•ˆ ë ˆë²¨ ì¸ì¦ì„ ë°›ê¸° ìœ„í•œ Google ì¸ì¦ ì ˆì°¨ì…ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 30px; margin-bottom: 15px;">
                10-1. ì¸ì¦ ë‹¨ê³„
            </h3>
            <div class="mermaid-container">
                <div class="mermaid">
                    graph LR
                    A[1. ì‚¬ì „ ì¤€ë¹„] --> B[2. CWTS ë“±ë¡]
                    B --> C[3. êµ¬í˜„ ê°œë°œ]
                    C --> D[4. Self-Test]
                    D --> E[5. Google ì œì¶œ]
                    E --> F[6. Robustness Test]
                    F --> G[7. ì¸ì¦ ìŠ¹ì¸]
                    G --> H[8. Keybox ë°œê¸‰]
                    H --> I[9. ì–‘ì‚° ì ìš©]

                    style A fill:#e3f2fd
                    style G fill:#c8e6c9
                    style I fill:#fff9c4
                </div>
            </div>

            <div class="content-grid" style="margin-top: 30px;">
                <div class="card">
                    <h3 class="card-title">1ï¸âƒ£ ì‚¬ì „ ì¤€ë¹„</h3>
                    <div class="card-description">
                        <ul>
                            <li>TEE í™˜ê²½ êµ¬ì¶• (TrustZone, OP-TEE ë“±)</li>
                            <li>OEMCrypto ë¼ì´ë¸ŒëŸ¬ë¦¬ í†µí•©</li>
                            <li>DRM HAL êµ¬í˜„</li>
                            <li>Widevine CDM ë¼ì´ì„ ìŠ¤ ê³„ì•½</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">2ï¸âƒ£ CWTS ë“±ë¡</h3>
                    <div class="card-description">
                        <ul>
                            <li>Chrome Web Test Suite ì ‘ê·¼ ê¶Œí•œ ìš”ì²­</li>
                            <li>Google íŒŒíŠ¸ë„ˆ í¬í„¸ ê³„ì • í•„ìš”</li>
                            <li>ì œì¡°ì‚¬ ì •ë³´ ì œì¶œ</li>
                            <li>NDA ì„œëª…</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">3ï¸âƒ£ êµ¬í˜„ ê°œë°œ</h3>
                    <div class="card-description">
                        <ul>
                            <li>OEMCrypto API ì „ì²´ êµ¬í˜„</li>
                            <li>Trustlet ê°œë°œ (TEE ë‚´)</li>
                            <li>Secure Video Path êµ¬í˜„</li>
                            <li>HDCP ì§€ì›</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">4ï¸âƒ£ Self-Test</h3>
                    <div class="card-description">
                        <ul>
                            <li>OEMCrypto Test Vector ì‹¤í–‰</li>
                            <li>CWTS ìë™í™” í…ŒìŠ¤íŠ¸</li>
                            <li>ë©”ëª¨ë¦¬ ë¤í”„ ê³µê²© ê²€ì¦</li>
                            <li>í™”ë©´ ìº¡ì²˜ ë°©ì§€ í™•ì¸</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">5ï¸âƒ£ Google ì œì¶œ</h3>
                    <div class="card-description">
                        <ul>
                            <li>í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë³´ê³ ì„œ ì‘ì„±</li>
                            <li>êµ¬í˜„ ì•„í‚¤í…ì²˜ ë¬¸ì„œ ì œì¶œ</li>
                            <li>ë³´ì•ˆ ë¶„ì„ ë¦¬í¬íŠ¸</li>
                            <li>ìƒ˜í”Œ ê¸°ê¸° ë°œì†¡ (ì„ íƒ)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">6ï¸âƒ£ Robustness Test</h3>
                    <div class="card-description">
                        <ul>
                            <li>Google ë³´ì•ˆ íŒ€ì˜ ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸</li>
                            <li>TEE ê²©ë¦¬ ê²€ì¦</li>
                            <li>í‚¤ ì¶”ì¶œ ì‹œë„ (ì‹¤íŒ¨í•´ì•¼ í•¨)</li>
                            <li>Secure Video Path ë¬´ê²°ì„±</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">7ï¸âƒ£ ì¸ì¦ ìŠ¹ì¸</h3>
                    <div class="card-description">
                        <ul>
                            <li>ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ ì‹œ ìŠ¹ì¸</li>
                            <li>Widevine L1 ì¸ì¦ì„œ ë°œê¸‰</li>
                            <li>ìœ íš¨ ê¸°ê°„: ì¼ë°˜ì ìœ¼ë¡œ 2ë…„</li>
                            <li>ê°±ì‹  í•„ìš”</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">8ï¸âƒ£ Keybox ë°œê¸‰</h3>
                    <div class="card-description">
                        <ul>
                            <li>ì–‘ì‚°ìš© Keybox ìš”ì²­</li>
                            <li>Googleì´ ì•”í˜¸í™”í•˜ì—¬ ì œê³µ</li>
                            <li>ì œì¡° ë¼ì¸ì—ì„œ ì£¼ì…</li>
                            <li>ê¸°ê¸°ë‹¹ ê³ ìœ  í‚¤</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">9ï¸âƒ£ ì–‘ì‚° ì ìš©</h3>
                    <div class="card-description">
                        <ul>
                            <li>ì œí’ˆì— Widevine L1 íƒ‘ì¬</li>
                            <li>ì •ê¸° ë³´ì•ˆ ì—…ë°ì´íŠ¸</li>
                            <li>ì¸ì¦ ìœ ì§€ ê´€ë¦¬</li>
                            <li>Play Protect ì¸ì¦ í†µí•©</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                10-2. Robustness Rules (ë³´ì•ˆ ìš”êµ¬ì‚¬í•­)
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>ê·œì¹™</th>
                        <th>ìš”êµ¬ì‚¬í•­</th>
                        <th>ê²€ì¦ ë°©ë²•</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>R1: í‚¤ ê²©ë¦¬</td>
                        <td>ì½˜í…ì¸  í‚¤ê°€ TEE ì™¸ë¶€ë¡œ ì ˆëŒ€ ë…¸ì¶œë˜ì§€ ì•ŠìŒ</td>
                        <td>ë©”ëª¨ë¦¬ ë¤í”„, ë””ë²„ê±° attach ì‹œë„</td>
                    </tr>
                    <tr>
                        <td>R2: ë³µí˜¸í™” ìœ„ì¹˜</td>
                        <td>ë³µí˜¸í™”ê°€ ë°˜ë“œì‹œ TEE ë‚´ì—ì„œ ìˆ˜í–‰ë¨</td>
                        <td>ë³µí˜¸í™” í”„ë¡œì„¸ìŠ¤ ì¶”ì , Timing Attack</td>
                    </tr>
                    <tr>
                        <td>R3: Secure Video Path</td>
                        <td>ë³µí˜¸í™”ëœ í”„ë ˆì„ì´ ë³´í˜¸ëœ ê²½ë¡œë¡œë§Œ ì´ë™</td>
                        <td>í™”ë©´ ìº¡ì²˜ ì‹œë„, HDMI ìŠ¤ë‹ˆí•‘</td>
                    </tr>
                    <tr>
                        <td>R4: HDCP ê°•ì œ</td>
                        <td>ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´ëŠ” HDCP 2.2+ í•„ìˆ˜</td>
                        <td>HDCP ì—†ëŠ” ëª¨ë‹ˆí„° ì—°ê²° ì‹œë„</td>
                    </tr>
                    <tr>
                        <td>R5: Root ê°ì§€</td>
                        <td>ë£¨íŒ… ê¸°ê¸°ëŠ” L3ë¡œ ê°•ë“± ë˜ëŠ” ì¬ìƒ ì°¨ë‹¨</td>
                        <td>ë£¨íŒ…ëœ ê¸°ê¸°ì—ì„œ í…ŒìŠ¤íŠ¸</td>
                    </tr>
                    <tr>
                        <td>R6: Rollback ë°©ì§€</td>
                        <td>êµ¬ë²„ì „ ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ë‹¤ìš´ê·¸ë ˆì´ë“œ ë¶ˆê°€</td>
                        <td>íŒì›¨ì–´ ë¡¤ë°± ì‹œë„</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                10-3. ì¸ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âœ…</span>
                        ê¸°ìˆ  ìš”êµ¬ì‚¬í•­
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>â˜‘ï¸ ARM TrustZone ë˜ëŠ” ë™ë“± TEE</li>
                            <li>â˜‘ï¸ OEMCrypto 16+ API ë ˆë²¨</li>
                            <li>â˜‘ï¸ Secure Boot Chain</li>
                            <li>â˜‘ï¸ Hardware Root of Trust</li>
                            <li>â˜‘ï¸ HDCP 2.2+ ì§€ì›</li>
                            <li>â˜‘ï¸ Secure Video Path</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ§ª</span>
                        í…ŒìŠ¤íŠ¸ í†µê³¼ í•„ìˆ˜
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>â˜‘ï¸ CWTS ìë™í™” í…ŒìŠ¤íŠ¸ 100% í†µê³¼</li>
                            <li>â˜‘ï¸ OEMCrypto Test Vector ì „ì²´ í†µê³¼</li>
                            <li>â˜‘ï¸ CTS MediaDrmTest í†µê³¼</li>
                            <li>â˜‘ï¸ Widevine Robustness Test í†µê³¼</li>
                            <li>â˜‘ï¸ ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ (Penetration Test)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 11: CTS/GTS DRM í…ŒìŠ¤íŠ¸ -->
        <section class="description-section">
            <h2 style="color: var(--accent-primary); font-size: 1.8rem; margin-bottom: 20px; border-bottom: 2px solid var(--accent-primary); padding-bottom: 10px;">
                11. CTS/GTS DRM í…ŒìŠ¤íŠ¸
            </h2>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                11-1. CTS MediaDrmTest
            </h3>
            <p style="line-height: 1.8; color: var(--text-secondary); margin-bottom: 20px;">
                CTS (Compatibility Test Suite)ëŠ” Android í˜¸í™˜ì„±ì„ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¡œ, Widevine DRMë„ í¬í•¨ë©ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <pre class="mermaid">
graph LR
    A[CTS Test Runner] --> B[MediaDrmTest]
    A --> C[CryptoTest]
    A --> D[MediaCodecTest]

    B --> B1[testOpenSession]
    B --> B2[testGetKeyRequest]
    B --> B3[testProvideKeyResponse]
    B --> B4[testQueryKeyStatus]

    C --> C1[testDecrypt]
    C --> C2[testSetMediaDrmSession]

    D --> D1[testSecureDecoder]
    D --> D2[testClearKeyPlayback]

    style A fill:#1a1f35,stroke:#3b82f6,stroke-width:2px
    style B fill:#1a1f35,stroke:#10b981,stroke-width:2px
    style C fill:#1a1f35,stroke:#10b981,stroke-width:2px
    style D fill:#1a1f35,stroke:#10b981,stroke-width:2px
                </pre>
            </div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤</th>
                        <th>ì£¼ìš” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤</th>
                        <th>ê²€ì¦ ë‚´ìš©</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>MediaDrmTest</td>
                        <td>testOpenCloseSession</td>
                        <td>ì„¸ì…˜ ìƒì„±/ì¢…ë£Œ ì •ìƒ ë™ì‘</td>
                    </tr>
                    <tr>
                        <td>MediaDrmTest</td>
                        <td>testGetKeyRequest</td>
                        <td>ë¼ì´ì„ ìŠ¤ ìš”ì²­ ìƒì„± í¬ë§·</td>
                    </tr>
                    <tr>
                        <td>MediaDrmTest</td>
                        <td>testProvideKeyResponse</td>
                        <td>ë¼ì´ì„ ìŠ¤ ì‘ë‹µ ì²˜ë¦¬</td>
                    </tr>
                    <tr>
                        <td>MediaDrmTest</td>
                        <td>testQueryKeyStatus</td>
                        <td>í‚¤ ìƒíƒœ ì¡°íšŒ (ìœ íš¨ê¸°ê°„ ë“±)</td>
                    </tr>
                    <tr>
                        <td>CryptoTest</td>
                        <td>testDecryptClearVideo</td>
                        <td>Clear ì½˜í…ì¸  ë³µí˜¸í™” (ì •ìƒ í†µê³¼)</td>
                    </tr>
                    <tr>
                        <td>CryptoTest</td>
                        <td>testDecryptEncryptedVideo</td>
                        <td>ì•”í˜¸í™” ì½˜í…ì¸  ë³µí˜¸í™”</td>
                    </tr>
                    <tr>
                        <td>MediaCodecTest</td>
                        <td>testSecureDecoderPlayback</td>
                        <td>ë³´ì•ˆ ë””ì½”ë” ì¬ìƒ (L1)</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                11-2. Widevine ì „ìš© í…ŒìŠ¤íŠ¸
            </h3>
            <div class="code-block">
                <pre><code class="language-bash"># Widevine CTS í…ŒìŠ¤íŠ¸ ì‹¤í–‰
adb shell am instrument -w -e class \
  com.android.cts.media.MediaDrmTest#testWidevineL1Provisioning \
  android.media.cts/androidx.test.runner.AndroidJUnitRunner

# L1 ì¸ì¦ í™•ì¸
adb shell getprop drm.service.enabled
# ì¶œë ¥: true

adb shell getprop ro.vendor.widevine.level
# ì¶œë ¥: 1 (L1), 2 (L2), 3 (L3)</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                11-3. GTS DRM í…ŒìŠ¤íŠ¸
            </h3>
            <p style="line-height: 1.8; color: var(--text-secondary); margin-bottom: 20px;">
                GTS (Google Mobile Services Test Suite)ëŠ” Google ì„œë¹„ìŠ¤ í˜¸í™˜ì„±ì„ ê²€ì¦í•©ë‹ˆë‹¤.
            </p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>í…ŒìŠ¤íŠ¸ ì¹´í…Œê³ ë¦¬</th>
                        <th>í•„ìˆ˜ í†µê³¼ í•­ëª©</th>
                        <th>ì‹¤íŒ¨ ì‹œ ì˜í–¥</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>GtsMediaTestCases</td>
                        <td>Widevine L1 í”„ë¡œë¹„ì €ë‹</td>
                        <td>Netflix/YouTube Premium ì¬ìƒ ë¶ˆê°€</td>
                    </tr>
                    <tr>
                        <td>GtsWidevineDrmTestCases</td>
                        <td>HDCP 2.2+ ê°•ì œ ì ìš©</td>
                        <td>ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´ 4K ì¬ìƒ ë¶ˆê°€</td>
                    </tr>
                    <tr>
                        <td>GtsSecurityTestCases</td>
                        <td>Root ê°ì§€ ë° L3 ê°•ë“±</td>
                        <td>í”„ë¦¬ë¯¸ì—„ ì½˜í…ì¸  ì¬ìƒ ì°¨ë‹¨</td>
                    </tr>
                    <tr>
                        <td>GtsPlayReadyTestCases</td>
                        <td>PlayReady + Widevine ê³µì¡´</td>
                        <td>ì¼ë¶€ ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ í˜¸í™˜ì„± ë¬¸ì œ</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                11-4. í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ë¶„ì„
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âŒ</span>
                        testSecureDecoderPlayback ì‹¤íŒ¨
                    </h3>
                    <div class="card-description">
                        <strong>ì¦ìƒ:</strong> L1 ì½˜í…ì¸  ì¬ìƒ ì‹œ í™”ë©´ ê²€ì€ìƒ‰<br>
                        <strong>ì›ì¸:</strong> Secure Video Path ë¯¸êµ¬í˜„<br>
                        <strong>í•´ê²°:</strong> Gralloc HALì— GRALLOC_USAGE_PROTECTED ì§€ì› ì¶”ê°€
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âŒ</span>
                        testProvideKeyResponse ì‹¤íŒ¨
                    </h3>
                    <div class="card-description">
                        <strong>ì¦ìƒ:</strong> ë¼ì´ì„ ìŠ¤ ë¡œë“œ ì‹œ ERROR_LICENSE_PARSE<br>
                        <strong>ì›ì¸:</strong> OEMCrypto_LoadKeys ì‹œê·¸ë‹ˆì²˜ ê²€ì¦ ì‹¤íŒ¨<br>
                        <strong>í•´ê²°:</strong> Keybox provisioning ì¬ì‹¤í–‰
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 12: Persistent License (ì˜¤í”„ë¼ì¸ ì¬ìƒ) -->
        <section class="description-section">
            <h2 style="color: var(--accent-primary); font-size: 1.8rem; margin-bottom: 20px; border-bottom: 2px solid var(--accent-primary); padding-bottom: 10px;">
                12. Persistent License (ì˜¤í”„ë¼ì¸ ì¬ìƒ)
            </h2>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                12-1. Persistent Session ìƒì„±
            </h3>
            <p style="line-height: 1.8; color: var(--text-secondary); margin-bottom: 20px;">
                ì˜¤í”„ë¼ì¸ ì¬ìƒì„ ìœ„í•´ ë¼ì´ì„ ìŠ¤ë¥¼ ë””ë°”ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
            </p>

            <div class="code-block">
                <pre><code class="language-kotlin">// Persistent License ë‹¤ìš´ë¡œë“œ
val mediaDrm = MediaDrm(WIDEVINE_UUID)

// Offline ì„¸ì…˜ ìƒì„±
val sessionId = mediaDrm.openSession(MediaDrm.SESSION_TYPE_OFFLINE)

// ì˜¤í”„ë¼ì¸ í‚¤ ìš”ì²­
val request = mediaDrm.getKeyRequest(
    sessionId,
    initData,
    "video/mp4",
    MediaDrm.KEY_TYPE_OFFLINE,  // â† Offline íƒ€ì…
    null
)

// ë¼ì´ì„ ìŠ¤ ì„œë²„ì— ìš”ì²­
val response = httpClient.post(licenseUrl, request.data)

// ë¼ì´ì„ ìŠ¤ ì €ì¥
val keySetId = mediaDrm.provideKeyResponse(sessionId, response)

// keySetIdë¥¼ DBì— ì €ì¥ (ë‚˜ì¤‘ì— ì¬ì‚¬ìš©)
offlineDatabase.saveLicenseId(videoId, keySetId)</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                12-2. ì˜¤í”„ë¼ì¸ ë¼ì´ì„ ìŠ¤ ë¡œë“œ
            </h3>
            <div class="code-block">
                <pre><code class="language-kotlin">// ì €ì¥ëœ ë¼ì´ì„ ìŠ¤ë¡œ ì¬ìƒ
val keySetId = offlineDatabase.getLicenseId(videoId)

val mediaDrm = MediaDrm(WIDEVINE_UUID)
val sessionId = mediaDrm.openSession()

// ì €ì¥ëœ í‚¤ ë³µì›
mediaDrm.restoreKeys(sessionId, keySetId)

// MediaCodecì— ì„¸ì…˜ ì—°ê²°
mediaCrypto = MediaCrypto(WIDEVINE_UUID, sessionId)
mediaCodec.configure(format, surface, mediaCrypto, 0)

// ì˜¤í”„ë¼ì¸ ì¬ìƒ ì‹œì‘
mediaCodec.start()</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                12-3. ë¼ì´ì„ ìŠ¤ ê°±ì‹  (Renewal)
            </h3>
            <div class="mermaid-container">
                <pre class="mermaid">
sequenceDiagram
    participant App
    participant MediaDrm
    participant Server
    participant OEMCrypto

    Note over App,OEMCrypto: ë¼ì´ì„ ìŠ¤ ë§Œë£Œ ì„ë°• (24ì‹œê°„ ì „)

    App->>MediaDrm: getKeyRequest(sessionId, KEY_TYPE_RENEWAL)
    MediaDrm->>OEMCrypto: GenerateRenewalRequest()
    OEMCrypto-->>MediaDrm: Renewal Request
    MediaDrm-->>App: KeyRequest

    App->>Server: POST /renewal (Request)
    Server-->>App: Updated License

    App->>MediaDrm: provideKeyResponse(sessionId, response)
    MediaDrm->>OEMCrypto: LoadKeys(updated keys)
    OEMCrypto->>OEMCrypto: Update Usage Table
    OEMCrypto-->>MediaDrm: SUCCESS
    MediaDrm-->>App: keySetId (ê°±ì‹ ë¨)

    Note over App,OEMCrypto: ë¼ì´ì„ ìŠ¤ ìœ íš¨ê¸°ê°„ ì—°ì¥ë¨
                </pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                12-4. ì €ì¥ ê´€ë¦¬
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>API</th>
                        <th>ì„¤ëª…</th>
                        <th>ìš©ë„</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>queryKeyStatus(sessionId)</td>
                        <td>ë¼ì´ì„ ìŠ¤ ë§Œë£Œ ì‹œê°„, ë‚¨ì€ ì¬ìƒ íšŸìˆ˜ ì¡°íšŒ</td>
                        <td>ê°±ì‹  ì‹œì  íŒë‹¨</td>
                    </tr>
                    <tr>
                        <td>getOfflineLicenseKeySetIds()</td>
                        <td>ì €ì¥ëœ ëª¨ë“  ì˜¤í”„ë¼ì¸ ë¼ì´ì„ ìŠ¤ ëª©ë¡</td>
                        <td>ë§Œë£Œëœ ë¼ì´ì„ ìŠ¤ ì •ë¦¬</td>
                    </tr>
                    <tr>
                        <td>removeOfflineLicense(keySetId)</td>
                        <td>ì˜¤í”„ë¼ì¸ ë¼ì´ì„ ìŠ¤ ì‚­ì œ</td>
                        <td>ìŠ¤í† ë¦¬ì§€ í™•ë³´, ë§Œë£Œ ë¼ì´ì„ ìŠ¤ ì œê±°</td>
                    </tr>
                    <tr>
                        <td>getOfflineLicenseState(keySetId)</td>
                        <td>UNKNOWN / USABLE / INACTIVE</td>
                        <td>ë¼ì´ì„ ìŠ¤ ìœ íš¨ì„± í™•ì¸</td>
                    </tr>
                </tbody>
            </table>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ’¾</span>
                        ì €ì¥ ìœ„ì¹˜
                    </h3>
                    <div class="card-description">
                        <strong>ê²½ë¡œ:</strong> /data/vendor/mediadrm/[UUID]/<br>
                        <strong>íŒŒì¼:</strong> persistent_license_*.bin<br>
                        <strong>ì•”í˜¸í™”:</strong> OEMCryptoê°€ ìë™ ì•”í˜¸í™”<br>
                        <strong>ê¶Œí•œ:</strong> system UIDë§Œ ì ‘ê·¼ ê°€ëŠ¥
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš ï¸</span>
                        ì£¼ì˜ì‚¬í•­
                    </h3>
                    <div class="card-description">
                        <strong>ê¸°ê¸° ë³€ê²½:</strong> ë¼ì´ì„ ìŠ¤ëŠ” ë‹¤ë¥¸ ê¸°ê¸°ë¡œ ì´ë™ ë¶ˆê°€<br>
                        <strong>Factory Reset:</strong> ë¼ì´ì„ ìŠ¤ ì „ì²´ ì‚­ì œ<br>
                        <strong>ìµœëŒ€ ê°œìˆ˜:</strong> ë””ë°”ì´ìŠ¤ë‹¹ ë³´í†µ 100ê°œ ì œí•œ<br>
                        <strong>ì €ì¥ ê³µê°„:</strong> ë¼ì´ì„ ìŠ¤ë‹¹ ì•½ 1~10KB
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 13: HDCP (ì½˜í…ì¸  ë³´í˜¸) -->
        <section class="description-section">
            <h2 style="color: var(--accent-primary); font-size: 1.8rem; margin-bottom: 20px; border-bottom: 2px solid var(--accent-primary); padding-bottom: 10px;">
                13. HDCP (ì½˜í…ì¸  ë³´í˜¸)
            </h2>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                13-1. HDCP ê°œìš”
            </h3>
            <p style="line-height: 1.8; color: var(--text-secondary); margin-bottom: 20px;">
                HDCP (High-bandwidth Digital Content Protection)ëŠ” ë””ì§€í„¸ ì˜ìƒ ì‹ í˜¸ì˜ ë¶ˆë²• ë³µì œë¥¼ ë°©ì§€í•˜ëŠ” ì•”í˜¸í™” í”„ë¡œí† ì½œì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <pre class="mermaid">
graph LR
    A[MediaCodec<br/>Secure Decoder] --> B[Display HAL]
    B --> C{HDCP ê²€ì¦}
    C -->|HDCP 2.2+| D[ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´<br/>4K HDR ì¬ìƒ]
    C -->|HDCP 1.x| E[ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´<br/>1080p ì œí•œ]
    C -->|No HDCP| F[ì¬ìƒ ì°¨ë‹¨<br/>ERROR_HDCP_FAILURE]

    style A fill:#1a1f35,stroke:#3b82f6,stroke-width:2px
    style C fill:#1a1f35,stroke:#f59e0b,stroke-width:2px
    style D fill:#1a1f35,stroke:#10b981,stroke-width:2px
    style E fill:#1a1f35,stroke:#f59e0b,stroke-width:2px
    style F fill:#1a1f35,stroke:#ef4444,stroke-width:2px
                </pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                13-2. HDCP ë²„ì „ ë¹„êµ
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>HDCP ë²„ì „</th>
                        <th>ìµœëŒ€ í•´ìƒë„</th>
                        <th>ì¸í„°í˜ì´ìŠ¤</th>
                        <th>Widevine ìš”êµ¬ì‚¬í•­</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>HDCP 1.4</td>
                        <td>1080p (Full HD)</td>
                        <td>HDMI 1.4, DVI</td>
                        <td>L3 ì½˜í…ì¸ ë§Œ ì¬ìƒ ê°€ëŠ¥</td>
                    </tr>
                    <tr>
                        <td>HDCP 2.0</td>
                        <td>4K (3840x2160)</td>
                        <td>HDMI 2.0</td>
                        <td>L1 ì½˜í…ì¸  ì œí•œì  ì¬ìƒ</td>
                    </tr>
                    <tr>
                        <td>HDCP 2.2</td>
                        <td>4K HDR, 8K</td>
                        <td>HDMI 2.0+, DisplayPort 1.3+</td>
                        <td>L1 í”„ë¦¬ë¯¸ì—„ ì½˜í…ì¸  ì¬ìƒ (í•„ìˆ˜)</td>
                    </tr>
                    <tr>
                        <td>HDCP 2.3</td>
                        <td>8K, 10K</td>
                        <td>HDMI 2.1, DP 2.0</td>
                        <td>ë¯¸ë˜ 4K+ ì½˜í…ì¸  ëŒ€ë¹„</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                13-3. Android DisplayManager HDCP ì„¤ì •
            </h3>
            <div class="code-block">
                <pre><code class="language-kotlin">// HDCP ë ˆë²¨ í™•ì¸
val displayManager = getSystemService(Context.DISPLAY_SERVICE) as DisplayManager
val display = displayManager.getDisplay(Display.DEFAULT_DISPLAY)

val hdcpLevel = display.getHdrCapabilities()?.let {
    // HDCP 2.2+ ì§€ì› í™•ì¸
    when {
        it.supportedHdrTypes.contains(Display.HdrCapabilities.HDR_TYPE_DOLBY_VISION) -> "HDCP 2.2+"
        it.supportedHdrTypes.contains(Display.HdrCapabilities.HDR_TYPE_HDR10) -> "HDCP 2.2+"
        else -> "HDCP 1.x ë˜ëŠ” ë¯¸ì§€ì›"
    }
}

// ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´ ì—°ê²° ê°ì§€
displayManager.registerDisplayListener(object : DisplayManager.DisplayListener {
    override fun onDisplayAdded(displayId: Int) {
        val externalDisplay = displayManager.getDisplay(displayId)

        // HDCP ê²€ì¦
        if (!isHdcpCompliant(externalDisplay)) {
            // ì¬ìƒ ì¤‘ë‹¨ ë˜ëŠ” í•´ìƒë„ ë‹¤ìš´ê·¸ë ˆì´ë“œ
            player.stop()
            showError("HDCP 2.2 ë¯¸ì§€ì› ë””ìŠ¤í”Œë ˆì´ì…ë‹ˆë‹¤.")
        }
    }

    override fun onDisplayRemoved(displayId: Int) { }
    override fun onDisplayChanged(displayId: Int) { }
}, null)</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                13-4. Miracast/Casting ì œí•œ
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“±</span>
                        Miracast (Wi-Fi Display)
                    </h3>
                    <div class="card-description">
                        <strong>ë¬¸ì œ:</strong> MiracastëŠ” HDCP ì¸ì¦ ë¶ˆê°€<br>
                        <strong>ê²°ê³¼:</strong> L1 ì½˜í…ì¸  ì¬ìƒ ì°¨ë‹¨<br>
                        <strong>í•´ê²°:</strong> Chromecast ë“± HDCP ì¸ì¦ ê¸°ê¸° ì‚¬ìš©<br>
                        <strong>ê²€ì¦:</strong> MediaDrm.EVENT_SESSION_RECLAIMED ë°œìƒ
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ–¥ï¸</span>
                        Chromecast
                    </h3>
                    <div class="card-description">
                        <strong>ì§€ì›:</strong> Chromecast Ultra ì´ìƒ HDCP 2.2 ì§€ì›<br>
                        <strong>êµ¬í˜„:</strong> Cast SDKê°€ ìë™ìœ¼ë¡œ HDCP ê²€ì¦<br>
                        <strong>í´ë°±:</strong> HDCP ì‹¤íŒ¨ ì‹œ í•´ìƒë„ ìë™ ë‹¤ìš´ê·¸ë ˆì´ë“œ<br>
                        <strong>í™•ì¸:</strong> CastSession.isHdcpSupported()
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 14: Android ë²„ì „ë³„ ë³€í™” -->
        <section class="description-section">
            <h2 style="color: var(--accent-primary); font-size: 1.8rem; margin-bottom: 20px; border-bottom: 2px solid var(--accent-primary); padding-bottom: 10px;">
                14. Android ë²„ì „ë³„ ë³€í™”
            </h2>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                14-1. Android 8.0 Oreo
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ†•</span>
                        ì£¼ìš” ë³€ê²½ì‚¬í•­
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>DRM HAL 1.0 (HIDL) ë„ì…</li>
                            <li>MediaDrm API ë ˆë²¨ 27 ì¶”ê°€ ë©”ì„œë“œ</li>
                            <li>HDCP ë ˆë²¨ ì¿¼ë¦¬ API ì¶”ê°€</li>
                            <li>clearkey DRM ê¸°ë³¸ ì§€ì›</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                14-2. Android 10 (Q)
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        ë³´ì•ˆ ê°•í™”
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>Scoped Storageë¡œ ë¼ì´ì„ ìŠ¤ ì ‘ê·¼ ì œí•œ</li>
                            <li>MediaDrm ë©”íŠ¸ë¦­ API ì¶”ê°€</li>
                            <li>DRM HAL 1.3 (ì„¸ì…˜ ë¡œê·¸ ê°œì„ )</li>
                            <li>Root ê°ì§€ ê°•í™”</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                14-3. Android 12 (S)
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš¡</span>
                        ì„±ëŠ¥ ê°œì„ 
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>DRM HAL 1.4 (ë©€í‹° ì„¸ì…˜ ìµœì í™”)</li>
                            <li>MediaDrm AIDL ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œì‘</li>
                            <li>HDCP 2.3 ì§€ì› ì¶”ê°€</li>
                            <li>AV1 + Widevine ê³µì‹ ì§€ì›</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                14-4. Android 13 (T)
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš€</span>
                        AIDL ì „í™˜
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>DRM HAL AIDL (IDrmPlugin.aidl) í•„ìˆ˜</li>
                            <li>HIDL DRM HAL Deprecated</li>
                            <li>MediaDrm API 33 í™•ì¥ (ì˜¤í”„ë¼ì¸ ë§Œë£Œ ì‹œê°„)</li>
                            <li>Widevine L1 í•„ìˆ˜ ìš”êµ¬ì‚¬í•­ ê°•í™” (CDD)</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                14-5. Android 14 (U)
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¯</span>
                        ìµœì‹  ê¸°ëŠ¥
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>Ultra HDR + Widevine í†µí•©</li>
                            <li>MediaDrm ì—ëŸ¬ ì½”ë“œ ì„¸ë¶„í™”</li>
                            <li>DRM ì„¸ì…˜ ë©”ëª¨ë¦¬ ìµœì í™”</li>
                            <li>HDCP ê²€ì¦ ë¡œì§ ê°œì„ </li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                14-6. Android 15 (V)
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”®</span>
                        ì˜ˆì • ê¸°ëŠ¥
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>AI ê¸°ë°˜ DRM ê³µê²© ê°ì§€</li>
                            <li>Widevine L0 (ì°¨ì„¸ëŒ€ ë³´ì•ˆ ë ˆë²¨) ì¤€ë¹„</li>
                            <li>8K HDR Widevine ìµœì í™”</li>
                            <li>DRM ì„¸ì…˜ ë³µêµ¬ API</li>
                        </ul>
                    </div>
                </div>
            </div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Android ë²„ì „</th>
                        <th>API Level</th>
                        <th>DRM HAL</th>
                        <th>ì£¼ìš” ë³€ê²½ì‚¬í•­</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Android 8.0 (Oreo)</td>
                        <td>26-27</td>
                        <td>HIDL 1.0</td>
                        <td>HIDL DRM HAL ë„ì…</td>
                    </tr>
                    <tr>
                        <td>Android 10 (Q)</td>
                        <td>29</td>
                        <td>HIDL 1.3</td>
                        <td>Scoped Storage, ë©”íŠ¸ë¦­ API</td>
                    </tr>
                    <tr>
                        <td>Android 12 (S)</td>
                        <td>31-32</td>
                        <td>HIDL 1.4 / AIDL ë³‘í–‰</td>
                        <td>AIDL ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œì‘</td>
                    </tr>
                    <tr>
                        <td>Android 13 (T)</td>
                        <td>33</td>
                        <td>AIDL í•„ìˆ˜</td>
                        <td>HIDL Deprecated, AIDL ì „í™˜</td>
                    </tr>
                    <tr>
                        <td>Android 14 (U)</td>
                        <td>34</td>
                        <td>AIDL</td>
                        <td>Ultra HDR, ì—ëŸ¬ ì½”ë“œ ê°œì„ </td>
                    </tr>
                    <tr>
                        <td>Android 15 (V)</td>
                        <td>35</td>
                        <td>AIDL</td>
                        <td>AI ê³µê²© ê°ì§€, L0 ì¤€ë¹„</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Section 15: ë””ë²„ê¹… & íŠ¸ëŸ¬ë¸”ìŠˆíŒ… -->
        <section class="description-section">
            <h2 style="color: var(--accent-primary); font-size: 1.8rem; margin-bottom: 20px; border-bottom: 2px solid var(--accent-primary); padding-bottom: 10px;">
                15. ë””ë²„ê¹… & íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
            </h2>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                15-1. dumpsys media.drm
            </h3>
            <div class="code-block">
                <pre><code class="language-bash"># DRM ìƒíƒœ ë¤í”„
adb shell dumpsys media.drm

# ì¶œë ¥ ì˜ˆì‹œ:
# Widevine CDM version: 16.1.0
# Security Level: L1
# Active sessions: 2
# Session 0x12345678:
#   - State: OPENED
#   - Keys loaded: 3
#   - Expiration: 2024-12-31 23:59:59
# Session 0xabcdef00:
#   - State: CLOSED

# ì˜¤í”„ë¼ì¸ ë¼ì´ì„ ìŠ¤ ëª©ë¡
adb shell dumpsys media.drm --offline-licenses

# ì„¸ì…˜ ë¡œê·¸ í™•ì¸
adb shell dumpsys media.drm --sessions</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                15-2. logcat í•„í„°ë§
            </h3>
            <div class="code-block">
                <pre><code class="language-bash"># Widevine ê´€ë ¨ ë¡œê·¸ë§Œ í•„í„°
adb logcat | grep -E "Widevine|MediaDrm|Crypto|OEMCrypto"

# DRM HAL ë¡œê·¸
adb logcat | grep "android.hardware.drm"

# ì—ëŸ¬ë§Œ í‘œì‹œ
adb logcat *:E | grep Widevine

# ì£¼ìš” ë¡œê·¸ ì˜ˆì‹œ:
# E/MediaDrm: provideKeyResponse failed: ERROR_LICENSE_PARSE
# W/OEMCrypto: Signature verification failed
# I/Widevine: Security level changed: L1 -> L3 (root detected)</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                15-3. ì£¼ìš” ì—ëŸ¬ ì½”ë“œ í•´ê²°
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>ì—ëŸ¬ ì½”ë“œ</th>
                        <th>ì›ì¸</th>
                        <th>í•´ê²° ë°©ë²•</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ERROR_DRM_SESSION_NOT_OPENED</td>
                        <td>ì„¸ì…˜ ID ë¬´íš¨ ë˜ëŠ” ë§Œë£Œ</td>
                        <td>ìƒˆ ì„¸ì…˜ ìƒì„± (openSession)</td>
                    </tr>
                    <tr>
                        <td>ERROR_DRM_CANNOT_HANDLE</td>
                        <td>PSSH íŒŒì‹± ì‹¤íŒ¨</td>
                        <td>initData í¬ë§· í™•ì¸ (cenc/webm)</td>
                    </tr>
                    <tr>
                        <td>ERROR_DRM_LICENSE_EXPIRED</td>
                        <td>ë¼ì´ì„ ìŠ¤ ìœ íš¨ê¸°ê°„ ë§Œë£Œ</td>
                        <td>ë¼ì´ì„ ìŠ¤ ê°±ì‹  (KEY_TYPE_RENEWAL)</td>
                    </tr>
                    <tr>
                        <td>ERROR_DRM_RESOURCE_BUSY</td>
                        <td>ìµœëŒ€ ì„¸ì…˜ ê°œìˆ˜ ì´ˆê³¼</td>
                        <td>ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì„¸ì…˜ closeSession</td>
                    </tr>
                    <tr>
                        <td>ERROR_DRM_DEVICE_REVOKED</td>
                        <td>ë””ë°”ì´ìŠ¤ê°€ ë¸”ë™ë¦¬ìŠ¤íŠ¸ ë“±ë¡ë¨</td>
                        <td>ë³µêµ¬ ë¶ˆê°€ (íŒì›¨ì–´ ì¬ë°œê¸‰ í•„ìš”)</td>
                    </tr>
                    <tr>
                        <td>ERROR_HDCP_FAILURE</td>
                        <td>HDCP ê²€ì¦ ì‹¤íŒ¨</td>
                        <td>HDCP 2.2 ì§€ì› ì¼€ì´ë¸”/ë””ìŠ¤í”Œë ˆì´ ì‚¬ìš©</td>
                    </tr>
                    <tr>
                        <td>ERROR_DRM_DECRYPT</td>
                        <td>ë³µí˜¸í™” ì‹¤íŒ¨ (í‚¤ ë¶ˆì¼ì¹˜)</td>
                        <td>ì˜¬ë°”ë¥¸ í‚¤ë¡œ provideKeyResponse ì¬ì‹œë„</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                15-4. L1 â†’ L3 ê°•ë“± ë¶„ì„
            </h3>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        ê°•ë“± ì›ì¸ í™•ì¸
                    </h3>
                    <div class="card-description">
                        <strong>1ë‹¨ê³„:</strong> Security Level í™•ì¸<br>
                        <code>adb shell getprop ro.vendor.widevine.level</code><br><br>
                        <strong>2ë‹¨ê³„:</strong> ë¡œê·¸ ë¶„ì„<br>
                        <code>adb logcat | grep "Security level"</code><br><br>
                        <strong>3ë‹¨ê³„:</strong> Root ê°ì§€ ì—¬ë¶€<br>
                        <code>adb shell getprop ro.boot.verifiedbootstate</code>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ› ï¸</span>
                        ì¼ë°˜ì ì¸ ì›ì¸
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>âœ— ë””ë°”ì´ìŠ¤ ë£¨íŒ…ë¨</li>
                            <li>âœ— Bootloader Unlocked</li>
                            <li>âœ— TEE íŒì›¨ì–´ ì†ìƒ</li>
                            <li>âœ— OEMCrypto ë¼ì´ë¸ŒëŸ¬ë¦¬ ë³€ì¡°</li>
                            <li>âœ— HDCP ë¯¸ì§€ì› ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´ ì—°ê²°</li>
                            <li>âœ— SafetyNet Attestation ì‹¤íŒ¨</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                15-5. ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ë°©ë²•
            </h3>
            <div class="code-block">
                <pre><code class="language-bash"># 1. Widevine CDM ë²„ì „ í™•ì¸
adb shell dumpsys media.drm | grep "version"

# 2. í…ŒìŠ¤íŠ¸ ì•±ìœ¼ë¡œ ì¬ìƒ ì‹œë„
adb install WidevineSampleApp.apk
adb shell am start -n com.widevine.demo/.MainActivity

# 3. CTS Verifierë¡œ ìˆ˜ë™ ê²€ì¦
adb install CtsVerifier.apk
# ì•±ì—ì„œ "DRM Tests" â†’ "Widevine L1" ì„ íƒ

# 4. Chromeì—ì„œ Web EME í…ŒìŠ¤íŠ¸
adb shell am start -a android.intent.action.VIEW \
  -d "https://shaka-player-demo.appspot.com/demo/"

# 5. ë„¤íŠ¸ì›Œí¬ íŒ¨í‚· ìº¡ì²˜ (ë¼ì´ì„ ìŠ¤ ìš”ì²­/ì‘ë‹µ)
adb shell tcpdump -i any -s 0 -w /sdcard/drm.pcap port 443
# Wiresharkë¡œ ë¶„ì„</code></pre>
            </div>
        </section>

        <!-- Section 16: AOSP ì†ŒìŠ¤ ì½”ë“œ ì°¸ì¡° -->
        <section class="description-section">
            <h2 style="color: var(--accent-primary); font-size: 1.8rem; margin-bottom: 20px; border-bottom: 2px solid var(--accent-primary); padding-bottom: 10px;">
                16. AOSP ì†ŒìŠ¤ ì½”ë“œ ì°¸ì¡°
            </h2>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                16-1. MediaDrm Framework (Java)
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>íŒŒì¼ ê²½ë¡œ</th>
                        <th>ì„¤ëª…</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>frameworks/base/media/java/android/media/MediaDrm.java</td>
                        <td>MediaDrm API ì§„ì…ì  (openSession, getKeyRequest ë“±)</td>
                    </tr>
                    <tr>
                        <td>frameworks/base/media/java/android/media/MediaCrypto.java</td>
                        <td>MediaCodecê³¼ DRM ì„¸ì…˜ ì—°ê²°</td>
                    </tr>
                    <tr>
                        <td>frameworks/base/media/java/android/media/MediaDrmException.java</td>
                        <td>DRM ì˜ˆì™¸ ì •ì˜</td>
                    </tr>
                    <tr>
                        <td>frameworks/base/media/java/android/media/UnsupportedSchemeException.java</td>
                        <td>ì§€ì›í•˜ì§€ ì•ŠëŠ” DRM ìŠ¤í‚´ ì˜ˆì™¸</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                16-2. DRM HAL (Native)
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>íŒŒì¼ ê²½ë¡œ</th>
                        <th>ì„¤ëª…</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>frameworks/av/drm/libmediadrm/DrmHal.cpp</td>
                        <td>HIDL/AIDL DRM HAL í´ë¼ì´ì–¸íŠ¸</td>
                    </tr>
                    <tr>
                        <td>frameworks/av/drm/libmediadrm/CryptoHal.cpp</td>
                        <td>Crypto HAL í´ë¼ì´ì–¸íŠ¸</td>
                    </tr>
                    <tr>
                        <td>frameworks/av/drm/libmediadrm/DrmSessionManager.cpp</td>
                        <td>ì„¸ì…˜ ê´€ë¦¬ ë° ë¦¬ì†ŒìŠ¤ í• ë‹¹</td>
                    </tr>
                    <tr>
                        <td>hardware/interfaces/drm/aidl/android/hardware/drm/IDrmPlugin.aidl</td>
                        <td>DRM HAL AIDL ì¸í„°í˜ì´ìŠ¤ ì •ì˜</td>
                    </tr>
                    <tr>
                        <td>hardware/interfaces/drm/aidl/android/hardware/drm/ICryptoPlugin.aidl</td>
                        <td>Crypto HAL AIDL ì¸í„°í˜ì´ìŠ¤ ì •ì˜</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                16-3. Widevine í”ŒëŸ¬ê·¸ì¸ (Vendor)
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>íŒŒì¼ ê²½ë¡œ</th>
                        <th>ì„¤ëª…</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>vendor/widevine/libwvdrmengine/</td>
                        <td>Widevine DRM í”ŒëŸ¬ê·¸ì¸ êµ¬í˜„</td>
                    </tr>
                    <tr>
                        <td>vendor/widevine/oemcrypto/</td>
                        <td>OEMCrypto TEE í†µì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬</td>
                    </tr>
                    <tr>
                        <td>vendor/widevine/mediadrm/service.cpp</td>
                        <td>Widevine DRM HAL ì„œë¹„ìŠ¤ (AIDL)</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                16-4. OEMCrypto í—¤ë”
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>íŒŒì¼ ê²½ë¡œ</th>
                        <th>ì„¤ëª…</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>vendor/widevine/oemcrypto/include/OEMCryptoCENC.h</td>
                        <td>OEMCrypto API ì •ì˜ (CENC ë³µí˜¸í™”)</td>
                    </tr>
                    <tr>
                        <td>vendor/widevine/oemcrypto/include/OEMCryptoTypes.h</td>
                        <td>OEMCrypto ë°ì´í„° íƒ€ì… ì •ì˜</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                16-5. CTS í…ŒìŠ¤íŠ¸ ì½”ë“œ
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>íŒŒì¼ ê²½ë¡œ</th>
                        <th>ì„¤ëª…</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>cts/tests/tests/media/src/android/media/cts/MediaDrmTest.java</td>
                        <td>MediaDrm CTS í…ŒìŠ¤íŠ¸ (ì„¸ì…˜, í‚¤ ìš”ì²­ ë“±)</td>
                    </tr>
                    <tr>
                        <td>cts/tests/tests/media/src/android/media/cts/CryptoTest.java</td>
                        <td>MediaCrypto CTS í…ŒìŠ¤íŠ¸ (ë³µí˜¸í™”)</td>
                    </tr>
                    <tr>
                        <td>cts/tests/tests/media/src/android/media/cts/NativeDecoderTest.cpp</td>
                        <td>Native ë ˆë²¨ ë³´ì•ˆ ë””ì½”ë” í…ŒìŠ¤íŠ¸</td>
                    </tr>
                </tbody>
            </table>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“‚</span>
                        ì†ŒìŠ¤ ì½”ë“œ íƒìƒ‰ íŒ
                    </h3>
                    <div class="card-description">
                        <strong>1. Android Code Search ì‚¬ìš©:</strong><br>
                        <a href="https://cs.android.com/" style="color: var(--accent-primary);">cs.android.com</a>ì—ì„œ í‚¤ì›Œë“œ ê²€ìƒ‰<br><br>
                        <strong>2. ë¡œì»¬ AOSP ë‹¤ìš´ë¡œë“œ:</strong><br>
                        <code>repo init -u https://android.googlesource.com/platform/manifest -b main</code><br>
                        <code>repo sync</code><br><br>
                        <strong>3. ì£¼ìš” ê²€ìƒ‰ í‚¤ì›Œë“œ:</strong><br>
                        "MediaDrm", "OEMCrypto", "IDrmPlugin", "Widevine"
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 17: ê´€ë ¨ ìƒì„¸ ë¬¸ì„œ -->
        <section class="description-section">
            <h2 style="color: var(--accent-primary); font-size: 1.8rem; margin-bottom: 20px; border-bottom: 2px solid var(--accent-primary); padding-bottom: 10px;">
                17. ê´€ë ¨ ìƒì„¸ ë¬¸ì„œ
            </h2>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“„</span>
                        Media Framework Core
                    </h3>
                    <div class="card-description">
                        Android ë¯¸ë””ì–´ í”„ë ˆì„ì›Œí¬ì˜ ì „ì²´ ì•„í‚¤í…ì²˜ (Frameworkâ†”Native ìƒí˜¸ì‘ìš©, Binder IPC, MediaServer êµ¬ì¡°)ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.
                    </div>
                    <a href="media-framework-core.html" style="color: var(--accent-primary); text-decoration: none;">
                        ìì„¸íˆ ë³´ê¸° â†’
                    </a>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¬</span>
                        Codec 2.0 & Media HAL
                    </h3>
                    <div class="card-description">
                        Codec 2.0 ì•„í‚¤í…ì²˜, HAL ì¸í„°í˜ì´ìŠ¤, ê·¸ë¦¬ê³  Widevineê³¼ì˜ í†µí•© ë°©ì‹ì„ ë‹¤ë£¹ë‹ˆë‹¤.
                    </div>
                    <a href="codec2.html" style="color: var(--accent-primary); text-decoration: none;">
                        ìì„¸íˆ ë³´ê¸° â†’
                    </a>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">â–¶ï¸</span>
                        Media Playback Pipeline
                    </h3>
                    <div class="card-description">
                        ë¯¸ë””ì–´ ì¬ìƒ íŒŒì´í”„ë¼ì¸ì˜ ë°ì´í„° í”Œë¡œìš° (Extractorâ†’Codecâ†’Renderer)ì™€ DRM í†µí•© ì§€ì ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
                    </div>
                    <a href="media-playback.html" style="color: var(--accent-primary); text-decoration: none;">
                        ìì„¸íˆ ë³´ê¸° â†’
                    </a>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ§ª</span>
                        CTS/GTS Testing
                    </h3>
                    <div class="card-description">
                        CTS/VTS/GTS í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì™€ Widevine DRM ì¸ì¦ í…ŒìŠ¤íŠ¸ë¥¼ ìƒì„¸íˆ ë‹¤ë£¹ë‹ˆë‹¤.
                    </div>
                    <a href="cts.html" style="color: var(--accent-primary); text-decoration: none;">
                        ìì„¸íˆ ë³´ê¸° â†’
                    </a>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“‹</span>
                        CDD (í˜¸í™˜ì„± ì •ì˜ ë¬¸ì„œ)
                    </h3>
                    <div class="card-description">
                        Android CDDì˜ ë¯¸ë””ì–´ DRM ìš”êµ¬ì‚¬í•­ (ì„¹ì…˜ 5.1, 5.9) ë° Widevine L1 ì¸ì¦ ì¡°ê±´ì„ ì •ë¦¬í•©ë‹ˆë‹¤.
                    </div>
                    <a href="cdd.html" style="color: var(--accent-primary); text-decoration: none;">
                        ìì„¸íˆ ë³´ê¸° â†’
                    </a>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸµ</span>
                        Dolby DRM Integration
                    </h3>
                    <div class="card-description">
                        Dolby Atmos/AC-4ì™€ Widevineì˜ í†µí•© êµ¬í˜„ (DRM + Premium Audio ë™ì‹œ ì²˜ë¦¬)ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
                    </div>
                    <a href="dolby-codecs.html" style="color: var(--accent-primary); text-decoration: none;">
                        ìì„¸íˆ ë³´ê¸° â†’
                    </a>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.3rem; margin-top: 40px; margin-bottom: 15px;">
                ì™¸ë¶€ ì°¸ì¡° ë¬¸ì„œ
            </h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>ë¬¸ì„œ</th>
                        <th>ë§í¬</th>
                        <th>ì„¤ëª…</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>AOSP Media DRM</td>
                        <td><a href="https://source.android.com/docs/core/media/drm" style="color: var(--accent-primary);">source.android.com/media/drm</a></td>
                        <td>ê³µì‹ AOSP DRM ê°€ì´ë“œ</td>
                    </tr>
                    <tr>
                        <td>Widevine ê³µì‹ ë¬¸ì„œ</td>
                        <td><a href="https://www.widevine.com/solutions/widevine-drm" style="color: var(--accent-primary);">widevine.com</a></td>
                        <td>Widevine DRM ì†”ë£¨ì…˜ ê°œìš”</td>
                    </tr>
                    <tr>
                        <td>W3C EME í‘œì¤€</td>
                        <td><a href="https://www.w3.org/TR/encrypted-media/" style="color: var(--accent-primary);">w3.org/TR/encrypted-media</a></td>
                        <td>Web Encrypted Media Extensions</td>
                    </tr>
                    <tr>
                        <td>HDCP ìŠ¤í™</td>
                        <td><a href="https://www.digital-cp.com/hdcp-specifications" style="color: var(--accent-primary);">digital-cp.com</a></td>
                        <td>HDCP 2.2/2.3 ê¸°ìˆ  ëª…ì„¸</td>
                    </tr>
                    <tr>
                        <td>Android CDD</td>
                        <td><a href="https://source.android.com/compatibility/cdd" style="color: var(--accent-primary);">source.android.com/compatibility/cdd</a></td>
                        <td>í˜¸í™˜ì„± ì •ì˜ ë¬¸ì„œ (DRM ìš”êµ¬ì‚¬í•­)</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Footer -->
        <footer
            style="text-align: center; padding: 40px 20px; color: var(--text-muted); border-top: 1px solid var(--border-color); margin-top: 60px;">
            <p>Widevine DRM Architecture Visualization</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                Google Widevine Digital Rights Management Â· L1/L2/L3 Security Levels
            </p>
            <p style="margin-top: 20px;">
                <a href="index.html" style="color: var(--accent-primary); text-decoration: none;">
                    â† AOSP Media Frameworkë¡œ ëŒì•„ê°€ê¸°
                </a>
            </p>
        </footer>
    </div>

    <script src="../scripts/mermaid-theme.js"></script>
    <script>
        // Add scroll animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(30px)';
            section.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
            observer.observe(section);
        });
    </script>
    <!-- Navigation & Copy Features -->
    <script src="../scripts/copy-code.js"></script>
    <script src="../scripts/toc-generator.js"></script>
    <script src="../scripts/page-navigation.js"></script>
    <!-- Interactive Diagram Features -->
    <script src="../scripts/diagram-data.js"></script>
    <script src="../scripts/diagram-data-en-partial.js"></script>
    <script src="../scripts/diagram-interactive.js"></script>

    <script src="../scripts/theme-toggle.js"></script>
    <script src="../scripts/lang-switch.js"></script>
</body>

</html>