<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Common Media Issues</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700;900&family=IBM+Plex+Mono:wght@400;500;600&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/design-system.css">

        <style>
        /* Page-specific styles loaded from design-system.css */
    </style>
</head>

<body>
    <nav class="nav">
        <a href="index.html" class="nav-button">
            â† Android Media Framework
        </a>
    </nav>
    <div class="container">
        <header>
            <h1 class="page-title">ğŸ†˜ Common Media Issues & Solutions</h1>
            <p class="page-subtitle">Android ë¯¸ë””ì–´ í”„ë ˆì„ì›Œí¬ ì‹¤ë¬´ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ</p>
        </header>

        

        <!-- Section 1: Playback Issues -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">1</span>
                ì¬ìƒ ë¬¸ì œ (Playback Issues)
            </h2>
            <p class="section-description">
                ë¯¸ë””ì–´ ì¬ìƒ ì¤‘ ë°œìƒí•˜ëŠ” ì¼ë°˜ì ì¸ ë¬¸ì œì™€ í•´ê²° ë°©ë²•ì…ë‹ˆë‹¤.
            </p>

            <!-- Issue 1.1: ë¹„ë””ì˜¤ ë²„í¼ë§ -->
            <div id="issue-buffering" class="issue-card severity-high">
                <h3 class="issue-title">ğŸ”´ Issue 1.1: ë¹„ë””ì˜¤ê°€ ê³„ì† ë²„í¼ë§ë¨</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ (Symptoms)</span>
                    <ul>
                        <li>ì¬ìƒ ì¤‘ ë¡œë”© ì¸ë””ì¼€ì´í„°ê°€ ìì£¼ ë‚˜íƒ€ë‚¨</li>
                        <li>BUFFERING_UPDATE ì´ë²¤íŠ¸ê°€ ë°˜ë³µë¨</li>
                        <li>í”„ë ˆì„ ë“œë¡­ ë°œìƒ</li>
                        <li>ì‚¬ìš©ì ê²½í—˜ ì €í•˜</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸ (Root Cause)</span>
                    <ul>
                        <li><strong>ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ ë¶€ì¡±</strong>: ë¹„íŠ¸ë ˆì´íŠ¸ > ë„¤íŠ¸ì›Œí¬ ì†ë„</li>
                        <li><strong>ë²„í¼ í¬ê¸° ë¶€ì¡±</strong>: DefaultLoadControl ê¸°ë³¸ê°’ì´ ì‘ìŒ</li>
                        <li><strong>ì„œë²„ ì‘ë‹µ ì§€ì—°</strong>: CDN ë¬¸ì œ ë˜ëŠ” ì„œë²„ ê³¼ë¶€í•˜</li>
                        <li><strong>ë””ì½”ë” ì„±ëŠ¥ ë¶€ì¡±</strong>: 4K ì˜ìƒì„ ì €ì‚¬ì–‘ ë””ë°”ì´ìŠ¤ì—ì„œ ì¬ìƒ</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²• (Solution)</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">ExoPlayer ë²„í¼ í¬ê¸° ì¦ê°€</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// ë²„í¼ í¬ê¸° ì¡°ì • (ê¸°ë³¸ê°’ë³´ë‹¤ í¬ê²Œ)
val loadControl = DefaultLoadControl.Builder()
    .setBufferDurationsMs(
        50000,  // minBufferMs (ê¸°ë³¸ 15000ms)
        120000, // maxBufferMs (ê¸°ë³¸ 50000ms)
        2500,   // bufferForPlaybackMs (ê¸°ë³¸ 1500ms)
        5000    // bufferForPlaybackAfterRebufferMs (ê¸°ë³¸ 5000ms)
    )
    .setPrioritizeTimeOverSizeThresholds(true)
    .build()

val player = ExoPlayer.Builder(context)
    .setLoadControl(loadControl)
    .build()

// Adaptive Bitrate Streaming (ABR) ì‚¬ìš©
val trackSelector = DefaultTrackSelector(context).apply {
    parameters = buildUponParameters()
        .setMaxVideoSizeSd() // Wi-Fi ì•„ë‹ˆë©´ SDë¡œ ì œí•œ
        .build()
}

val playerAdaptive = ExoPlayer.Builder(context)
    .setTrackSelector(trackSelector)
    .build()</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦ ë°©ë²• (Verification)</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># ë²„í¼ ìƒíƒœ ëª¨ë‹ˆí„°ë§
adb logcat | grep -E "ExoPlayer|buffer"

# ë„¤íŠ¸ì›Œí¬ ì†ë„ í™•ì¸
adb shell dumpsys netstats

# í”„ë ˆì„ ë“œë¡­ í™•ì¸
adb shell dumpsys media.player | grep -i "frames dropped"</code></pre>
                </div>
            </div>

            <!-- Issue 1.2: A/V Sync ë¬¸ì œ -->
            <div id="issue-av-sync" class="issue-card severity-critical">
                <h3 class="issue-title">ğŸ”´ Issue 1.2: ì˜¤ë””ì˜¤-ë¹„ë””ì˜¤ ì‹±í¬ ì–´ê¸‹ë‚¨ (Lip Sync)</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>ì…ëª¨ì–‘ê³¼ ì†Œë¦¬ê°€ ë§ì§€ ì•ŠìŒ</li>
                        <li>ì˜¤ë””ì˜¤ê°€ ë¹„ë””ì˜¤ë³´ë‹¤ ë¹ ë¥´ê±°ë‚˜ ëŠë¦¼</li>
                        <li>ì¬ìƒ ì‹œê°„ì´ ê¸¸ì–´ì§ˆìˆ˜ë¡ ì‹±í¬ ì°¨ì´ ì¦ê°€</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>íƒ€ì„ìŠ¤íƒ¬í”„ ë¶ˆì¼ì¹˜</strong>: PTS (Presentation Timestamp) ì²˜ë¦¬ ì˜¤ë¥˜</li>
                        <li><strong>ì˜¤ë””ì˜¤ ë ˆì´í„´ì‹œ</strong>: AudioTrack ë²„í¼ë§ ì§€ì—°</li>
                        <li><strong>ì½”ë± ì²˜ë¦¬ ì†ë„ ì°¨ì´</strong>: ë¹„ë””ì˜¤ ë””ì½”ë”©ì´ ëŠë¦¼</li>
                        <li><strong>ë¯¸ë””ì–´ íŒŒì¼ ë¬¸ì œ</strong>: ì¸ì½”ë”© ì‹œ íƒ€ì„ìŠ¤íƒ¬í”„ ì˜¤ë¥˜</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">MediaCodec íƒ€ì„ìŠ¤íƒ¬í”„ ë™ê¸°í™”</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// MediaCodecì—ì„œ ì˜¬ë°”ë¥¸ PTS ì‚¬ìš©
val bufferInfo = MediaCodec.BufferInfo()
val outputBufferId = videoCodec.dequeueOutputBuffer(bufferInfo, TIMEOUT_US)

if (outputBufferId >= 0) {
    // PTS ê¸°ë°˜ ë Œë”ë§ ì‹œì  ê³„ì‚°
    val presentationTimeUs = bufferInfo.presentationTimeUs

    // ì •í™•í•œ íƒ€ì´ë°ì— ë Œë”ë§
    videoCodec.releaseOutputBuffer(
        outputBufferId,
        true // render to surface
    )
}

// ExoPlayerì—ì„œ A/V sync íŠœë‹
class CustomRenderersFactory(context: Context) : DefaultRenderersFactory(context) {
    override fun buildVideoRenderers(/* ... */): ArrayList<Renderer> {
        val videoRenderer = MediaCodecVideoRenderer(
            context,
            mediaCodecSelector,
            allowedVideoJoiningTimeMs = 0, // ì¦‰ì‹œ ì¡°ì¸
            enableDecoderFallback = true
        )
        // ...
    }
}

// ì˜¤ë””ì˜¤ ë ˆì´í„´ì‹œ ë³´ì •
val audioAttributes = AudioAttributes.Builder()
    .setUsage(AudioAttributes.USAGE_MEDIA)
    .setContentType(AudioAttributes.CONTENT_TYPE_MOVIE)
    .setFlags(AudioAttributes.FLAG_LOW_LATENCY) // ì €ì§€ì—° ëª¨ë“œ
    .build()</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># íƒ€ì„ìŠ¤íƒ¬í”„ ì°¨ì´ í™•ì¸
adb logcat | grep -E "presentationTimeUs|PTS"

# ì˜¤ë””ì˜¤ ë ˆì´í„´ì‹œ ì¸¡ì •
adb shell dumpsys media.audio_flinger | grep -i latency

# ì‹±í¬ ì°¨ì´ í—ˆìš© ë²”ìœ„ í™•ì¸ (ì¼ë°˜ì ìœ¼ë¡œ Â±40ms ì´ë‚´)</code></pre>
                </div>
            </div>

            <!-- Issue 1.3: Seek ëŠë¦¼ -->
            <div id="issue-seek-slow" class="issue-card severity-medium">
                <h3 class="issue-title">ğŸŸ¡ Issue 1.3: Seek ë™ì‘ì´ ëŠë¦¼</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>seekTo() í˜¸ì¶œ í›„ ì‹¤ì œ ì´ë™ê¹Œì§€ 3ì´ˆ ì´ìƒ ì†Œìš”</li>
                        <li>í”„ë¡œê·¸ë ˆìŠ¤ ë°” ë“œë˜ê·¸ê°€ ë¶€ìì—°ìŠ¤ëŸ¬ì›€</li>
                        <li>ì‚¬ìš©ì ë¶ˆí¸ í˜¸ì†Œ</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>Keyframe ê°„ê²©ì´ ë„“ìŒ</strong>: I-frameì´ 10ì´ˆë§ˆë‹¤ 1ê°œ</li>
                        <li><strong>ë¯¸ë””ì–´ ì»¨í…Œì´ë„ˆ ìµœì í™” ì•ˆë¨</strong>: moov atomì´ íŒŒì¼ ëì— ìœ„ì¹˜ (MP4)</li>
                        <li><strong>ë„¤íŠ¸ì›Œí¬ ìŠ¤íŠ¸ë¦¬ë°</strong>: ì›ê²© íŒŒì¼ì—ì„œ Seek ì‹œ ë‹¤ì‹œ ë‹¤ìš´ë¡œë“œ</li>
                        <li><strong>ì¸ë±ìŠ¤ í…Œì´ë¸” ë¶€ì¬</strong>: MediaExtractorê°€ ìˆœì°¨ íƒìƒ‰</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">Fast Seek í™œì„±í™” ë° íŒŒì¼ ìµœì í™”</span>
                            <span class="code-lang">Bash</span>
                        </div>
                        <pre><code># MP4 íŒŒì¼ ìµœì í™” (moov atomì„ íŒŒì¼ ì•ìœ¼ë¡œ)
ffmpeg -i input.mp4 -c copy -movflags +faststart output.mp4

# Keyframe ê°„ê²© ì¡°ì • (ì¸ì½”ë”© ì‹œ)
ffmpeg -i input.mp4 -c:v libx264 -g 30 -keyint_min 30 output.mp4
# -g 30: GOP(Group of Pictures) í¬ê¸° = 30 (30fps ê¸°ì¤€ 1ì´ˆë§ˆë‹¤ I-frame)</code></pre>
                    </div>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">ExoPlayer Seek ìµœì í™”</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// ExoPlayerì—ì„œ ì •í™•í•œ Seek (ëŠë¦¼) vs ë¹ ë¥¸ Seek
player.setSeekParameters(SeekParameters.CLOSEST_SYNC) // ê°€ì¥ ê°€ê¹Œìš´ Keyframe (ë¹ ë¦„)
// ë˜ëŠ”
player.setSeekParameters(SeekParameters.EXACT) // ì •í™•í•œ ìœ„ì¹˜ (ëŠë¦¼)

// ë¯¸ë¦¬ë³´ê¸° Seek (Scrubbing)
player.setPlayWhenReady(false) // ì¼ì‹œì •ì§€ ìƒíƒœì—ì„œ
player.seekTo(targetPositionMs)
// ë“œë˜ê·¸ ì™„ë£Œ í›„
player.setPlayWhenReady(true)</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># Keyframe ê°„ê²© í™•ì¸
ffprobe -select_streams v:0 -show_frames -show_entries frame=pict_type input.mp4 | grep -E "pict_type=I"

# Seek ì‹œê°„ ì¸¡ì •
adb logcat | grep -E "seekTo|onSeekComplete"</code></pre>
                </div>
            </div>

            <!-- Issue 1.4: ì¬ìƒ ì‹œì‘ ëŠë¦¼ -->
            <div id="issue-cold-start" class="issue-card severity-medium">
                <h3 class="issue-title">ğŸŸ¡ Issue 1.4: ì¬ìƒ ì‹œì‘ì´ ëŠë¦¼ (Cold Start)</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>play() í˜¸ì¶œ í›„ ì²« í”„ë ˆì„ê¹Œì§€ 3ì´ˆ ì´ìƒ ê±¸ë¦¼</li>
                        <li>ë¡œë”© í™”ë©´ì´ ì˜¤ë˜ í‘œì‹œë¨</li>
                        <li>ì‚¬ìš©ì ì´íƒˆìœ¨ ì¦ê°€</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>ì´ˆê¸° ë²„í¼ë§</strong>: bufferForPlaybackMsë§Œí¼ ëŒ€ê¸°</li>
                        <li><strong>ì½”ë± ì´ˆê¸°í™” ì§€ì—°</strong>: MediaCodec.configure() ì‹œê°„ ì†Œìš”</li>
                        <li><strong>DRM ë¼ì´ì„ ìŠ¤ íšë“</strong>: Widevine ë¼ì´ì„ ìŠ¤ ì„œë²„ í†µì‹ </li>
                        <li><strong>ë„¤íŠ¸ì›Œí¬ ì§€ì—°</strong>: DNS ì¡°íšŒ, TCP í•¸ë“œì…°ì´í¬</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">ë¹ ë¥¸ ì‹œì‘ ìµœì í™”</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// ì´ˆê¸° ë²„í¼ë§ ì‹œê°„ ìµœì†Œí™”
val loadControl = DefaultLoadControl.Builder()
    .setBufferDurationsMs(
        15000,  // minBufferMs
        50000,  // maxBufferMs
        1000,   // bufferForPlaybackMs (ê¸°ë³¸ 1500ms â†’ 1000msë¡œ ê°ì†Œ)
        2500    // bufferForPlaybackAfterRebufferMs
    )
    .build()

// DRM ë¼ì´ì„ ìŠ¤ í”„ë¦¬í˜ì¹˜
val drmSessionManager = DefaultDrmSessionManager.Builder()
    .setUuidAndExoMediaDrmProvider(C.WIDEVINE_UUID, FrameworkMediaDrm.DEFAULT_PROVIDER)
    .build(drmCallback)

// ë¯¸ë¦¬ prepare í˜¸ì¶œ (ë°±ê·¸ë¼ìš´ë“œì—ì„œ)
lifecycleScope.launch(Dispatchers.IO) {
    player.prepare() // UI í‘œì‹œ ì „ì— ì¤€ë¹„
}

// DNS í”„ë¦¬í˜ì¹˜ (OkHttp)
val client = OkHttpClient.Builder()
    .dns(object : Dns {
        override fun lookup(hostname: String): List<InetAddress> {
            // ìºì‹±ëœ DNS ì‚¬ìš©
            return Dns.SYSTEM.lookup(hostname)
        }
    })
    .build()</code></pre>
                </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># Time to First Frame (TTFF) ì¸¡ì •
adb logcat | grep -E "playWhenReady|onRenderedFirstFrame"

# ê° ë‹¨ê³„ë³„ ì‹œê°„ ì¸¡ì •
# 1. prepare() â†’ onPrepared
# 2. play() â†’ onRenderedFirstFrame
# 3. ì „ì²´ TTFF = onRenderedFirstFrame ì‹œê°„ - play() ì‹œê°„</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 2: Codec Issues -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">2</span>
                ì¸ì½”ë”©/ë””ì½”ë”© ë¬¸ì œ (Codec Issues)
            </h2>
            <p class="section-description">
                MediaCodec ê´€ë ¨ ì¼ë°˜ì ì¸ ë¬¸ì œì™€ í•´ê²° ë°©ë²•ì…ë‹ˆë‹¤.
            </p>

            <!-- Issue 2.1: ì½”ë± ì´ˆê¸°í™” ì‹¤íŒ¨ -->
            <div id="issue-codec-configure" class="issue-card severity-critical">
                <h3 class="issue-title">ğŸ”´ Issue 2.1: MediaCodec.configure() ì‹¤íŒ¨</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li><code>IllegalStateException</code> ë°œìƒ</li>
                        <li><code>CodecException</code> ë°œìƒ</li>
                        <li>"codec not found" ì—ëŸ¬ ë©”ì‹œì§€</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>ì§€ì›í•˜ì§€ ì•ŠëŠ” í•´ìƒë„</strong>: 4Kë¥¼ 720p ì „ìš© ì½”ë±ì— ìš”ì²­</li>
                        <li><strong>ì˜ëª»ëœ ìƒ‰ìƒ í¬ë§·</strong>: YUV420Planar vs Semi-Planar ë¶ˆì¼ì¹˜</li>
                        <li><strong>ë¹„íŠ¸ë ˆì´íŠ¸ ë²”ìœ„ ì´ˆê³¼</strong>: ì½”ë± capabilities ë²”ìœ„ ë°–</li>
                        <li><strong>MediaFormat íŒŒë¼ë¯¸í„° ëˆ„ë½</strong>: width, height, mime type ë¯¸ì„¤ì •</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">Capabilities í™•ì¸ ë° ì•ˆì „í•œ ì„¤ì •</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// 1. ì½”ë± capabilities í™•ì¸
fun checkCodecSupport(mimeType: String, width: Int, height: Int): Boolean {
    val codecList = MediaCodecList(MediaCodecList.REGULAR_CODECS)
    val codecInfo = codecList.findDecoderForFormat(
        MediaFormat.createVideoFormat(mimeType, width, height)
    ) ?: return false

    val caps = codecInfo.getCapabilitiesForType(mimeType)
    val videoCaps = caps.videoCapabilities

    return videoCaps.isSizeSupported(width, height)
}

// 2. ì•ˆì „í•œ MediaCodec ì´ˆê¸°í™”
try {
    val codec = MediaCodec.createDecoderByType("video/avc")

    val format = MediaFormat.createVideoFormat("video/avc", 1920, 1080).apply {
        setInteger(MediaFormat.KEY_COLOR_FORMAT,
            MediaCodecInfo.CodecCapabilities.COLOR_FormatYUV420Flexible)
        setInteger(MediaFormat.KEY_MAX_INPUT_SIZE, 1024 * 1024) // 1MB
        setInteger(MediaFormat.KEY_FRAME_RATE, 30)
    }

    codec.configure(format, surface, null, 0)
    codec.start()

} catch (e: IllegalStateException) {
    Log.e(TAG, "Codec configuration failed", e)
    // Fallback to software codec
    val softwareCodec = MediaCodec.createByCodecName("OMX.google.h264.decoder")
}

// 3. ì§€ì› ê°€ëŠ¥í•œ ìƒ‰ìƒ í¬ë§· ì°¾ê¸°
fun getSupportedColorFormat(codecInfo: MediaCodecInfo, mimeType: String): Int {
    val caps = codecInfo.getCapabilitiesForType(mimeType)
    for (colorFormat in caps.colorFormats) {
        when (colorFormat) {
            MediaCodecInfo.CodecCapabilities.COLOR_FormatYUV420Flexible,
            MediaCodecInfo.CodecCapabilities.COLOR_FormatYUV420Planar,
            MediaCodecInfo.CodecCapabilities.COLOR_FormatYUV420SemiPlanar -> {
                return colorFormat
            }
        }
    }
    return -1
}</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë± ëª©ë¡ í™•ì¸
adb shell dumpsys media.codec

# íŠ¹ì • MIME íƒ€ì… ì§€ì› ì—¬ë¶€
adb shell "dumpsys media.codec | grep -A 20 'video/avc'"

# ì§€ì› í•´ìƒë„ ë²”ìœ„
adb shell "dumpsys media.codec | grep -E 'size|resolution'"</code></pre>
                </div>
            </div>

            <!-- Issue 2.2: dequeueOutputBuffer íƒ€ì„ì•„ì›ƒ -->
            <div id="issue-dequeue-timeout" class="issue-card severity-high">
                <h3 class="issue-title">ğŸ”´ Issue 2.2: dequeueOutputBuffer() ê³„ì† íƒ€ì„ì•„ì›ƒ</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li><code>dequeueOutputBuffer()</code>ê°€ -1(INFO_TRY_AGAIN_LATER) ë°˜í™˜</li>
                        <li>ì¶œë ¥ ë²„í¼ë¥¼ ë°›ì„ ìˆ˜ ì—†ìŒ</li>
                        <li>í™”ë©´ì´ ë©ˆì¶¤</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>ì…ë ¥ ë°ì´í„° ì—†ìŒ</strong>: queueInputBufferë¥¼ í˜¸ì¶œí•˜ì§€ ì•ŠìŒ</li>
                        <li><strong>EOS ì‹ í˜¸ ëˆ„ë½</strong>: ë§ˆì§€ë§‰ í”„ë ˆì„ì— BUFFER_FLAG_END_OF_STREAM ë¯¸ì„¤ì •</li>
                        <li><strong>ì½”ë± ë‚´ë¶€ ì—ëŸ¬</strong>: ì˜ëª»ëœ ë°ì´í„°ë¡œ ë””ì½”ë” ì¶©ëŒ</li>
                        <li><strong>ì¶œë ¥ ë²„í¼ ë¯¸ë°˜í™˜</strong>: releaseOutputBufferë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì•„ ë²„í¼ ê³ ê°ˆ</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">ì˜¬ë°”ë¥¸ MediaCodec íë¦„</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>val codec = MediaCodec.createDecoderByType("video/avc")
codec.configure(format, surface, null, 0)
codec.start()

var inputDone = false
var outputDone = false

while (!outputDone) {
    // 1. ì…ë ¥ ë²„í¼ ì²˜ë¦¬
    if (!inputDone) {
        val inputBufferId = codec.dequeueInputBuffer(TIMEOUT_US)
        if (inputBufferId >= 0) {
            val inputBuffer = codec.getInputBuffer(inputBufferId)!!

            val sampleSize = extractor.readSampleData(inputBuffer, 0)
            if (sampleSize < 0) {
                // EOS ì‹ í˜¸
                codec.queueInputBuffer(inputBufferId, 0, 0, 0,
                    MediaCodec.BUFFER_FLAG_END_OF_STREAM)
                inputDone = true
            } else {
                val presentationTimeUs = extractor.sampleTime
                codec.queueInputBuffer(inputBufferId, 0, sampleSize,
                    presentationTimeUs, 0)
                extractor.advance()
            }
        }
    }

    // 2. ì¶œë ¥ ë²„í¼ ì²˜ë¦¬
    val bufferInfo = MediaCodec.BufferInfo()
    val outputBufferId = codec.dequeueOutputBuffer(bufferInfo, TIMEOUT_US)

    when (outputBufferId) {
        MediaCodec.INFO_TRY_AGAIN_LATER -> {
            // íƒ€ì„ì•„ì›ƒ: ë‹¤ìŒ ë£¨í”„ì—ì„œ ì¬ì‹œë„
        }
        MediaCodec.INFO_OUTPUT_FORMAT_CHANGED -> {
            val newFormat = codec.outputFormat
            Log.d(TAG, "Output format changed: $newFormat")
        }
        else -> {
            if (outputBufferId >= 0) {
                // í”„ë ˆì„ ë Œë”ë§
                codec.releaseOutputBuffer(outputBufferId, true)

                // EOS í™•ì¸
                if ((bufferInfo.flags and MediaCodec.BUFFER_FLAG_END_OF_STREAM) != 0) {
                    outputDone = true
                }
            }
        }
    }
}

codec.stop()
codec.release()</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># MediaCodec ìƒíƒœ í™•ì¸
adb logcat | grep -E "MediaCodec|dequeue|queueInput"

# ë²„í¼ ìƒíƒœ ëª¨ë‹ˆí„°ë§
adb shell dumpsys media.player | grep -i "buffer"</code></pre>
                </div>
            </div>

            <!-- Issue 2.3: í•´ìƒë„/í”„ë ˆì„ë ˆì´íŠ¸ ë¯¸ì§€ì› -->
            <div id="issue-resolution-unsupported" class="issue-card severity-medium">
                <h3 class="issue-title">ğŸŸ¡ Issue 2.3: íŠ¹ì • í•´ìƒë„/í”„ë ˆì„ë ˆì´íŠ¸ê°€ ì¬ìƒ ì•ˆë¨</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>4K ë¹„ë””ì˜¤ê°€ ì¬ìƒë˜ì§€ ì•ŠìŒ</li>
                        <li>60fps ì˜ìƒì´ 30fpsë¡œ ì¬ìƒë¨</li>
                        <li>"Unsupported resolution" ì—ëŸ¬</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>ì½”ë± capabilities ì œí•œ</strong>: media_codecs.xmlì—ì„œ max resolution ì œí•œ</li>
                        <li><strong>í•˜ë“œì›¨ì–´ ì„±ëŠ¥ ë¶€ì¡±</strong>: GPUê°€ 4K ë””ì½”ë”© ë¶ˆê°€</li>
                        <li><strong>ë©”ëª¨ë¦¬ ë¶€ì¡±</strong>: 4K í”„ë ˆì„ ë²„í¼ í• ë‹¹ ì‹¤íŒ¨</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">Adaptive Resolution/Framerate</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// 1. ë””ë°”ì´ìŠ¤ capabilities í™•ì¸ í›„ ì ì‘ì  ì¬ìƒ
fun getMaxSupportedResolution(mimeType: String): Size {
    val codecList = MediaCodecList(MediaCodecList.REGULAR_CODECS)
    for (codecInfo in codecList.codecInfos) {
        if (codecInfo.isEncoder) continue

        try {
            val caps = codecInfo.getCapabilitiesForType(mimeType)
            val videoCaps = caps.videoCapabilities

            val maxWidth = videoCaps.supportedWidths.upper
            val maxHeight = videoCaps.supportedHeights.upper

            return Size(maxWidth, maxHeight)
        } catch (e: Exception) {
            continue
        }
    }
    return Size(1920, 1080) // Fallback
}

// 2. ExoPlayer ABR (Adaptive Bitrate) ì„¤ì •
val trackSelector = DefaultTrackSelector(context).apply {
    parameters = buildUponParameters()
        .setMaxVideoSize(1920, 1080) // ìµœëŒ€ 1080p
        .setMaxVideoFrameRate(30) // ìµœëŒ€ 30fps
        .setForceHighestSupportedBitrate(false) // ë„¤íŠ¸ì›Œí¬ì— ë”°ë¼ ì¡°ì •
        .build()
}

// 3. ì†Œí”„íŠ¸ì›¨ì–´ ì½”ë±ìœ¼ë¡œ Fallback
fun createCodecWithFallback(mimeType: String): MediaCodec {
    return try {
        // í•˜ë“œì›¨ì–´ ì½”ë± ìš°ì„ 
        MediaCodec.createDecoderByType(mimeType)
    } catch (e: Exception) {
        // ì†Œí”„íŠ¸ì›¨ì–´ ì½”ë±ìœ¼ë¡œ Fallback
        MediaCodec.createByCodecName("OMX.google.h264.decoder")
    }
}</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># ì§€ì› í•´ìƒë„ í™•ì¸
adb shell dumpsys media.codec | grep -E "size.*max"

# ì‹¤ì œ ì¬ìƒ í•´ìƒë„ í™•ì¸
adb logcat | grep -E "VideoSize|resolution"</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 3: DRM Issues -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">3</span>
                DRM ë¬¸ì œ (DRM Issues)
            </h2>
            <p class="section-description">
                Widevine DRM ê´€ë ¨ ì¼ë°˜ì ì¸ ë¬¸ì œì™€ í•´ê²° ë°©ë²•ì…ë‹ˆë‹¤.
            </p>

            <!-- Issue 3.1: ë¼ì´ì„ ìŠ¤ íšë“ ì‹¤íŒ¨ -->
            <div id="issue-drm-license" class="issue-card severity-critical">
                <h3 class="issue-title">ğŸ”´ Issue 3.1: Widevine ë¼ì´ì„ ìŠ¤ íšë“ ì‹¤íŒ¨</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li><code>ERROR_DRM_NO_LICENSE</code> ë°œìƒ</li>
                        <li>DRM ë³´í˜¸ëœ ì½˜í…ì¸  ì¬ìƒ ë¶ˆê°€</li>
                        <li>"License server error" ë©”ì‹œì§€</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>Provisioning ì•ˆë¨</strong>: Widevine CDM ì´ˆê¸°í™” ì‹¤íŒ¨</li>
                        <li><strong>ë¼ì´ì„ ìŠ¤ ì„œë²„ í†µì‹  ì‹¤íŒ¨</strong>: ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜, ì¸ì¦ ì‹¤íŒ¨</li>
                        <li><strong>ì˜ëª»ëœ License URL</strong>: ì„œë²„ ì£¼ì†Œ ì˜¤íƒ€</li>
                        <li><strong>HDCP ë¯¸ì§€ì›</strong>: L1 í•„ìš”í•œë° ë””ë°”ì´ìŠ¤ê°€ L3ë§Œ ì§€ì›</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">Widevine DRM ë””ë²„ê¹…</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// 1. Widevine Security Level í™•ì¸
fun getWidevineSecurityLevel(context: Context): String {
    return try {
        val mediaDrm = MediaDrm(C.WIDEVINE_UUID)
        val level = mediaDrm.getPropertyString(MediaDrm.PROPERTY_SECURITY_LEVEL)
        mediaDrm.release()
        level // "L1" or "L3"
    } catch (e: Exception) {
        "Unknown"
    }
}

// 2. ë¼ì´ì„ ìŠ¤ ìš”ì²­ ìƒì„¸ ë¡œê¹…
class MyDrmCallback(private val licenseUrl: String) : MediaDrmCallback {
    override fun executeProvisionRequest(
        uuid: UUID,
        request: ProvisionRequest
    ): ByteArray {
        Log.d(TAG, "Provisioning request: ${request.defaultUrl}")
        // Provisioning ì„œë²„ë¡œ ìš”ì²­
        return executePost(request.defaultUrl, request.data, null)
    }

    override fun executeKeyRequest(
        uuid: UUID,
        request: KeyRequest
    ): ByteArray {
        Log.d(TAG, "License request URL: $licenseUrl")
        Log.d(TAG, "Request data size: ${request.data.size}")

        try {
            val response = executePost(licenseUrl, request.data, null)
            Log.d(TAG, "License response size: ${response.size}")
            return response
        } catch (e: Exception) {
            Log.e(TAG, "License request failed", e)
            throw e
        }
    }

    private fun executePost(url: String, data: ByteArray, params: Map<String, String>?): ByteArray {
        val connection = URL(url).openConnection() as HttpURLConnection
        try {
            connection.requestMethod = "POST"
            connection.doOutput = true
            connection.setRequestProperty("Content-Type", "application/octet-stream")

            params?.forEach { (key, value) ->
                connection.setRequestProperty(key, value)
            }

            connection.outputStream.use { it.write(data) }

            val responseCode = connection.responseCode
            if (responseCode != 200) {
                throw IOException("HTTP $responseCode: ${connection.responseMessage}")
            }

            return connection.inputStream.readBytes()
        } finally {
            connection.disconnect()
        }
    }
}

// 3. DrmSessionManager ì˜¬ë°”ë¥¸ ì„¤ì •
val drmCallback = MyDrmCallback(LICENSE_URL)
val drmSessionManager = DefaultDrmSessionManager.Builder()
    .setUuidAndExoMediaDrmProvider(C.WIDEVINE_UUID, FrameworkMediaDrm.DEFAULT_PROVIDER)
    .setMultiSession(false)
    .build(drmCallback)

val player = ExoPlayer.Builder(context)
    .setDrmSessionManager(drmSessionManager)
    .build()</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># Widevine Security Level í™•ì¸
adb shell getprop ro.vendor.drm.security_level

# DRM ë¡œê·¸ í™•ì¸
adb logcat | grep -E "Widevine|MediaDrm|DRM"

# Provisioning ìƒíƒœ í™•ì¸
adb shell pm list packages | grep drm</code></pre>
                </div>
            </div>

            <!-- Issue 3.2: HDCP ë¬¸ì œ -->
            <div id="issue-hdcp" class="issue-card severity-high">
                <h3 class="issue-title">ğŸ”´ Issue 3.2: HDCP ì—°ê²° ì‹¤íŒ¨ (ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´)</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>HDMIë¡œ ì—°ê²°í•œ TVì—ì„œ DRM ì½˜í…ì¸  ì¬ìƒ ì•ˆë¨</li>
                        <li>"HDCP not supported" ì—ëŸ¬</li>
                        <li>ë¯¸ëŸ¬ë§ ì‹œ í™”ë©´ì´ ê²€ì€ìƒ‰</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>HDCP ë²„ì „ ë¶ˆì¼ì¹˜</strong>: TVê°€ HDCP 2.2 ë¯¸ì§€ì›</li>
                        <li><strong>ì¼€ì´ë¸” ë¬¸ì œ</strong>: HDCP ì§€ì› ì•ˆí•˜ëŠ” ì €ê°€ ì¼€ì´ë¸”</li>
                        <li><strong>Widevine L1 í•„ìš”</strong>: ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´ëŠ” L1 í•„ìˆ˜</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">HDCP ìƒíƒœ í™•ì¸</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// DisplayManagerë¡œ HDCP ì§€ì› í™•ì¸
val displayManager = getSystemService(Context.DISPLAY_SERVICE) as DisplayManager
val displays = displayManager.displays

for (display in displays) {
    val hdrCapabilities = display.hdrCapabilities
    Log.d(TAG, "Display ${display.displayId}: HDR types = ${hdrCapabilities?.supportedHdrTypes?.joinToString()}")

    // HDCP ë ˆë²¨ í™•ì¸ (API 28+)
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.P) {
        val isWideColorGamut = display.isWideColorGamut
        Log.d(TAG, "Wide color gamut: $isWideColorGamut")
    }
}

// ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´ ê°ì§€ ì‹œ L1 í•„ìˆ˜ ì²´í¬
fun checkHdcpForExternalDisplay(): Boolean {
    val widevineLevel = getWidevineSecurityLevel(this)
    if (widevineLevel != "L1") {
        showError("ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´ëŠ” Widevine L1 í•„ìš” (í˜„ì¬: $widevineLevel)")
        return false
    }
    return true
}</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># HDCP ìƒíƒœ í™•ì¸
adb shell dumpsys display | grep -i hdcp

# Widevine Security Level
adb shell getprop | grep drm</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 4: Audio Issues -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">4</span>
                ì˜¤ë””ì˜¤ ë¬¸ì œ (Audio Issues)
            </h2>
            <p class="section-description">
                ì˜¤ë””ì˜¤ ì¬ìƒ ë° Focus ê´€ë ¨ ì¼ë°˜ì ì¸ ë¬¸ì œì…ë‹ˆë‹¤.
            </p>

            <!-- Issue 4.1: Audio Focus ë¬¸ì œ -->
            <div id="issue-audio-focus" class="issue-card severity-high">
                <h3 class="issue-title">ğŸ”´ Issue 4.1: Audio Focusë¥¼ ì–»ì§€ ëª»í•¨</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>ì¬ìƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ ì†Œë¦¬ê°€ ì•ˆë‚¨</li>
                        <li>ë‹¤ë¥¸ ì•± ì¬ìƒ ì¤‘ ì†Œë¦¬ê°€ ê²¹ì¹¨</li>
                        <li>ì „í™” ì™”ì„ ë•Œ ìŒì•…ì´ ë©ˆì¶”ì§€ ì•ŠìŒ</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>Audio Focus ìš”ì²­ ì•ˆí•¨</strong>: requestAudioFocus() ë¯¸í˜¸ì¶œ</li>
                        <li><strong>ì˜ëª»ëœ Focus Type</strong>: AUDIOFOCUS_GAIN vs AUDIOFOCUS_GAIN_TRANSIENT</li>
                        <li><strong>Focus Change Listener ë¯¸êµ¬í˜„</strong>: ë‹¤ë¥¸ ì•±ì´ Focus ê°€ì ¸ê°ˆ ë•Œ ì²˜ë¦¬ ì•ˆí•¨</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">Audio Focus ì˜¬ë°”ë¥¸ ì‚¬ìš©</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>val audioManager = getSystemService(Context.AUDIO_SERVICE) as AudioManager

// AudioAttributes ì •ì˜
val audioAttributes = AudioAttributes.Builder()
    .setUsage(AudioAttributes.USAGE_MEDIA)
    .setContentType(AudioAttributes.CONTENT_TYPE_MUSIC)
    .build()

// AudioFocusRequest ìƒì„± (API 26+)
val focusRequest = AudioFocusRequest.Builder(AudioManager.AUDIOFOCUS_GAIN)
    .setAudioAttributes(audioAttributes)
    .setAcceptsDelayedFocusGain(true) // ë‚˜ì¤‘ì— Focus ì–»ê¸° í—ˆìš©
    .setOnAudioFocusChangeListener { focusChange ->
        when (focusChange) {
            AudioManager.AUDIOFOCUS_GAIN -> {
                // Focus ì–»ìŒ: ì¬ìƒ ì¬ê°œ
                player.setVolume(1.0f)
                if (playbackDelayed || resumeOnFocusGain) {
                    player.play()
                }
            }
            AudioManager.AUDIOFOCUS_LOSS -> {
                // Focus ì™„ì „íˆ ìƒìŒ: ì¬ìƒ ì¤‘ì§€
                playbackDelayed = false
                player.pause()
            }
            AudioManager.AUDIOFOCUS_LOSS_TRANSIENT -> {
                // ì¼ì‹œì ìœ¼ë¡œ ìƒìŒ (ì „í™”): ì¼ì‹œì •ì§€
                playbackDelayed = false
                player.pause()
                resumeOnFocusGain = true
            }
            AudioManager.AUDIOFOCUS_LOSS_TRANSIENT_CAN_DUCK -> {
                // ì¼ì‹œì ìœ¼ë¡œ ìƒìŒ (ì•Œë¦¼): ë³¼ë¥¨ ë‚®ì¶¤ (Ducking)
                player.setVolume(0.2f)
            }
        }
    }
    .build()

// Focus ìš”ì²­
val result = audioManager.requestAudioFocus(focusRequest)
when (result) {
    AudioManager.AUDIOFOCUS_REQUEST_GRANTED -> {
        // Focus ì–»ìŒ: ì¬ìƒ ì‹œì‘
        player.play()
    }
    AudioManager.AUDIOFOCUS_REQUEST_FAILED -> {
        // Focus ëª» ì–»ìŒ
        Log.e(TAG, "Audio focus request failed")
    }
    AudioManager.AUDIOFOCUS_REQUEST_DELAYED -> {
        // ë‚˜ì¤‘ì— ì–»ìŒ
        playbackDelayed = true
    }
}

// ì¬ìƒ ì¢…ë£Œ ì‹œ Focus ë°˜í™˜
audioManager.abandonAudioFocusRequest(focusRequest)</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># Audio Focus ìƒíƒœ í™•ì¸
adb shell dumpsys audio | grep -A 10 "Audio Focus"

# í˜„ì¬ Focus ì†Œìœ ì
adb shell dumpsys media.audio_flinger | grep -i focus</code></pre>
                </div>
            </div>

            <!-- Issue 4.2: ì˜¤ë””ì˜¤ ë¼ìš°íŒ… ë¬¸ì œ (ì°¨ëŸ‰ìš©) -->
            <div id="issue-audio-routing" class="issue-card severity-critical">
                <h3 class="issue-title">ğŸ”´ Issue 4.2: ì°¨ëŸ‰ì—ì„œ ì˜¤ë””ì˜¤ê°€ ì˜ëª»ëœ ìŠ¤í”¼ì»¤ë¡œ ì¶œë ¥ë¨</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>ë¯¸ë””ì–´ ì†Œë¦¬ê°€ ì „í™” ìŠ¤í”¼ì»¤ë¡œ ë‚˜ì˜´</li>
                        <li>Navigation ìŒì„±ì´ Rear Seatì—ì„œ ë“¤ë¦¼</li>
                        <li>Zone ì„¤ì •ì´ ì ìš© ì•ˆë¨</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>ì˜ëª»ëœ AudioAttributes Usage</strong>: USAGE_MEDIA vs USAGE_VOICE_COMMUNICATION</li>
                        <li><strong>Car Audio Zone ë¯¸ì„¤ì •</strong>: CarAudioManager ë¯¸ì‚¬ìš©</li>
                        <li><strong>audio_policy_configuration.xml ì˜¤ë¥˜</strong>: ë¼ìš°íŒ… ê·œì¹™ ì˜ëª» ì„¤ì •</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">Car Audio Routing (AAOS)</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// CarAudioManager ì‚¬ìš© (AAOS)
val car = Car.createCar(this)
val carAudioManager = car.getCarManager(Car.AUDIO_SERVICE) as CarAudioManager

// Primary Zone (ìš´ì „ì„)ì—ì„œ ë¯¸ë””ì–´ ì¬ìƒ
val primaryZone = CarAudioManager.PRIMARY_AUDIO_ZONE
val audioAttributes = AudioAttributes.Builder()
    .setUsage(AudioAttributes.USAGE_MEDIA) // ë¯¸ë””ì–´ ìš©ë„
    .setContentType(AudioAttributes.CONTENT_TYPE_MUSIC)
    .build()

val player = ExoPlayer.Builder(this).build()
player.setAudioAttributes(audioAttributes, true)

// Zoneë³„ ë³¼ë¥¨ ì œì–´
val maxVolume = carAudioManager.getGroupMaxVolume(primaryZone, groupId)
val currentVolume = carAudioManager.getGroupVolume(primaryZone, groupId)
carAudioManager.setGroupVolume(primaryZone, groupId, newVolume, flags)

// Navigation TTSëŠ” ë³„ë„ Usage
val navAudioAttributes = AudioAttributes.Builder()
    .setUsage(AudioAttributes.USAGE_ASSISTANCE_NAVIGATION_GUIDANCE)
    .setContentType(AudioAttributes.CONTENT_TYPE_SPEECH)
    .build()</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># Car Audio Zones í™•ì¸
adb shell dumpsys car_service --services CarAudioService

# ì˜¤ë””ì˜¤ ë¼ìš°íŒ… í™•ì¸
adb shell dumpsys media.audio_flinger | grep -E "stream|device"

# audio_policy í™•ì¸
adb shell cat /vendor/etc/audio_policy_configuration.xml</code></pre>
                </div>
            </div>

            <!-- Issue 4.3: ì˜¤ë””ì˜¤ ë ˆì´í„´ì‹œ ë†’ìŒ -->
            <div id="issue-audio-latency" class="issue-card severity-medium">
                <h3 class="issue-title">ğŸŸ¡ Issue 4.3: ì˜¤ë””ì˜¤ ë ˆì´í„´ì‹œê°€ ë„ˆë¬´ ë†’ìŒ (>100ms)</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>í„°ì¹˜ ì‚¬ìš´ë“œê°€ ëŠ¦ê²Œ ë“¤ë¦¼</li>
                        <li>ê²Œì„ ì˜¤ë””ì˜¤ ë°˜ì‘ì´ ëŠë¦¼</li>
                        <li>ì‹¤ì‹œê°„ ìŒì•… ì•±ì—ì„œ ë”œë ˆì´</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>í° ë²„í¼ í¬ê¸°</strong>: AudioTrack ë²„í¼ê°€ ë„ˆë¬´ í¼</li>
                        <li><strong>ì†Œí”„íŠ¸ì›¨ì–´ ë¯¹ì„œ</strong>: í•˜ë“œì›¨ì–´ ë¯¹ì„œ ë¯¸ì‚¬ìš©</li>
                        <li><strong>ë¦¬ìƒ˜í”Œë§</strong>: 48kHz â†’ 44.1kHz ë³€í™˜ ì˜¤ë²„í—¤ë“œ</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">ì €ì§€ì—° ì˜¤ë””ì˜¤ ì„¤ì •</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// 1. ìµœì†Œ ë²„í¼ í¬ê¸° ì‚¬ìš©
val minBufferSize = AudioTrack.getMinBufferSize(
    44100,
    AudioFormat.CHANNEL_OUT_STEREO,
    AudioFormat.ENCODING_PCM_16BIT
)

// 2. ì €ì§€ì—° AudioAttributes
val audioAttributes = AudioAttributes.Builder()
    .setUsage(AudioAttributes.USAGE_GAME) // ê²Œì„/ì‹¤ì‹œê°„ ìš©ë„
    .setContentType(AudioAttributes.CONTENT_TYPE_MUSIC)
    .setFlags(AudioAttributes.FLAG_LOW_LATENCY) // ì €ì§€ì—° í”Œë˜ê·¸
    .build()

// 3. Performance Mode ì„¤ì •
val audioFormat = AudioFormat.Builder()
    .setSampleRate(44100) // ë„¤ì´í‹°ë¸Œ ìƒ˜í”Œë ˆì´íŠ¸ ì‚¬ìš©
    .setChannelMask(AudioFormat.CHANNEL_OUT_STEREO)
    .setEncoding(AudioFormat.ENCODING_PCM_16BIT)
    .build()

val audioTrack = AudioTrack.Builder()
    .setAudioAttributes(audioAttributes)
    .setAudioFormat(audioFormat)
    .setBufferSizeInBytes(minBufferSize)
    .setTransferMode(AudioTrack.MODE_STREAM)
    .setPerformanceMode(AudioTrack.PERFORMANCE_MODE_LOW_LATENCY) // ì €ì§€ì—° ëª¨ë“œ
    .build()

// 4. ë„¤ì´í‹°ë¸Œ ìƒ˜í”Œë ˆì´íŠ¸ í™•ì¸
val audioManager = getSystemService(Context.AUDIO_SERVICE) as AudioManager
val nativeSampleRate = audioManager.getProperty(AudioManager.PROPERTY_OUTPUT_SAMPLE_RATE)
val nativeBufferSize = audioManager.getProperty(AudioManager.PROPERTY_OUTPUT_FRAMES_PER_BUFFER)
Log.d(TAG, "Native: $nativeSampleRate Hz, buffer: $nativeBufferSize frames")</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># ì˜¤ë””ì˜¤ ë ˆì´í„´ì‹œ ì¸¡ì •
adb shell dumpsys media.audio_flinger | grep -i latency

# ë„¤ì´í‹°ë¸Œ ìƒ˜í”Œë ˆì´íŠ¸ í™•ì¸
adb shell getprop | grep audio.sample

# ë²„í¼ í¬ê¸° í™•ì¸
adb logcat | grep -E "AudioTrack|buffer"</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 5: Automotive Specific Issues -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">5</span>
                ì°¨ëŸ‰ìš© íŠ¹í™” ë¬¸ì œ (Automotive Issues)
            </h2>
            <p class="section-description">
                Android Automotive OS (AAOS) íŠ¹í™” ë¬¸ì œì…ë‹ˆë‹¤.
            </p>

            <!-- Issue 5.1: UX Restrictions ìœ„ë°˜ -->
            <div id="issue-ux-restrictions" class="issue-card severity-critical">
                <h3 class="issue-title">ğŸ”´ Issue 5.1: ì£¼í–‰ ì¤‘ ë¹„ë””ì˜¤ ì¬ìƒë¨ (UX Restrictions ìœ„ë°˜)</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>ì£¼í–‰ ì¤‘ì—ë„ ë¹„ë””ì˜¤ê°€ ê³„ì† ì¬ìƒë¨</li>
                        <li>ë²•ê·œ ìœ„ë°˜ ê°€ëŠ¥ì„±</li>
                        <li>ì•ˆì „ ë¬¸ì œ</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>CarUxRestrictionsManager ë¯¸ì‚¬ìš©</strong>: ì£¼í–‰ ìƒíƒœ ëª¨ë‹ˆí„°ë§ ì•ˆí•¨</li>
                        <li><strong>Distraction Optimization ë¯¸ì ìš©</strong>: ë¹„ë””ì˜¤ ì°¨ë‹¨ ë¡œì§ ì—†ìŒ</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">CarUxRestrictions ì²˜ë¦¬</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>val car = Car.createCar(this)
val carUxRestrictionsManager = car.getCarManager(Car.CAR_UX_RESTRICTION_SERVICE)
    as CarUxRestrictionsManager

// Restrictions ë³€ê²½ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
carUxRestrictionsManager.registerListener { restrictions ->
    if (restrictions.isRequiresDistractionOptimization) {
        // ì£¼í–‰ ì¤‘: ë¹„ë””ì˜¤ ì°¨ë‹¨, ì˜¤ë””ì˜¤ë§Œ ì¬ìƒ
        Log.w(TAG, "Driving detected - switching to audio only")

        // ë¹„ë””ì˜¤ ìˆ¨ê¹€
        playerView.visibility = View.GONE

        // ë¹„ë””ì˜¤ íŠ¸ë™ ë¹„í™œì„±í™” (ì˜¤ë””ì˜¤ë§Œ ì¬ìƒ)
        val trackSelector = player.trackSelector as DefaultTrackSelector
        trackSelector.parameters = trackSelector.buildUponParameters()
            .setMaxVideoSize(0, 0) // ë¹„ë””ì˜¤ ë¹„í™œì„±í™”
            .build()

        // UI ì œí•œ (ë²„íŠ¼ ë¹„í™œì„±í™” ë“±)
        disableComplexUI()

    } else {
        // ì •ì°¨: ë¹„ë””ì˜¤ ì¬ìƒ í—ˆìš©
        Log.i(TAG, "Parked - enabling video playback")

        playerView.visibility = View.VISIBLE

        val trackSelector = player.trackSelector as DefaultTrackSelector
        trackSelector.parameters = trackSelector.buildUponParameters()
            .clearVideoSizeConstraints()
            .build()

        enableFullUI()
    }
}

fun disableComplexUI() {
    // í…ìŠ¤íŠ¸ ì…ë ¥ ë¹„í™œì„±í™”
    searchEditText.isEnabled = false

    // ë¦¬ìŠ¤íŠ¸ í•­ëª© ì œí•œ (ìµœëŒ€ 6ê°œ)
    adapter.maxItems = 6

    // ë³µì¡í•œ ì• ë‹ˆë©”ì´ì…˜ ì¤‘ì§€
    complexAnimation.cancel()
}

// ì•± ì¢…ë£Œ ì‹œ ë¦¬ìŠ¤ë„ˆ í•´ì œ
override fun onDestroy() {
    super.onDestroy()
    carUxRestrictionsManager.unregisterListener()
    car.disconnect()
}</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># ì°¨ëŸ‰ ì†ë„ í™•ì¸ (VHAL ì‹œë®¬ë ˆì´í„°)
adb shell dumpsys car_service --services VehicleHal | grep SPEED

# UX Restrictions ìƒíƒœ
adb shell dumpsys car_service --services CarUxRestrictionService

# ì£¼í–‰ ëª¨ë“œ ì‹œë®¬ë ˆì´ì…˜
adb shell cmd car_service inject-vhal-event 0x11600207 1 -i 30 # 30 km/h</code></pre>
                </div>
            </div>

            <!-- Issue 5.2: CarMediaService ì—°ë™ ì•ˆë¨ -->
            <div id="issue-car-media" class="issue-card severity-high">
                <h3 class="issue-title">ğŸ”´ Issue 5.2: ì°¨ëŸ‰ ë¯¸ë””ì–´ ì»¨íŠ¸ë¡¤ì—ì„œ ì•±ì´ ì•ˆë³´ì„</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>ê³„ê¸°íŒ/HUDì—ì„œ ë¯¸ë””ì–´ ì•±ì´ í‘œì‹œ ì•ˆë¨</li>
                        <li>ìŠ¤í‹°ì–´ë§ íœ  ë²„íŠ¼ìœ¼ë¡œ ì œì–´ ë¶ˆê°€</li>
                        <li>Last Media Sourceì— ë“±ë¡ ì•ˆë¨</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>MediaBrowserService ë¯¸êµ¬í˜„</strong>: Car Media ì—°ë™ í•„ìˆ˜</li>
                        <li><strong>MediaSession ë¯¸ì„¤ì •</strong>: ì™¸ë¶€ ì œì–´ ë¶ˆê°€</li>
                        <li><strong>AndroidManifest ì„¤ì • ëˆ„ë½</strong>: media-browse ì¸í…íŠ¸ í•„í„° ì—†ìŒ</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">MediaBrowserService êµ¬í˜„ (AAOS)</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// 1. AndroidManifest.xml
/*
<service android:name=".MusicService"
         android:exported="true">
    <intent-filter>
        <action android:name="android.media.browse.MediaBrowserService" />
    </intent-filter>
</service>
*/

// 2. MediaBrowserServiceCompat êµ¬í˜„
class MusicService : MediaBrowserServiceCompat() {

    private lateinit var mediaSession: MediaSessionCompat

    override fun onCreate() {
        super.onCreate()

        // MediaSession ìƒì„±
        mediaSession = MediaSessionCompat(this, TAG).apply {
            setFlags(
                MediaSessionCompat.FLAG_HANDLES_MEDIA_BUTTONS or
                MediaSessionCompat.FLAG_HANDLES_TRANSPORT_CONTROLS
            )
            setCallback(MediaSessionCallback())
            isActive = true
        }

        sessionToken = mediaSession.sessionToken
    }

    override fun onGetRoot(
        clientPackageName: String,
        clientUid: Int,
        rootHints: Bundle?
    ): BrowserRoot? {
        // Car Media Serviceì—ì„œ ì—°ê²° í—ˆìš©
        return BrowserRoot("root", null)
    }

    override fun onLoadChildren(
        parentId: String,
        result: Result<List<MediaBrowserCompat.MediaItem>>
    ) {
        // ë¯¸ë””ì–´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì œê³µ
        val mediaItems = listOf(
            MediaBrowserCompat.MediaItem(
                MediaDescriptionCompat.Builder()
                    .setMediaId("song1")
                    .setTitle("Song Title")
                    .setSubtitle("Artist Name")
                    .setIconUri(Uri.parse("https://..."))
                    .build(),
                MediaBrowserCompat.MediaItem.FLAG_PLAYABLE
            )
        )
        result.sendResult(mediaItems)
    }

    inner class MediaSessionCallback : MediaSessionCompat.Callback() {
        override fun onPlay() {
            // ì¬ìƒ ì‹œì‘
            player.play()
            updatePlaybackState(PlaybackStateCompat.STATE_PLAYING)
        }

        override fun onPause() {
            player.pause()
            updatePlaybackState(PlaybackStateCompat.STATE_PAUSED)
        }

        override fun onSkipToNext() {
            player.seekToNext()
        }

        override fun onSkipToPrevious() {
            player.seekToPrevious()
        }
    }

    private fun updatePlaybackState(state: Int) {
        val playbackState = PlaybackStateCompat.Builder()
            .setState(state, player.currentPosition, 1.0f)
            .setActions(
                PlaybackStateCompat.ACTION_PLAY or
                PlaybackStateCompat.ACTION_PAUSE or
                PlaybackStateCompat.ACTION_SKIP_TO_NEXT or
                PlaybackStateCompat.ACTION_SKIP_TO_PREVIOUS
            )
            .build()
        mediaSession.setPlaybackState(playbackState)
    }
}</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># MediaBrowserService ë“±ë¡ í™•ì¸
adb shell dumpsys media_session | grep -A 10 "MediaBrowser"

# Last Media Source í™•ì¸
adb shell dumpsys car_service --services CarMediaService

# MediaSession ìƒíƒœ
adb shell dumpsys media_session</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 6: Performance Issues -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">6</span>
                ì„±ëŠ¥ ë¬¸ì œ (Performance Issues)
            </h2>
            <p class="section-description">
                ë¯¸ë””ì–´ ì¬ìƒ ì„±ëŠ¥ ê´€ë ¨ ë¬¸ì œì™€ ìµœì í™” ë°©ë²•ì…ë‹ˆë‹¤.
            </p>

            <!-- Issue 6.1: í”„ë ˆì„ ë“œë¡­ -->
            <div id="issue-frame-drop" class="issue-card severity-high">
                <h3 class="issue-title">ğŸ”´ Issue 6.1: ë¹„ë””ì˜¤ í”„ë ˆì„ ë“œë¡­ ë°œìƒ</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li>ì¬ìƒì´ ëŠê¸°ê±°ë‚˜ ë²„ë²…ê±°ë¦¼</li>
                        <li>í”„ë ˆì„ ìŠ¤í‚µ ë°œìƒ</li>
                        <li>ë¶€ë“œëŸ½ì§€ ì•Šì€ ì¬ìƒ</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>CPU/GPU ê³¼ë¶€í•˜</strong>: ë‹¤ë¥¸ ì•±ì´ ë¦¬ì†ŒìŠ¤ ì ìœ </li>
                        <li><strong>ë©”ì¸ ìŠ¤ë ˆë“œ ë¸”ë¡œí‚¹</strong>: UI ìŠ¤ë ˆë“œì—ì„œ ë¬´ê±°ìš´ ì‘ì—…</li>
                        <li><strong>ë””ì½”ë” ì„±ëŠ¥ ë¶€ì¡±</strong>: 4K ì˜ìƒì„ ì†Œí”„íŠ¸ì›¨ì–´ ë””ì½”ë”ë¡œ ì¬ìƒ</li>
                        <li><strong>ë²„í¼ ë¶€ì¡±</strong>: ë„¤íŠ¸ì›Œí¬ ì†ë„ë³´ë‹¤ ì†Œë¹„ ì†ë„ ë¹ ë¦„</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">í”„ë ˆì„ ë“œë¡­ ìµœì í™”</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// 1. í•˜ë“œì›¨ì–´ ë””ì½”ë” ìš°ì„  ì‚¬ìš©
val renderersFactory = object : DefaultRenderersFactory(context) {
    override fun buildVideoRenderers(/* ... */): ArrayList<Renderer> {
        val renderers = ArrayList<Renderer>()
        renderers.add(
            MediaCodecVideoRenderer(
                context,
                MediaCodecSelector.DEFAULT,
                allowedVideoJoiningTimeMs = 5000,
                enableDecoderFallback = false, // ì†Œí”„íŠ¸ì›¨ì–´ Fallback ë¹„í™œì„±í™”
                handler,
                videoRendererEventListener,
                MAX_DROPPED_VIDEO_FRAME_COUNT_TO_NOTIFY
            )
        )
        return renderers
    }
}

// 2. ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œì—ì„œ ë¬´ê±°ìš´ ì‘ì—… ì²˜ë¦¬
lifecycleScope.launch(Dispatchers.IO) {
    // ì¸ë„¤ì¼ ë¡œë”© ë“±
}

// 3. í”„ë ˆì„ ë“œë¡­ ëª¨ë‹ˆí„°ë§
player.addAnalyticsListener(object : AnalyticsListener {
    override fun onDroppedVideoFrames(
        eventTime: AnalyticsListener.EventTime,
        droppedFrames: Int,
        elapsedMs: Long
    ) {
        Log.w(TAG, "Dropped $droppedFrames frames in ${elapsedMs}ms")

        if (droppedFrames > 30) {
            // ì‹¬ê°í•œ ë“œë¡­: í•´ìƒë„ ë‚®ì¶¤
            val trackSelector = player.trackSelector as DefaultTrackSelector
            trackSelector.parameters = trackSelector.buildUponParameters()
                .setMaxVideoSizeSd()
                .build()
        }
    }
})

// 4. Surface ìµœì í™”
val surfaceView = findViewById<SurfaceView>(R.id.surface)
surfaceView.holder.setFormat(PixelFormat.RGBA_8888)

// 5. CPU Governor ì„¤ì • (ë£¨íŠ¸ ê¶Œí•œ í•„ìš”)
// adb shell "echo performance > /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor"</code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># í”„ë ˆì„ ë“œë¡­ í™•ì¸
adb shell dumpsys media.player | grep -i "frames dropped"

# CPU ì‚¬ìš©ë¥ 
adb shell top -n 1 | grep <package-name>

# GPU ë Œë”ë§ í”„ë¡œíŒŒì¼ë§
adb shell setprop debug.hwui.profile visual_bars</code></pre>
                </div>
            </div>

            <!-- Issue 6.2: ë©”ëª¨ë¦¬ ë¶€ì¡± -->
            <div id="issue-oom" class="issue-card severity-critical">
                <h3 class="issue-title">ğŸ”´ Issue 6.2: OutOfMemoryError ë°œìƒ</h3>

                <div class="issue-section">
                    <span class="issue-label">ğŸ’Š ì¦ìƒ</span>
                    <ul>
                        <li><code>java.lang.OutOfMemoryError</code> í¬ë˜ì‹œ</li>
                        <li>ì•±ì´ ê°‘ìê¸° ì¢…ë£Œë¨</li>
                        <li>ê¸´ ì¬ìƒ í›„ ë©”ëª¨ë¦¬ ë¶€ì¡±</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ” ì›ì¸</span>
                    <ul>
                        <li><strong>ë©”ëª¨ë¦¬ ëˆ„ìˆ˜</strong>: MediaCodec, Surface ë¯¸í•´ì œ</li>
                        <li><strong>ë¹„íŠ¸ë§µ ìºì‹±</strong>: ì¸ë„¤ì¼ ì´ë¯¸ì§€ ê³¼ë‹¤ ë©”ëª¨ë¦¬ ì ìœ </li>
                        <li><strong>í° ë²„í¼ í• ë‹¹</strong>: 4K í”„ë ˆì„ ë²„í¼ê°€ ë„ˆë¬´ í¼</li>
                    </ul>
                </div>

                <div class="issue-section">
                    <span class="issue-label">âœ… í•´ê²°ë²•</span>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-title">ë©”ëª¨ë¦¬ ê´€ë¦¬</span>
                            <span class="code-lang">Kotlin</span>
                        </div>
                        <pre><code>// 1. MediaCodec ì •ë¦¬
override fun onDestroy() {
    super.onDestroy()

    try {
        codec?.stop()
        codec?.release()
        codec = null
    } catch (e: Exception) {
        Log.e(TAG, "Error releasing codec", e)
    }

    surface?.release()
    surface = null
}

// 2. ExoPlayer ì •ë¦¬
override fun onStop() {
    super.onStop()
    player.release()
}

// 3. ì´ë¯¸ì§€ ë¡œë”© ìµœì í™” (Glide)
Glide.with(context)
    .load(thumbnailUrl)
    .override(200, 200) // í¬ê¸° ì œí•œ
    .diskCacheStrategy(DiskCacheStrategy.RESOURCE)
    .into(imageView)

// 4. ë©”ëª¨ë¦¬ ëª¨ë‹ˆí„°ë§
val activityManager = getSystemService(Context.ACTIVITY_SERVICE) as ActivityManager
val memoryInfo = ActivityManager.MemoryInfo()
activityManager.getMemoryInfo(memoryInfo)

if (memoryInfo.lowMemory) {
    Log.w(TAG, "Low memory detected - clearing cache")
    Glide.get(this).clearMemory()
    player.stop()
}

// 5. largeHeap ì‚¬ìš© (AndroidManifest.xml)
// <application android:largeHeap="true"></code></pre>
                    </div>
                </div>

                <div class="issue-section">
                    <span class="issue-label">ğŸ§ª ê²€ì¦</span>
                    <pre style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; overflow-x: auto;">
<code># ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
adb shell dumpsys meminfo <package-name>

# ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ê²€ì‚¬ (LeakCanary)
# build.gradleì— ì¶”ê°€: debugImplementation 'com.squareup.leakcanary:leakcanary-android:2.x'

# í™ ë¤í”„
adb shell am dumpheap <package-name> /data/local/tmp/heap.hprof
adb pull /data/local/tmp/heap.hprof</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 7: Quick Diagnosis Flowchart -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">7</span>
                ë¹ ë¥¸ ì§„ë‹¨ í”Œë¡œìš°ì°¨íŠ¸
            </h2>
            <p class="section-description">
                ë¬¸ì œ ìœ í˜•ë³„ ë¹ ë¥¸ ì§„ë‹¨ íë¦„ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    flowchart TD
                    START[ë¯¸ë””ì–´ ë¬¸ì œ ë°œìƒ] --> Q1{ì†Œë¦¬ê°€ ë‚˜ëŠ”ê°€?}

                    Q1 -->|ì˜ˆ| Q2{í™”ë©´ì´ ë‚˜ì˜¤ëŠ”ê°€?}
                    Q1 -->|ì•„ë‹ˆì˜¤| AUDIO_ISSUE[ì˜¤ë””ì˜¤ ë¬¸ì œ<br/>Section 4 ì°¸ì¡°]

                    Q2 -->|ì˜ˆ| Q3{ë²„í¼ë§/ëŠê¹€?}
                    Q2 -->|ì•„ë‹ˆì˜¤| CODEC_ISSUE[ì½”ë± ë¬¸ì œ<br/>Section 2 ì°¸ì¡°]

                    Q3 -->|ì˜ˆ| PLAYBACK_ISSUE[ì¬ìƒ ë¬¸ì œ<br/>Section 1 ì°¸ì¡°]
                    Q3 -->|ì•„ë‹ˆì˜¤| Q4{DRM ì½˜í…ì¸ ?}

                    Q4 -->|ì˜ˆ| DRM_ISSUE[DRM ë¬¸ì œ<br/>Section 3 ì°¸ì¡°]
                    Q4 -->|ì•„ë‹ˆì˜¤| Q5{ì°¨ëŸ‰ìš©?}

                    Q5 -->|ì˜ˆ| AUTO_ISSUE[ì°¨ëŸ‰ìš© ë¬¸ì œ<br/>Section 5 ì°¸ì¡°]
                    Q5 -->|ì•„ë‹ˆì˜¤| PERF_ISSUE[ì„±ëŠ¥ ë¬¸ì œ<br/>Section 6 ì°¸ì¡°]
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ’¡ ì¦ìƒë³„ ë¹ ë¥¸ ì²´í¬ë¦¬ìŠ¤íŠ¸
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”‡</span>
                        ì†Œë¦¬ê°€ ì•ˆë‚¨
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>âœ“ Audio Focus í™•ì¸</li>
                            <li>âœ“ ë³¼ë¥¨ ì„¤ì • í™•ì¸</li>
                            <li>âœ“ ìŒì†Œê±° ìƒíƒœ í™•ì¸</li>
                            <li>âœ“ AudioAttributes í™•ì¸</li>
                            <li>âœ“ ì°¨ëŸ‰ìš©: Zone/Routing í™•ì¸</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“º</span>
                        í™”ë©´ì´ ì•ˆë‚˜ì˜´
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>âœ“ MediaCodec ì´ˆê¸°í™” í™•ì¸</li>
                            <li>âœ“ Surface ì„¤ì • í™•ì¸</li>
                            <li>âœ“ í•´ìƒë„ ì§€ì› ì—¬ë¶€ í™•ì¸</li>
                            <li>âœ“ dequeueOutputBuffer ë¡œê·¸ í™•ì¸</li>
                            <li>âœ“ í•˜ë“œì›¨ì–´ ë””ì½”ë” ì‚¬ìš© í™•ì¸</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”„</span>
                        ë²„í¼ë§
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>âœ“ ë„¤íŠ¸ì›Œí¬ ì†ë„ í™•ì¸</li>
                            <li>âœ“ ë²„í¼ í¬ê¸° í™•ì¸</li>
                            <li>âœ“ ABR ì„¤ì • í™•ì¸</li>
                            <li>âœ“ ì„œë²„ ì‘ë‹µ ì‹œê°„ í™•ì¸</li>
                            <li>âœ“ CDN ìƒíƒœ í™•ì¸</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”’</span>
                        DRM ì—ëŸ¬
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>âœ“ Widevine Level í™•ì¸ (L1/L3)</li>
                            <li>âœ“ Provisioning ìƒíƒœ í™•ì¸</li>
                            <li>âœ“ ë¼ì´ì„ ìŠ¤ URL í™•ì¸</li>
                            <li>âœ“ HDCP ì§€ì› í™•ì¸ (ì™¸ë¶€ ë””ìŠ¤í”Œë ˆì´)</li>
                            <li>âœ“ ì¸ì¦ í† í° í™•ì¸</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 8: Related Documents -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">8</span>
                ê´€ë ¨ ìƒì„¸ ë¬¸ì„œ
            </h2>
            <p class="section-description">
                ê° ë¬¸ì œ ìœ í˜•ë³„ ìƒì„¸ ë¬¸ì„œ ë§í¬ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¬</span>
                        Media Playback
                    </h3>
                    <div class="card-description">
                        <p>ë¯¸ë””ì–´ ì¬ìƒ íŒŒì´í”„ë¼ì¸ ìƒì„¸</p>
                        <a href="media-playback.html" style="color: var(--accent-primary); text-decoration: none; font-weight: 600;">
                            ë¬¸ì„œ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸï¸</span>
                        Codec 2.0
                    </h3>
                    <div class="card-description">
                        <p>MediaCodec ì•„í‚¤í…ì²˜ ë° ì‚¬ìš©ë²•</p>
                        <a href="codec2.html" style="color: var(--accent-primary); text-decoration: none; font-weight: 600;">
                            ë¬¸ì„œ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”’</span>
                        Widevine DRM
                    </h3>
                    <div class="card-description">
                        <p>DRM ë³´ì•ˆ ë° ë¼ì´ì„ ìŠ¤ ê´€ë¦¬</p>
                        <a href="widevine.html" style="color: var(--accent-primary); text-decoration: none; font-weight: 600;">
                            ë¬¸ì„œ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸµ</span>
                        Audio Framework
                    </h3>
                    <div class="card-description">
                        <p>ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</p>
                        <a href="audio-framework.html" style="color: var(--accent-primary); text-decoration: none; font-weight: 600;">
                            ë¬¸ì„œ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš—</span>
                        Car Media Service
                    </h3>
                    <div class="card-description">
                        <p>AAOS ë¯¸ë””ì–´ ì‹œìŠ¤í…œ</p>
                        <a href="carmedia.html" style="color: var(--accent-primary); text-decoration: none; font-weight: 600;">
                            ë¬¸ì„œ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“±</span>
                        Media App Layer
                    </h3>
                    <div class="card-description">
                        <p>MediaPlayer/ExoPlayer/Media3 API</p>
                        <a href="media-app-layer.html" style="color: var(--accent-primary); text-decoration: none; font-weight: 600;">
                            ë¬¸ì„œ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ®</span>
                        MediaSession
                    </h3>
                    <div class="card-description">
                        <p>ë¯¸ë””ì–´ ì„¸ì…˜ í”„ë ˆì„ì›Œí¬</p>
                        <a href="mediasession.html" style="color: var(--accent-primary); text-decoration: none; font-weight: 600;">
                            ë¬¸ì„œ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ—ï¸</span>
                        AOSP Architecture
                    </h3>
                    <div class="card-description">
                        <p>Android ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°</p>
                        <a href="aosp.html" style="color: var(--accent-primary); text-decoration: none; font-weight: 600;">
                            ë¬¸ì„œ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer
            style="text-align: center; padding: 40px 20px; color: var(--text-muted); border-top: 1px solid var(--border-color); margin-top: 60px;">
            <p>Common Media Issues & Solutions</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                Android ë¯¸ë””ì–´ í”„ë ˆì„ì›Œí¬ ì‹¤ë¬´ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ
            </p>
            <p style="margin-top: 20px;">
                <a href="index.html" style="color: var(--accent-primary); text-decoration: none;">
                    â† AOSP Media Frameworkë¡œ ëŒì•„ê°€ê¸°
                </a>
            </p>
        </footer>
    </div>

    <script src="scripts/mermaid-theme.js"></script>
    <!-- Navigation & Copy Features -->
    <script src="scripts/copy-code.js"></script>
    <script src="scripts/toc-generator.js"></script>
    <script src="scripts/page-navigation.js"></script>
    <!-- Interactive Diagram Features -->
    <script src="scripts/diagram-data.js"></script>
    <script src="scripts/diagram-interactive.js"></script>

    <script src="scripts/theme-toggle.js"></script>
</body>
</html>
