<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Media Service Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700;900&family=IBM+Plex+Mono:wght@400;500;600&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/design-system.css">

        <style>
        /* Page-specific styles loaded from design-system.css */
    </style>
</head>

<body>
    <nav class="nav">
        <a href="index.html" class="nav-button">
            â† AOSP Media Framework
        </a>
    </nav>

    <div class="container">
        <header>
            <h1 class="page-title">ğŸš— Car Media Service</h1>
            <p class="page-subtitle">Android Automotive OS ë¯¸ë””ì–´ ë° ì˜¤ë””ì˜¤ ê´€ë¦¬ ì•„í‚¤í…ì²˜</p>
        </header>

        <!-- Section 1: Overview -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">1</span>
                Overview: CarMedia vs CarAudio
            </h2>
            <p class="section-description">
                Android Automotive OS (AAOS)ì—ì„œ ë¯¸ë””ì–´ ê²½í—˜ì„ ê´€ë¦¬í•˜ëŠ” ë‘ ê°€ì§€ í•µì‹¬ ì„œë¹„ìŠ¤ì˜ ì—­í• ê³¼ ì°¨ì´ì ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“º</span>
                        CarMediaService
                    </h3>
                    <div class="card-description">
                        <p><strong>"ë¬´ì—‡(What)"ì„ ê´€ë¦¬</strong></p>
                        <ul>
                            <li><strong>Active Media Source</strong>: í˜„ì¬ ì„ íƒëœ ë¯¸ë””ì–´ ì•± ê´€ë¦¬</li>
                            <li><strong>Source Selection</strong>: ì‚¬ìš©ì/ì‹œìŠ¤í…œì— ì˜í•œ ì†ŒìŠ¤ ë³€ê²½ ì¶”ì </li>
                            <li><strong>Resumption</strong>: ì‹œë™ ì¬ì‹œì‘ ì‹œ ì´ì „ ë¯¸ë””ì–´ ë³µì›</li>
                            <li><strong>Browsing</strong>: ë¯¸ë””ì–´ ë¸Œë¼ìš°ì§•ì„ ìœ„í•œ ì—°ê²° ê´€ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”Š</span>
                        CarAudioService
                    </h3>
                    <div class="card-description">
                        <p><strong>"ì–´ë–»ê²Œ(How)"ë¥¼ ê´€ë¦¬</strong></p>
                        <ul>
                            <li><strong>Audio Focus</strong>: ì•± ê°„ ì˜¤ë””ì˜¤ ìš°ì„ ìˆœìœ„ ì¡°ì •</li>
                            <li><strong>Routing</strong>: Zoneë³„ ì˜¤ë””ì˜¤ ì¶œë ¥ ì¥ì¹˜ ê²°ì •</li>
                            <li><strong>Volume Groups</strong>: ì»¨í…ìŠ¤íŠ¸ë³„ ë³¼ë¥¨ ê·¸ë£¹ ê´€ë¦¬</li>
                            <li><strong>Ducking</strong>: ì•ˆë‚´ ë°©ì†¡ ì‹œ ë¯¸ë””ì–´ ë³¼ë¥¨ ìë™ ì¡°ì ˆ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Architecture -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">2</span>
                AAOS Media Architecture
            </h2>
            <p class="section-description">
                CarMediaServiceì™€ CarAudioServiceê°€ í‘œì¤€ Android Media Frameworkì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ì „ì²´ ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph APPS ["Media Applications"]
                    SPOTIFY["Spotify<br />(MediaSession)"]
                    YT["YouTube Music<br />(MediaSession)"]
                    RADIO["Radio App<br />(MediaSession)"]
                    end

                    subgraph CAR_SERVICE ["Car Service (System Server)"]
                    CMS["CarMediaService<br />(Active Source Manager)"]
                    CAS["CarAudioService<br />(Focus & Routing Policy)"]

                    CMS -.->|Tracks| SPOTIFY
                    CMS -.->|Tracks| YT
                    CMS -.->|Tracks| RADIO

                    CAS -.->|Manages Focus| APPS
                    end

                    subgraph ANDROID_FW ["Android Framework"]
                    AUDIO_SVC["AudioService"]
                    MEDIA_SESSION["MediaSessionService"]
                    end

                    subgraph HAL ["Hardware Abstraction Layer"]
                    AUDIO_HAL["Audio HAL<br />(Output Devices)"]
                    VEHICLE_HAL["Vehicle HAL<br />(Events)"]
                    end

                    APPS -->|AudioAttributes| AUDIO_SVC
                    APPS -->|PlaybackState| MEDIA_SESSION

                    CAS -->|Routing Policy| AUDIO_SVC
                    AUDIO_SVC -->|Stream| AUDIO_HAL

                    VEHICLE_HAL -->|User Events| CMS

                    style CMS fill:#1a1f35,stroke:#f59e0b,stroke-width:3px
                    style CAS fill:#1a1f35,stroke:#00d4ff,stroke-width:3px
                    style APPS fill:#0a0e1a,stroke:#10b981,stroke-width:2px
                    style ANDROID_FW fill:#111827,stroke:#6b7280,stroke-width:2px
                    style HAL fill:#0a0e1a,stroke:#7c3aed,stroke-width:2px
                </div>
            </div>
        </section>

        <!-- Section 3: Media Source Management -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">3</span>
                Media Source Management
            </h2>
            <p class="section-description">
                CarMediaServiceê°€ í™œì„± ë¯¸ë””ì–´ ì†ŒìŠ¤ë¥¼ ì„ íƒí•˜ê³  ê´€ë¦¬í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant User
                    participant UI as Car UI (Launcher)
                    participant CMS as CarMediaService
                    participant App as Media App
                    participant Session as MediaSession

                    Note over User,Session: ì†ŒìŠ¤ ë³€ê²½ (Source Selection)
                    User->>UI: ë¯¸ë””ì–´ ì•± ì„ íƒ (Spotify)
                    UI->>CMS: setMediaSource(Spotify)
                    CMS->>CMS: Update Active Source
                    CMS->>UI: onMediaSourceChanged()

                    Note over User,Session: ì¬ìƒ ì¬ê°œ (Resumption)
                    CMS->>App: Start Service / Browse
                    App->>Session: Create Session
                    Session->>CMS: Session Active
                    CMS->>App: Play Command
                    App->>Session: setPlaybackState(PLAYING)
                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¯</span>
                        Active Media Source
                    </h3>
                    <div class="card-description">
                        <p><strong>ë‹¨ì¼ í™œì„± ì†ŒìŠ¤ ê´€ë¦¬</strong></p>
                        <ul>
                            <li>ì‹œìŠ¤í…œ ë‚´ ìœ ì¼í•œ 'í™œì„± ë¯¸ë””ì–´ ì†ŒìŠ¤' ìœ ì§€ (Playback & Browsing)</li>
                            <li>MediaSessionManagerì™€ ë‹¬ë¦¬, ì°¨ëŸ‰ UIì— í‘œì‹œë  <strong>ë‹¨ í•˜ë‚˜ì˜ ì•±</strong>ë§Œ ì¶”ì </li>
                            <li>í˜„ì¬ ì„ íƒëœ ì†ŒìŠ¤ì˜ ComponentName, PlaybackState, íƒ€ì„ìŠ¤íƒ¬í”„ ì €ì¥</li>
                            <li>Media Center ë“± ì‹œìŠ¤í…œ UIëŠ” ì´ ì •ë³´ë¥¼ ì°¸ì¡°í•˜ì—¬ ì»¨í…ì¸  í‘œì‹œ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ‘†</span>
                        Source Selection
                    </h3>
                    <div class="card-description">
                        <p><strong>ì†ŒìŠ¤ ë³€ê²½ ë©”ì»¤ë‹ˆì¦˜</strong></p>
                        <ul>
                            <li><strong>íŠ¸ë¦¬ê±°</strong>: ì‚¬ìš©ì í„°ì¹˜(Launcher), í•˜ë“œì›¨ì–´ ë²„íŠ¼, ìŒì„± ëª…ë ¹</li>
                            <li><strong>í”„ë¡œì„¸ìŠ¤</strong>: <code>setMediaSource()</code> í˜¸ì¶œ â†’ Active Source ì—…ë°ì´íŠ¸ â†’ ì˜µì €ë²„ ì•Œë¦¼
                            </li>
                            <li><code>car-media-common</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ Source Selector Intent ì§€ì›</li>
                            <li>ì†ŒìŠ¤ ë³€ê²½ ì‹œ ì´ì „ ì•±ì€ ì •ì§€(Stop) ë˜ëŠ” ì¼ì‹œì •ì§€ ì²˜ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”„</span>
                        Resumption
                    </h3>
                    <div class="card-description">
                        <p><strong>ì¬ìƒ ë³µì› ë¡œì§</strong></p>
                        <ul>
                            <li>ì°¨ëŸ‰ ì‹œë™(Ignition On) ì‹œ ë§ˆì§€ë§‰ Active Source ìë™ ë³µì›</li>
                            <li>ì•±ì€ <code>onPlaybackResumption()</code> ì½œë°± êµ¬í˜„ í•„ìš”</li>
                            <li><strong>LMS (Last Media Source)</strong> ì •ë³´ë¥¼ Persistent Storageì— ì €ì¥</li>
                            <li>ë¶€íŒ… ì§í›„ ì„œë¹„ìŠ¤ ë°”ì¸ë”© ë° ì„¸ì…˜ ë³µêµ¬ ìˆ˜í–‰</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“‚</span>
                        Browsing
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¸ë””ì–´ íƒìƒ‰ ì—°ê²°</strong></p>
                        <ul>
                            <li>Active Sourceì˜ <code>MediaBrowserService</code>ì— ìë™ ì—°ê²°</li>
                            <li><code>onGetRoot()</code> â†’ <code>onLoadChildren()</code> í˜¸ì¶œë¡œ ì»¨í…ì¸  íŠ¸ë¦¬ êµ¬ì„±</li>
                            <li>ì‹œìŠ¤í…œ UI(Media Center)ê°€ ì•±ì˜ ì»¨í…ì¸ ë¥¼ ëŒ€ì‹  ê·¸ë ¤ì¤Œ</li>
                            <li>ìš´ì „ ì¤‘ ì œí•œ(UX Restrictions)ì— ë”°ë¥¸ ë¦¬ìŠ¤íŠ¸ í•„í„°ë§ ì ìš©</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Audio Focus & Routing -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">4</span>
                Audio Focus & Routing
            </h2>
            <p class="section-description">
                CarAudioServiceê°€ ì˜¤ë””ì˜¤ í¬ì»¤ìŠ¤ë¥¼ ê´€ë¦¬í•˜ê³  ë‹¤ì¤‘ ì¡´(Multi-zone)ìœ¼ë¡œ ë¼ìš°íŒ…í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    flowchart LR
                    subgraph INPUT ["Audio Focus Request"]
                    REQ_MEDIA["Media App<br />(USAGE_MEDIA)"]
                    REQ_NAV["Nav App<br />(USAGE_ASSISTANCE_NAVIGATION)"]
                    REQ_CALL["Phone<br />(USAGE_VOICE_COMMUNICATION)"]
                    end

                    subgraph CAS ["CarAudioService"]
                    MATRIX["Interaction Matrix<br />(Exclusive / Concurrent / Reject)"]
                    ZONES["Zone Manager<br />(Driver / Passenger)"]
                    GROUPS["Volume Groups"]
                    end

                    subgraph OUTPUT ["Audio Output"]
                    SPK_MAIN["Main Speakers"]
                    SPK_NAV["Driver Headrest"]
                    SPK_REAR["Rear Speakers"]
                    end

                    REQ_MEDIA --> MATRIX
                    REQ_NAV --> MATRIX
                    REQ_CALL --> MATRIX

                    MATRIX --> ZONES
                    ZONES --> GROUPS

                    GROUPS -- "Zone 1" --> SPK_MAIN
                    GROUPS -- "Zone 1 (Nav)" --> SPK_NAV
                    GROUPS -- "Zone 2" --> SPK_REAR

                    style CAS fill:#1a1f35,stroke:#00d4ff,stroke-width:3px
                    style MATRIX fill:#111827,stroke:#f59e0b,stroke-width:2px
                    style ZONES fill:#111827,stroke:#10b981,stroke-width:2px
                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ›ï¸</span>
                        Interaction Matrix
                    </h3>
                    <div class="card-description">
                        <p><strong>ì˜¤ë””ì˜¤ ê°„ì„­ ê·œì¹™ ì •ì˜</strong></p>
                        <ul>
                            <li><strong>Exclusive</strong>: í•œ ë²ˆì— í•˜ë‚˜ë§Œ ì¬ìƒ (ì˜ˆ: ìŒì•… vs ìŒì•…)</li>
                            <li><strong>Concurrent</strong>: ë™ì‹œ ì¬ìƒ (ì˜ˆ: ìŒì•… + ë„¤ë¹„ê²Œì´ì…˜)</li>
                            <li><strong>Reject</strong>: ìš”ì²­ ê±°ë¶€ (ì˜ˆ: í†µí™” ì¤‘ ìŒì•… ìš”ì²­)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”‰</span>
                        Ducking & Fading
                    </h3>
                    <div class="card-description">
                        <p><strong>ìë™ ë³¼ë¥¨ ì¡°ì ˆ</strong></p>
                        <ul>
                            <li>ë„¤ë¹„ê²Œì´ì…˜ ì•ˆë‚´ ì‹œ ìŒì•… ë³¼ë¥¨ ìë™ ê°ì†Œ</li>
                            <li>ê¸´ê¸‰ ê²½ë³´ ì‹œ ë‹¤ë¥¸ ëª¨ë“  ì˜¤ë””ì˜¤ ìŒì†Œê±°</li>
                            <li>ë¶€ë“œëŸ¬ìš´ ì „í™˜ì„ ìœ„í•œ Fading ì²˜ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš—</span>
                        Multi-Zone Audio
                    </h3>
                    <div class="card-description">
                        <p><strong>ì¢Œì„ë³„ ë…ë¦½ ì˜¤ë””ì˜¤</strong></p>
                        <ul>
                            <li>ìš´ì „ì„: ë„¤ë¹„ê²Œì´ì…˜ + ë¼ë””ì˜¤</li>
                            <li>ë’·ì¢Œì„: ìœ íŠœë¸Œ í‚¤ì¦ˆ (í—¤ë“œí°)</li>
                            <li>ê° ì¡´(Zone)ë³„ ë…ë¦½ì ì¸ í¬ì»¤ìŠ¤ ë° ë³¼ë¥¨ ê´€ë¦¬</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer
            style="text-align: center; padding: 40px 20px; color: var(--text-muted); border-top: 1px solid var(--border-color); margin-top: 60px;">
            <p>Android Automotive OS Media Architecture</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                CarMediaService & CarAudioService Deep Dive
            </p>
            <p style="margin-top: 20px;">
                <a href="index.html" style="color: var(--accent-car); text-decoration: none;">
                    â† AOSP Media Frameworkë¡œ ëŒì•„ê°€ê¸°
                </a>
            </p>
        </footer>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#1a1f35',
                primaryTextColor: '#e5e7eb',
                primaryBorderColor: '#f59e0b',
                lineColor: '#7c3aed',
                secondaryColor: '#111827',
                tertiaryColor: '#0a0e1a',
                background: '#0a0e1a',
                mainBkg: '#1a1f35',
                secondBkg: '#111827',
                border1: '#f59e0b',
                border2: '#00d4ff',
                note: '#ec4899',
                noteBkgColor: 'rgba(236, 72, 153, 0.1)',
                noteBorderColor: '#ec4899',
                fontFamily: 'Noto Sans KR'
            },
            flowchart: {
                curve: 'basis',
                padding: 20,
                nodeSpacing: 50,
                rankSpacing: 50
            },
            sequence: {
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35
            }
        });

        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(30px)';
            section.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
            observer.observe(section);
        });
    </script>
    <script src="scripts/theme-toggle.js"></script>
</body>

</html>