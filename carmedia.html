<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Media Service Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700;900&family=IBM+Plex+Mono:wght@400;500;600&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/design-system.css">

        <style>
        /* Page-specific styles loaded from design-system.css */
    </style>
</head>

<body>
    <nav class="nav">
        <a href="index.html" class="nav-button">
            â† AOSP Media Framework
        </a>
    </nav>

    <div class="container">
        <header>
            <h1 class="page-title">ğŸš— Car Media Service</h1>
            <p class="page-subtitle">Android Automotive OS ë¯¸ë””ì–´ ë° ì˜¤ë””ì˜¤ ê´€ë¦¬ ì•„í‚¤í…ì²˜</p>
        </header>

        <!-- Section 1: Overview -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">1</span>
                Overview: CarMedia vs CarAudio
            </h2>
            <p class="section-description">
                Android Automotive OS (AAOS)ì—ì„œ ë¯¸ë””ì–´ ê²½í—˜ì„ ê´€ë¦¬í•˜ëŠ” ë‘ ê°€ì§€ í•µì‹¬ ì„œë¹„ìŠ¤ì˜ ì—­í• ê³¼ ì°¨ì´ì ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“º</span>
                        CarMediaService
                    </h3>
                    <div class="card-description">
                        <p><strong>"ë¬´ì—‡(What)"ì„ ê´€ë¦¬</strong></p>
                        <ul>
                            <li><strong>Active Media Source</strong>: í˜„ì¬ ì„ íƒëœ ë¯¸ë””ì–´ ì•± ê´€ë¦¬</li>
                            <li><strong>Source Selection</strong>: ì‚¬ìš©ì/ì‹œìŠ¤í…œì— ì˜í•œ ì†ŒìŠ¤ ë³€ê²½ ì¶”ì </li>
                            <li><strong>Resumption</strong>: ì‹œë™ ì¬ì‹œì‘ ì‹œ ì´ì „ ë¯¸ë””ì–´ ë³µì›</li>
                            <li><strong>Browsing</strong>: ë¯¸ë””ì–´ ë¸Œë¼ìš°ì§•ì„ ìœ„í•œ ì—°ê²° ê´€ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”Š</span>
                        CarAudioService
                    </h3>
                    <div class="card-description">
                        <p><strong>"ì–´ë–»ê²Œ(How)"ë¥¼ ê´€ë¦¬</strong></p>
                        <ul>
                            <li><strong>Audio Focus</strong>: ì•± ê°„ ì˜¤ë””ì˜¤ ìš°ì„ ìˆœìœ„ ì¡°ì •</li>
                            <li><strong>Routing</strong>: Zoneë³„ ì˜¤ë””ì˜¤ ì¶œë ¥ ì¥ì¹˜ ê²°ì •</li>
                            <li><strong>Volume Groups</strong>: ì»¨í…ìŠ¤íŠ¸ë³„ ë³¼ë¥¨ ê·¸ë£¹ ê´€ë¦¬</li>
                            <li><strong>Ducking</strong>: ì•ˆë‚´ ë°©ì†¡ ì‹œ ë¯¸ë””ì–´ ë³¼ë¥¨ ìë™ ì¡°ì ˆ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Architecture -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">2</span>
                AAOS Media Architecture
            </h2>
            <p class="section-description">
                CarMediaServiceì™€ CarAudioServiceê°€ í‘œì¤€ Android Media Frameworkì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ì „ì²´ ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph APPS ["Media Applications"]
                    SPOTIFY["Spotify<br />(MediaSession)"]
                    YT["YouTube Music<br />(MediaSession)"]
                    RADIO["Radio App<br />(MediaSession)"]
                    end

                    subgraph CAR_SERVICE ["Car Service (System Server)"]
                    CMS["CarMediaService<br />(Active Source Manager)"]
                    CAS["CarAudioService<br />(Focus & Routing Policy)"]

                    CMS -.->|Tracks| SPOTIFY
                    CMS -.->|Tracks| YT
                    CMS -.->|Tracks| RADIO

                    CAS -.->|Manages Focus| APPS
                    end

                    subgraph ANDROID_FW ["Android Framework"]
                    AUDIO_SVC["AudioService"]
                    MEDIA_SESSION["MediaSessionService"]
                    end

                    subgraph HAL ["Hardware Abstraction Layer"]
                    AUDIO_HAL["Audio HAL<br />(Output Devices)"]
                    VEHICLE_HAL["Vehicle HAL<br />(Events)"]
                    end

                    APPS -->|AudioAttributes| AUDIO_SVC
                    APPS -->|PlaybackState| MEDIA_SESSION

                    CAS -->|Routing Policy| AUDIO_SVC
                    AUDIO_SVC -->|Stream| AUDIO_HAL

                    VEHICLE_HAL -->|User Events| CMS

                </div>
            </div>
        </section>

        <!-- Section 3: Media Source Management -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">3</span>
                Media Source Management
            </h2>
            <p class="section-description">
                CarMediaServiceê°€ í™œì„± ë¯¸ë””ì–´ ì†ŒìŠ¤ë¥¼ ì„ íƒí•˜ê³  ê´€ë¦¬í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant User
                    participant UI as Car UI (Launcher)
                    participant CMS as CarMediaService
                    participant App as Media App
                    participant Session as MediaSession

                    Note over User,Session: ì†ŒìŠ¤ ë³€ê²½ (Source Selection)
                    User->>UI: ë¯¸ë””ì–´ ì•± ì„ íƒ (Spotify)
                    UI->>CMS: setMediaSource(Spotify)
                    CMS->>CMS: Update Active Source
                    CMS->>UI: onMediaSourceChanged()

                    Note over User,Session: ì¬ìƒ ì¬ê°œ (Resumption)
                    CMS->>App: Start Service / Browse
                    App->>Session: Create Session
                    Session->>CMS: Session Active
                    CMS->>App: Play Command
                    App->>Session: setPlaybackState(PLAYING)
                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¯</span>
                        Active Media Source
                    </h3>
                    <div class="card-description">
                        <p><strong>ë‹¨ì¼ í™œì„± ì†ŒìŠ¤ ê´€ë¦¬</strong></p>
                        <ul>
                            <li>ì‹œìŠ¤í…œ ë‚´ ìœ ì¼í•œ 'í™œì„± ë¯¸ë””ì–´ ì†ŒìŠ¤' ìœ ì§€ (Playback & Browsing)</li>
                            <li>MediaSessionManagerì™€ ë‹¬ë¦¬, ì°¨ëŸ‰ UIì— í‘œì‹œë  <strong>ë‹¨ í•˜ë‚˜ì˜ ì•±</strong>ë§Œ ì¶”ì </li>
                            <li>í˜„ì¬ ì„ íƒëœ ì†ŒìŠ¤ì˜ ComponentName, PlaybackState, íƒ€ì„ìŠ¤íƒ¬í”„ ì €ì¥</li>
                            <li>Media Center ë“± ì‹œìŠ¤í…œ UIëŠ” ì´ ì •ë³´ë¥¼ ì°¸ì¡°í•˜ì—¬ ì»¨í…ì¸  í‘œì‹œ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ‘†</span>
                        Source Selection
                    </h3>
                    <div class="card-description">
                        <p><strong>ì†ŒìŠ¤ ë³€ê²½ ë©”ì»¤ë‹ˆì¦˜</strong></p>
                        <ul>
                            <li><strong>íŠ¸ë¦¬ê±°</strong>: ì‚¬ìš©ì í„°ì¹˜(Launcher), í•˜ë“œì›¨ì–´ ë²„íŠ¼, ìŒì„± ëª…ë ¹</li>
                            <li><strong>í”„ë¡œì„¸ìŠ¤</strong>: <code>setMediaSource()</code> í˜¸ì¶œ â†’ Active Source ì—…ë°ì´íŠ¸ â†’ ì˜µì €ë²„ ì•Œë¦¼
                            </li>
                            <li><code>car-media-common</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ Source Selector Intent ì§€ì›</li>
                            <li>ì†ŒìŠ¤ ë³€ê²½ ì‹œ ì´ì „ ì•±ì€ ì •ì§€(Stop) ë˜ëŠ” ì¼ì‹œì •ì§€ ì²˜ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”„</span>
                        Resumption
                    </h3>
                    <div class="card-description">
                        <p><strong>ì¬ìƒ ë³µì› ë¡œì§</strong></p>
                        <ul>
                            <li>ì°¨ëŸ‰ ì‹œë™(Ignition On) ì‹œ ë§ˆì§€ë§‰ Active Source ìë™ ë³µì›</li>
                            <li>ì•±ì€ <code>onPlaybackResumption()</code> ì½œë°± êµ¬í˜„ í•„ìš”</li>
                            <li><strong>LMS (Last Media Source)</strong> ì •ë³´ë¥¼ Persistent Storageì— ì €ì¥</li>
                            <li>ë¶€íŒ… ì§í›„ ì„œë¹„ìŠ¤ ë°”ì¸ë”© ë° ì„¸ì…˜ ë³µêµ¬ ìˆ˜í–‰</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“‚</span>
                        Browsing
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¸ë””ì–´ íƒìƒ‰ ì—°ê²°</strong></p>
                        <ul>
                            <li>Active Sourceì˜ <code>MediaBrowserService</code>ì— ìë™ ì—°ê²°</li>
                            <li><code>onGetRoot()</code> â†’ <code>onLoadChildren()</code> í˜¸ì¶œë¡œ ì»¨í…ì¸  íŠ¸ë¦¬ êµ¬ì„±</li>
                            <li>ì‹œìŠ¤í…œ UI(Media Center)ê°€ ì•±ì˜ ì»¨í…ì¸ ë¥¼ ëŒ€ì‹  ê·¸ë ¤ì¤Œ</li>
                            <li>ìš´ì „ ì¤‘ ì œí•œ(UX Restrictions)ì— ë”°ë¥¸ ë¦¬ìŠ¤íŠ¸ í•„í„°ë§ ì ìš©</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Audio Focus & Routing -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">4</span>
                Audio Focus & Routing
            </h2>
            <p class="section-description">
                CarAudioServiceê°€ ì˜¤ë””ì˜¤ í¬ì»¤ìŠ¤ë¥¼ ê´€ë¦¬í•˜ê³  ë‹¤ì¤‘ ì¡´(Multi-zone)ìœ¼ë¡œ ë¼ìš°íŒ…í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    flowchart LR
                    subgraph INPUT ["Audio Focus Request"]
                    REQ_MEDIA["Media App<br />(USAGE_MEDIA)"]
                    REQ_NAV["Nav App<br />(USAGE_ASSISTANCE_NAVIGATION)"]
                    REQ_CALL["Phone<br />(USAGE_VOICE_COMMUNICATION)"]
                    end

                    subgraph CAS ["CarAudioService"]
                    MATRIX["Interaction Matrix<br />(Exclusive / Concurrent / Reject)"]
                    ZONES["Zone Manager<br />(Driver / Passenger)"]
                    GROUPS["Volume Groups"]
                    end

                    subgraph OUTPUT ["Audio Output"]
                    SPK_MAIN["Main Speakers"]
                    SPK_NAV["Driver Headrest"]
                    SPK_REAR["Rear Speakers"]
                    end

                    REQ_MEDIA --> MATRIX
                    REQ_NAV --> MATRIX
                    REQ_CALL --> MATRIX

                    MATRIX --> ZONES
                    ZONES --> GROUPS

                    GROUPS -- "Zone 1" --> SPK_MAIN
                    GROUPS -- "Zone 1 (Nav)" --> SPK_NAV
                    GROUPS -- "Zone 2" --> SPK_REAR

                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ›ï¸</span>
                        Interaction Matrix
                    </h3>
                    <div class="card-description">
                        <p><strong>ì˜¤ë””ì˜¤ ê°„ì„­ ê·œì¹™ ì •ì˜</strong></p>
                        <ul>
                            <li><strong>Exclusive</strong>: í•œ ë²ˆì— í•˜ë‚˜ë§Œ ì¬ìƒ (ì˜ˆ: ìŒì•… vs ìŒì•…)</li>
                            <li><strong>Concurrent</strong>: ë™ì‹œ ì¬ìƒ (ì˜ˆ: ìŒì•… + ë„¤ë¹„ê²Œì´ì…˜)</li>
                            <li><strong>Reject</strong>: ìš”ì²­ ê±°ë¶€ (ì˜ˆ: í†µí™” ì¤‘ ìŒì•… ìš”ì²­)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”‰</span>
                        Ducking & Fading
                    </h3>
                    <div class="card-description">
                        <p><strong>ìë™ ë³¼ë¥¨ ì¡°ì ˆ</strong></p>
                        <ul>
                            <li>ë„¤ë¹„ê²Œì´ì…˜ ì•ˆë‚´ ì‹œ ìŒì•… ë³¼ë¥¨ ìë™ ê°ì†Œ</li>
                            <li>ê¸´ê¸‰ ê²½ë³´ ì‹œ ë‹¤ë¥¸ ëª¨ë“  ì˜¤ë””ì˜¤ ìŒì†Œê±°</li>
                            <li>ë¶€ë“œëŸ¬ìš´ ì „í™˜ì„ ìœ„í•œ Fading ì²˜ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš—</span>
                        Multi-Zone Audio
                    </h3>
                    <div class="card-description">
                        <p><strong>ì¢Œì„ë³„ ë…ë¦½ ì˜¤ë””ì˜¤</strong></p>
                        <ul>
                            <li>ìš´ì „ì„: ë„¤ë¹„ê²Œì´ì…˜ + ë¼ë””ì˜¤</li>
                            <li>ë’·ì¢Œì„: ìœ íŠœë¸Œ í‚¤ì¦ˆ (í—¤ë“œí°)</li>
                            <li>ê° ì¡´(Zone)ë³„ ë…ë¦½ì ì¸ í¬ì»¤ìŠ¤ ë° ë³¼ë¥¨ ê´€ë¦¬</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: Code Examples -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">5</span>
                ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ
            </h2>
            <p class="section-description">
                CarMediaService API ë° MediaBrowserServiceë¥¼ ì‚¬ìš©í•œ ì‹¤ì œ êµ¬í˜„ ì˜ˆì‹œì…ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“± Active Media Source ë³€ê²½</h3>
            <div class="code-block">
                <pre><code>// CarMediaService APIë¡œ í™œì„± ë¯¸ë””ì–´ ì†ŒìŠ¤ ë³€ê²½
class MediaSourceSwitcher(private val context: Context) {
    private lateinit var carMediaManager: CarMediaManager

    fun initialize() {
        val car = Car.createCar(context)
        carMediaManager = car.getCarManager(Car.CAR_MEDIA_SERVICE) as CarMediaManager

        // ë¯¸ë””ì–´ ì†ŒìŠ¤ ë³€ê²½ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        carMediaManager.addMediaSourceListener(mediaSourceListener)
    }

    private val mediaSourceListener = object : CarMediaManager.MediaSourceChangedListener {
        override fun onMediaSourceChanged(componentName: ComponentName) {
            Log.d("CarMedia", "Active source changed to: ${componentName.packageName}")

            // UI ì—…ë°ì´íŠ¸
            updateMediaUI(componentName)
        }
    }

    // íŠ¹ì • ë¯¸ë””ì–´ ì•±ìœ¼ë¡œ ì†ŒìŠ¤ ë³€ê²½
    fun switchToSpotify() {
        val spotifyComponent = ComponentName(
            "com.spotify.music",
            "com.spotify.music.MainActivity"
        )

        // CarMediaServiceì— ì†ŒìŠ¤ ë³€ê²½ ìš”ì²­
        carMediaManager.setMediaSource(spotifyComponent, CarMediaManager.MEDIA_SOURCE_MODE_PLAYBACK)

        Log.d("CarMedia", "Switched to Spotify")
    }

    // í˜„ì¬ í™œì„± ì†ŒìŠ¤ ì¡°íšŒ
    fun getCurrentSource(): ComponentName? {
        return carMediaManager.mediaSource
    }

    // ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ë¯¸ë””ì–´ ì†ŒìŠ¤ ì¡°íšŒ
    fun getAvailableSources(): List&lt;ComponentName&gt; {
        return carMediaManager.getLastMediaSources(CarMediaManager.MEDIA_SOURCE_MODE_PLAYBACK)
    }

    fun release() {
        carMediaManager.removeMediaSourceListener(mediaSourceListener)
    }
}</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸµ ê°„ë‹¨í•œ MediaBrowserService êµ¬í˜„</h3>
            <div class="code-block">
                <pre><code>// ì°¨ëŸ‰ìš© ë¯¸ë””ì–´ ì•±ì„ ìœ„í•œ MediaBrowserService
class CarMusicService : MediaBrowserServiceCompat() {
    private lateinit var mediaSession: MediaSessionCompat
    private lateinit var player: MediaPlayer

    override fun onCreate() {
        super.onCreate()

        // MediaSession ìƒì„±
        mediaSession = MediaSessionCompat(this, "CarMusicService").apply {
            setFlags(MediaSessionCompat.FLAG_HANDLES_MEDIA_BUTTONS or
                     MediaSessionCompat.FLAG_HANDLES_TRANSPORT_CONTROLS)

            setCallback(mediaSessionCallback)

            // PlaybackState ì´ˆê¸°í™”
            setPlaybackState(PlaybackStateCompat.Builder()
                .setActions(PlaybackStateCompat.ACTION_PLAY or
                           PlaybackStateCompat.ACTION_PAUSE or
                           PlaybackStateCompat.ACTION_SKIP_TO_NEXT)
                .setState(PlaybackStateCompat.STATE_NONE, 0, 1.0f)
                .build())

            isActive = true
        }

        sessionToken = mediaSession.sessionToken
    }

    // í´ë¼ì´ì–¸íŠ¸ ì—°ê²° í—ˆìš© ì¡°ê±´
    override fun onGetRoot(
        clientPackageName: String,
        clientUid: Int,
        rootHints: Bundle?
    ): BrowserRoot? {
        // ì°¨ëŸ‰ ì‹œìŠ¤í…œ UIë§Œ ì—°ê²° í—ˆìš©
        if (clientPackageName.startsWith("com.android.car")) {
            return BrowserRoot("root", null)
        }
        return null
    }

    // ë¯¸ë””ì–´ ì»¨í…ì¸  ì œê³µ
    override fun onLoadChildren(
        parentId: String,
        result: Result&lt;List&lt;MediaBrowserCompat.MediaItem&gt;&gt;
    ) {
        val mediaItems = mutableListOf&lt;MediaBrowserCompat.MediaItem&gt;()

        when (parentId) {
            "root" -> {
                // ìµœìƒìœ„ ë©”ë‰´: ë¼ì´ë¸ŒëŸ¬ë¦¬, í”Œë ˆì´ë¦¬ìŠ¤íŠ¸, ìµœê·¼ ì¬ìƒ
                mediaItems.add(createBrowsableItem("library", "ë‚´ ë¼ì´ë¸ŒëŸ¬ë¦¬"))
                mediaItems.add(createBrowsableItem("playlists", "í”Œë ˆì´ë¦¬ìŠ¤íŠ¸"))
                mediaItems.add(createBrowsableItem("recents", "ìµœê·¼ ì¬ìƒ"))
            }

            "library" -> {
                // ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‚´ ê³¡ ëª©ë¡
                mediaItems.add(createPlayableItem("song1", "Song 1", "Artist 1"))
                mediaItems.add(createPlayableItem("song2", "Song 2", "Artist 2"))
                mediaItems.add(createPlayableItem("song3", "Song 3", "Artist 3"))
            }

            "playlists" -> {
                // í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ëª©ë¡
                mediaItems.add(createBrowsableItem("playlist1", "My Favorites"))
                mediaItems.add(createBrowsableItem("playlist2", "Road Trip"))
            }
        }

        result.sendResult(mediaItems)
    }

    private fun createBrowsableItem(id: String, title: String): MediaBrowserCompat.MediaItem {
        val mediaDescription = MediaDescriptionCompat.Builder()
            .setMediaId(id)
            .setTitle(title)
            .build()

        return MediaBrowserCompat.MediaItem(
            mediaDescription,
            MediaBrowserCompat.MediaItem.FLAG_BROWSABLE
        )
    }

    private fun createPlayableItem(
        id: String,
        title: String,
        artist: String
    ): MediaBrowserCompat.MediaItem {
        val mediaDescription = MediaDescriptionCompat.Builder()
            .setMediaId(id)
            .setTitle(title)
            .setSubtitle(artist)
            .build()

        return MediaBrowserCompat.MediaItem(
            mediaDescription,
            MediaBrowserCompat.MediaItem.FLAG_PLAYABLE
        )
    }

    private val mediaSessionCallback = object : MediaSessionCompat.Callback() {
        override fun onPlay() {
            // Audio Focus ìš”ì²­
            requestAudioFocus()

            // ì¬ìƒ ì‹œì‘
            player.start()

            // PlaybackState ì—…ë°ì´íŠ¸
            updatePlaybackState(PlaybackStateCompat.STATE_PLAYING)
        }

        override fun onPause() {
            player.pause()
            updatePlaybackState(PlaybackStateCompat.STATE_PAUSED)
        }

        override fun onPlayFromMediaId(mediaId: String, extras: Bundle?) {
            // íŠ¹ì • ê³¡ ì¬ìƒ
            loadAndPlayTrack(mediaId)
        }
    }

    private fun updatePlaybackState(state: Int) {
        val position = if (::player.isInitialized) player.currentPosition.toLong() else 0

        mediaSession.setPlaybackState(PlaybackStateCompat.Builder()
            .setState(state, position, 1.0f)
            .setActions(PlaybackStateCompat.ACTION_PLAY or
                       PlaybackStateCompat.ACTION_PAUSE or
                       PlaybackStateCompat.ACTION_SKIP_TO_NEXT)
            .build())
    }

    override fun onDestroy() {
        mediaSession.release()
        super.onDestroy()
    }
}</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ”Š Audio Focus ì°¨ëŸ‰ìš© ê´€ë¦¬</h3>
            <div class="code-block">
                <pre><code>// ì°¨ëŸ‰ í™˜ê²½ì—ì„œ Audio Focus ìš”ì²­
class CarAudioFocusManager(private val context: Context) {
    private val audioManager = context.getSystemService(Context.AUDIO_SERVICE) as AudioManager
    private var audioFocusRequest: AudioFocusRequest? = null

    fun requestFocusForMusic(): Boolean {
        val audioAttributes = AudioAttributes.Builder()
            .setUsage(AudioAttributes.USAGE_MEDIA)
            .setContentType(AudioAttributes.CONTENT_TYPE_MUSIC)
            .build()

        audioFocusRequest = AudioFocusRequest.Builder(AudioManager.AUDIOFOCUS_GAIN)
            .setAudioAttributes(audioAttributes)
            .setOnAudioFocusChangeListener(focusChangeListener)
            .setAcceptsDelayedFocusGain(true)  // ì°¨ëŸ‰ì—ì„œ ì¤‘ìš”: ì§€ì—°ëœ í¬ì»¤ìŠ¤ í—ˆìš©
            .build()

        val result = audioManager.requestAudioFocus(audioFocusRequest!!)
        return result == AudioManager.AUDIOFOCUS_REQUEST_GRANTED
    }

    fun requestFocusForNavigation(): Boolean {
        val audioAttributes = AudioAttributes.Builder()
            .setUsage(AudioAttributes.USAGE_ASSISTANCE_NAVIGATION_GUIDANCE)
            .setContentType(AudioAttributes.CONTENT_TYPE_SPEECH)
            .build()

        audioFocusRequest = AudioFocusRequest.Builder(AudioManager.AUDIOFOCUS_GAIN_TRANSIENT_MAY_DUCK)
            .setAudioAttributes(audioAttributes)
            .setOnAudioFocusChangeListener(focusChangeListener)
            .build()

        val result = audioManager.requestAudioFocus(audioFocusRequest!!)
        return result == AudioManager.AUDIOFOCUS_REQUEST_GRANTED
    }

    private val focusChangeListener = AudioManager.OnAudioFocusChangeListener { focusChange ->
        when (focusChange) {
            AudioManager.AUDIOFOCUS_GAIN -> {
                Log.d("CarAudio", "Focus gained")
                // ì¬ìƒ ì¬ê°œ
            }

            AudioManager.AUDIOFOCUS_LOSS -> {
                Log.d("CarAudio", "Focus lost permanently")
                // ì¬ìƒ ì •ì§€
            }

            AudioManager.AUDIOFOCUS_LOSS_TRANSIENT -> {
                Log.d("CarAudio", "Focus lost temporarily")
                // ì¼ì‹œ ì •ì§€
            }

            AudioManager.AUDIOFOCUS_LOSS_TRANSIENT_CAN_DUCK -> {
                Log.d("CarAudio", "Ducking (volume down)")
                // ë³¼ë¥¨ ê°ì†Œ (20%)
            }
        }
    }

    fun abandonFocus() {
        audioFocusRequest?.let {
            audioManager.abandonAudioFocusRequest(it)
        }
    }
}</code></pre>
            </div>
        </section>

        <!-- Section 6: MediaBrowserService Implementation -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">6</span>
                MediaBrowserService ì°¨ëŸ‰ìš© êµ¬í˜„
            </h2>
            <p class="section-description">
                AAOS í™˜ê²½ì—ì„œ ìµœì í™”ëœ MediaBrowserService êµ¬í˜„ ê°€ì´ë“œì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¯</span>
                        ì°¨ëŸ‰ìš© ìš”êµ¬ì‚¬í•­
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>Distraction Optimization</strong>: ìš´ì „ ì¤‘ ì•ˆì „ ê³ ë ¤</li>
                            <li><strong>ê¹Šì´ ì œí•œ</strong>: ë©”ë‰´ ê¹Šì´ ìµœëŒ€ 2-3ë‹¨ê³„</li>
                            <li><strong>ë¦¬ìŠ¤íŠ¸ í¬ê¸°</strong>: í•­ëª© ê°œìˆ˜ ì œí•œ (ê¶Œì¥: 6-12ê°œ)</li>
                            <li><strong>ë¹ ë¥¸ ì‘ë‹µ</strong>: onLoadChildren() 1ì´ˆ ì´ë‚´</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ–¼ï¸</span>
                        ë©”íƒ€ë°ì´í„° ìµœì í™”
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>ì•„ì´ì½˜</strong>: ì ì ˆí•œ í¬ê¸° ì œê³µ (512x512)</li>
                            <li><strong>ì œëª©/ë¶€ì œ</strong>: ê°„ê²°í•˜ê³  ëª…í™•í•˜ê²Œ</li>
                            <li><strong>ì•¨ë²” ì•„íŠ¸</strong>: ë¡œì»¬ ìºì‹± í™œìš©</li>
                            <li><strong>ì¬ìƒ ì§„í–‰</strong>: ì •í™•í•œ position ì—…ë°ì´íŠ¸</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>onGetRoot()</strong>: ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” í´ë¼ì´ì–¸íŠ¸ë§Œ í—ˆìš©</li>
                            <li><strong>íŒ¨í‚¤ì§€ ê²€ì¦</strong>: ì‹œìŠ¤í…œ ì•± í™•ì¸</li>
                            <li><strong>ê¶Œí•œ í™•ì¸</strong>: ì‚¬ìš©ì ë™ì˜ í•„ìš” ì‹œ</li>
                            <li><strong>ë°ì´í„° ë³´í˜¸</strong>: ë¯¼ê° ì •ë³´ ë…¸ì¶œ ë°©ì§€</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“‹ ì°¨ëŸ‰ ìµœì í™” MediaBrowserService</h3>
            <div class="code-block">
                <pre><code>// ì°¨ëŸ‰ í™˜ê²½ì— ìµœì í™”ëœ MediaBrowserService êµ¬í˜„
class OptimizedCarMediaService : MediaBrowserServiceCompat() {

    companion object {
        const val MAX_SEARCH_RESULTS = 6  // ê²€ìƒ‰ ê²°ê³¼ ìµœëŒ€ ê°œìˆ˜
        const val MAX_LIST_ITEMS = 12     // ë¦¬ìŠ¤íŠ¸ í•­ëª© ìµœëŒ€ ê°œìˆ˜
        const val MAX_MENU_DEPTH = 3      // ë©”ë‰´ ê¹Šì´ ì œí•œ
    }

    override fun onGetRoot(
        clientPackageName: String,
        clientUid: Int,
        rootHints: Bundle?
    ): BrowserRoot? {
        // 1. ì°¨ëŸ‰ ì‹œìŠ¤í…œ ì•±ë§Œ í—ˆìš©
        if (!isAuthorizedClient(clientPackageName)) {
            Log.w("CarMedia", "Unauthorized client: $clientPackageName")
            return null
        }

        // 2. UX Restrictions í™•ì¸
        val extras = Bundle().apply {
            putBoolean(
                "android.media.browse.CONTENT_STYLE_SUPPORTED",
                true
            )
            putInt(
                "android.media.browse.CONTENT_STYLE_BROWSABLE_HINT",
                CONTENT_STYLE_GRID_ITEM_HINT_VALUE
            )
            putInt(
                "android.media.browse.CONTENT_STYLE_PLAYABLE_HINT",
                CONTENT_STYLE_LIST_ITEM_HINT_VALUE
            )
        }

        return BrowserRoot("__ROOT__", extras)
    }

    private fun isAuthorizedClient(packageName: String): Boolean {
        // ì°¨ëŸ‰ ì‹œìŠ¤í…œ ì•± í™•ì¸
        return packageName.startsWith("com.android.car") ||
               packageName == "com.google.android.gms" ||
               packageName == "com.google.android.projection.gearhead"
    }

    override fun onLoadChildren(
        parentId: String,
        result: Result&lt;List&lt;MediaBrowserCompat.MediaItem&gt;&gt;
    ) {
        // ë¹„ë™ê¸° ë¡œë”© (1ì´ˆ ì´ë‚´ ì™„ë£Œ ëª©í‘œ)
        result.detach()

        Thread {
            val items = loadMediaItems(parentId)
            result.sendResult(items)
        }.start()
    }

    private fun loadMediaItems(parentId: String): List&lt;MediaBrowserCompat.MediaItem&gt; {
        val items = mutableListOf&lt;MediaBrowserCompat.MediaItem&gt;()

        when (parentId) {
            "__ROOT__" -> {
                // ìµœìƒìœ„ ë©”ë‰´ (ê¹Šì´ 1)
                items.add(createTab("recents", "ìµœê·¼ ì¬ìƒ", R.drawable.ic_recent))
                items.add(createTab("library", "ë‚´ ë¼ì´ë¸ŒëŸ¬ë¦¬", R.drawable.ic_library))
                items.add(createTab("playlists", "í”Œë ˆì´ë¦¬ìŠ¤íŠ¸", R.drawable.ic_playlist))
                items.add(createTab("radio", "ë¼ë””ì˜¤", R.drawable.ic_radio))
            }

            "recents" -> {
                // ìµœê·¼ ì¬ìƒ ëª©ë¡ (ê¹Šì´ 2)
                val recentTracks = getRecentTracks()
                items.addAll(recentTracks.take(MAX_LIST_ITEMS))
            }

            "library" -> {
                // ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¹´í…Œê³ ë¦¬ (ê¹Šì´ 2)
                items.add(createTab("library_songs", "ê³¡", R.drawable.ic_song))
                items.add(createTab("library_albums", "ì•¨ë²”", R.drawable.ic_album))
                items.add(createTab("library_artists", "ì•„í‹°ìŠ¤íŠ¸", R.drawable.ic_artist))
            }

            "library_songs" -> {
                // ì „ì²´ ê³¡ ëª©ë¡ (ê¹Šì´ 3 - ìµœëŒ€)
                val songs = getAllSongs()
                items.addAll(songs.take(MAX_LIST_ITEMS))
            }
        }

        return items
    }

    private fun createTab(
        mediaId: String,
        title: String,
        iconRes: Int
    ): MediaBrowserCompat.MediaItem {
        val description = MediaDescriptionCompat.Builder()
            .setMediaId(mediaId)
            .setTitle(title)
            .setIconUri(Uri.parse("android.resource://$packageName/$iconRes"))
            .build()

        return MediaBrowserCompat.MediaItem(
            description,
            MediaBrowserCompat.MediaItem.FLAG_BROWSABLE
        )
    }

    // ê²€ìƒ‰ ê¸°ëŠ¥ (ì„ íƒì‚¬í•­)
    override fun onSearch(
        query: String,
        extras: Bundle?,
        result: Result&lt;List&lt;MediaBrowserCompat.MediaItem&gt;&gt;
    ) {
        result.detach()

        Thread {
            val searchResults = performSearch(query)
            // ê²€ìƒ‰ ê²°ê³¼ ì œí•œ
            result.sendResult(searchResults.take(MAX_SEARCH_RESULTS))
        }.start()
    }

    // Custom Action ì§€ì› (ì˜ˆ: Shuffle All)
    override fun onCustomAction(
        action: String,
        extras: Bundle?,
        result: Result&lt;Bundle&gt;
    ) {
        when (action) {
            "SHUFFLE_ALL" -> {
                shuffleAllTracks()
                result.sendResult(Bundle())
            }
            else -> {
                result.sendError(Bundle())
            }
        }
    }
}</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“Š ì°¨ëŸ‰ìš© ì»¨í…ì¸  êµ¬ì¡° ê¶Œì¥ì‚¬í•­</h3>
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>í•­ëª©</th>
                            <th>ê¶Œì¥ê°’</th>
                            <th>ì´ìœ </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ë©”ë‰´ ê¹Šì´</td>
                            <td>ìµœëŒ€ 3ë‹¨ê³„</td>
                            <td>ìš´ì „ ì¤‘ ì§‘ì¤‘ë ¥ ë¶„ì‚° ìµœì†Œí™”</td>
                        </tr>
                        <tr>
                            <td>ë¦¬ìŠ¤íŠ¸ í•­ëª©</td>
                            <td>6-12ê°œ</td>
                            <td>ìŠ¤í¬ë¡¤ ìµœì†Œí™”, í•œëˆˆì— íŒŒì•…</td>
                        </tr>
                        <tr>
                            <td>ê²€ìƒ‰ ê²°ê³¼</td>
                            <td>ìµœëŒ€ 6ê°œ</td>
                            <td>ë¹ ë¥¸ ì„ íƒ ê°€ëŠ¥</td>
                        </tr>
                        <tr>
                            <td>ì•„ì´ì½˜ í¬ê¸°</td>
                            <td>512x512px</td>
                            <td>ê³ í•´ìƒë„ ë””ìŠ¤í”Œë ˆì´ ëŒ€ì‘</td>
                        </tr>
                        <tr>
                            <td>ë¡œë”© ì‹œê°„</td>
                            <td>1ì´ˆ ì´ë‚´</td>
                            <td>ì‚¬ìš©ì ëŒ€ê¸° ì‹œê°„ ìµœì†Œí™”</td>
                        </tr>
                        <tr>
                            <td>ì œëª© ê¸¸ì´</td>
                            <td>ìµœëŒ€ 20ì</td>
                            <td>UI ë ˆì´ì•„ì›ƒ ê¹¨ì§ ë°©ì§€</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 7: Interaction Matrix Details -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">7</span>
                Interaction Matrix ìƒì„¸
            </h2>
            <p class="section-description">
                CarAudioServiceê°€ ì‚¬ìš©í•˜ëŠ” ì˜¤ë””ì˜¤ í¬ì»¤ìŠ¤ ìƒí˜¸ì‘ìš© ê·œì¹™ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ›ï¸</span>
                        Interaction Types
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>EXCLUSIVE</strong>: í•œ ë²ˆì— í•˜ë‚˜ë§Œ (ì˜ˆ: Music vs Music)</li>
                            <li><strong>CONCURRENT</strong>: ë™ì‹œ ì¬ìƒ (ì˜ˆ: Music + Nav)</li>
                            <li><strong>REJECT</strong>: ìš”ì²­ ê±°ë¶€ (ì˜ˆ: Call ì¤‘ Music)</li>
                            <li><strong>DUCK</strong>: ë³¼ë¥¨ ê°ì†Œ (ì˜ˆ: Nav ì•ˆë‚´ ì‹œ Music)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“‹</span>
                        Matrix ì„¤ì •
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>XML ê¸°ë°˜ ì„¤ì • (audio_focus_configuration.xml)</li>
                            <li>Usageë³„ ìš°ì„ ìˆœìœ„ ì •ì˜</li>
                            <li>ë²¤ë”ë³„ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥</li>
                            <li>OEM ì •ì±… ë°˜ì˜</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš–ï¸</span>
                        ìš°ì„ ìˆœìœ„ ê·œì¹™
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>1ìˆœìœ„: VOICE_COMMUNICATION (í†µí™”)</li>
                            <li>2ìˆœìœ„: ASSISTANCE_NAVIGATION_GUIDANCE</li>
                            <li>3ìˆœìœ„: ALARM, NOTIFICATION_RINGTONE</li>
                            <li>4ìˆœìœ„: MEDIA, GAME</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“Š Audio Context Interaction Matrix</h3>
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>í˜„ì¬ ì¬ìƒ ì¤‘ (Row)</th>
                            <th>ìƒˆ ìš”ì²­ (Column)</th>
                            <th>ê²°ê³¼</th>
                            <th>ì„¤ëª…</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>MUSIC</td>
                            <td>MUSIC</td>
                            <td><strong>EXCLUSIVE</strong></td>
                            <td>ì´ì „ ìŒì•… ì •ì§€, ìƒˆ ìŒì•… ì¬ìƒ</td>
                        </tr>
                        <tr>
                            <td>MUSIC</td>
                            <td>NAVIGATION</td>
                            <td><strong>CONCURRENT + DUCK</strong></td>
                            <td>ìŒì•… ë³¼ë¥¨ 20%ë¡œ ê°ì†Œ, ë‚´ë¹„ ì¬ìƒ</td>
                        </tr>
                        <tr>
                            <td>MUSIC</td>
                            <td>VOICE_CALL</td>
                            <td><strong>EXCLUSIVE</strong></td>
                            <td>ìŒì•… ì¼ì‹œì •ì§€, í†µí™” ì‹œì‘</td>
                        </tr>
                        <tr>
                            <td>NAVIGATION</td>
                            <td>MUSIC</td>
                            <td><strong>CONCURRENT</strong></td>
                            <td>ë‘˜ ë‹¤ ì¬ìƒ (ë‚´ë¹„ê°€ í•„ìš” ì‹œ Duck)</td>
                        </tr>
                        <tr>
                            <td>VOICE_CALL</td>
                            <td>MUSIC</td>
                            <td><strong>REJECT</strong></td>
                            <td>í†µí™” ì¤‘ ìŒì•… ìš”ì²­ ê±°ë¶€</td>
                        </tr>
                        <tr>
                            <td>VOICE_CALL</td>
                            <td>NAVIGATION</td>
                            <td><strong>CONCURRENT + DUCK</strong></td>
                            <td>í†µí™” ì¤‘ì—ë„ ê¸´ê¸‰ ë‚´ë¹„ í—ˆìš© (ì‘ì€ ë³¼ë¥¨)</td>
                        </tr>
                        <tr>
                            <td>ALARM</td>
                            <td>MUSIC</td>
                            <td><strong>REJECT</strong></td>
                            <td>ì•ŒëŒ ìš¸ë¦´ ë•Œ ìŒì•… ë¶ˆê°€</td>
                        </tr>
                        <tr>
                            <td>NOTIFICATION</td>
                            <td>MUSIC</td>
                            <td><strong>CONCURRENT</strong></td>
                            <td>ì•Œë¦¼ìŒ í›„ ìŒì•… ê³„ì†</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“‹ car_audio_focus_configuration.xml ì˜ˆì‹œ</h3>
            <div class="code-block">
                <pre><code>&lt;!-- car_audio_focus_configuration.xml: ì˜¤ë””ì˜¤ í¬ì»¤ìŠ¤ ìƒí˜¸ì‘ìš© ê·œì¹™ --&gt;
&lt;audioFocusConfiguration version="1"&gt;
    &lt;!-- Focus Interaction Matrix --&gt;
    &lt;focusInteractions&gt;
        &lt;!-- MUSIC (USAGE_MEDIA) --&gt;
        &lt;interaction usage="USAGE_MEDIA"&gt;
            &lt;loses focusGain="AUDIOFOCUS_GAIN" type="EXCLUSIVE"/&gt;
            &lt;loses focusGain="AUDIOFOCUS_GAIN_TRANSIENT" type="CONCURRENT"&gt;
                &lt;duck/&gt;
            &lt;/loses&gt;
            &lt;continues focusGain="AUDIOFOCUS_GAIN_TRANSIENT_MAY_DUCK"/&gt;
        &lt;/interaction&gt;

        &lt;!-- NAVIGATION (USAGE_ASSISTANCE_NAVIGATION_GUIDANCE) --&gt;
        &lt;interaction usage="USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"&gt;
            &lt;loses focusGain="AUDIOFOCUS_GAIN" type="EXCLUSIVE"/&gt;
            &lt;continues focusGain="AUDIOFOCUS_GAIN_TRANSIENT"/&gt;
            &lt;continues focusGain="AUDIOFOCUS_GAIN_TRANSIENT_MAY_DUCK"/&gt;
        &lt;/interaction&gt;

        &lt;!-- VOICE CALL (USAGE_VOICE_COMMUNICATION) --&gt;
        &lt;interaction usage="USAGE_VOICE_COMMUNICATION"&gt;
            &lt;!-- í†µí™” ì¤‘ì—ëŠ” ëŒ€ë¶€ë¶„ ê±°ë¶€ --&gt;
            &lt;rejects usage="USAGE_MEDIA"/&gt;
            &lt;rejects usage="USAGE_GAME"/&gt;
            &lt;!-- ê¸´ê¸‰ ë‚´ë¹„ê²Œì´ì…˜ë§Œ í—ˆìš© (ì‘ì€ ë³¼ë¥¨) --&gt;
            &lt;continues usage="USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"&gt;
                &lt;duck percentage="10"/&gt;
            &lt;/continues&gt;
        &lt;/interaction&gt;

        &lt;!-- ALARM (USAGE_ALARM) --&gt;
        &lt;interaction usage="USAGE_ALARM"&gt;
            &lt;!-- ì•ŒëŒì€ ê±°ì˜ ëª¨ë“  ê²ƒì„ ì¤‘ë‹¨ì‹œí‚´ --&gt;
            &lt;loses focusGain="AUDIOFOCUS_GAIN" type="EXCLUSIVE"/&gt;
        &lt;/interaction&gt;
    &lt;/focusInteractions&gt;

    &lt;!-- Ducking ì„¤ì • --&gt;
    &lt;duckingSettings&gt;
        &lt;!-- ë‚´ë¹„ê²Œì´ì…˜ ì•ˆë‚´ ì‹œ ë¯¸ë””ì–´ ë³¼ë¥¨ 20%ë¡œ --&gt;
        &lt;ducking usage="USAGE_MEDIA" duckTo="20"/&gt;

        &lt;!-- ì•Œë¦¼ìŒ ì‹œ ë¯¸ë””ì–´ ë³¼ë¥¨ 50%ë¡œ --&gt;
        &lt;ducking usage="USAGE_NOTIFICATION" duckTo="50"/&gt;
    &lt;/duckingSettings&gt;
&lt;/audioFocusConfiguration&gt;</code></pre>
            </div>
        </section>

        <!-- Section 8: Last Media Source (LMS) -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">8</span>
                Last Media Source (LMS)
            </h2>
            <p class="section-description">
                ì°¨ëŸ‰ ì¬ì‹œë™ ì‹œ ë§ˆì§€ë§‰ ë¯¸ë””ì–´ ì†ŒìŠ¤ë¥¼ ë³µì›í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ’¾</span>
                        LMS ì €ì¥
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>ì‹œì </strong>: ë¯¸ë””ì–´ ì†ŒìŠ¤ ë³€ê²½ ì‹œ</li>
                            <li><strong>ì €ì¥ ì •ë³´</strong>: ComponentName, íƒ€ì„ìŠ¤íƒ¬í”„, PlaybackState</li>
                            <li><strong>ì €ì¥ ìœ„ì¹˜</strong>: SharedPreferences (ê²½ëŸ‰)</li>
                            <li><strong>ì§€ì†ì„±</strong>: ì‹œë™ êº¼ì ¸ë„ ìœ ì§€</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”„</span>
                        LMS ë³µì›
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>ì‹œì </strong>: ì‹œë™ ì¼œì§(Ignition ON)</li>
                            <li><strong>í”„ë¡œì„¸ìŠ¤</strong>: CarMediaService ì´ˆê¸°í™” ì‹œ</li>
                            <li><strong>ì¡°ê±´</strong>: ì•± ì„¤ì¹˜ ì—¬ë¶€, ì‚¬ìš©ì ì„¤ì •</li>
                            <li><strong>fallback</strong>: ê¸°ë³¸ ë¼ë””ì˜¤ ì•±</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš¡</span>
                        Auto-resume
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>ìë™ ì¬ìƒ</strong>: ì„¤ì •ì— ë”°ë¼ ìë™ ì¬ìƒ</li>
                            <li><strong>onPlaybackResumption()</strong>: ì•± ì½œë°±</li>
                            <li><strong>ì§€ì—° ì¬ìƒ</strong>: ë¶€íŒ… ì™„ë£Œ í›„</li>
                            <li><strong>ì‚¬ìš©ì ì œì–´</strong>: ì„¤ì •ì—ì„œ On/Off</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant User
                    participant CMS as CarMediaService
                    participant Storage as SharedPreferences
                    participant App as Media App
                    participant Session as MediaSession

                    Note over User,Session: ì‹œë™ ë„ê¸° (Ignition OFF)
                    User->>CMS: Power Off Event
                    CMS->>Storage: Save LMS (ComponentName, Timestamp)
                    Storage-->>CMS: Saved

                    Note over User,Session: ì‹œë™ ì¼œê¸° (Ignition ON)
                    User->>CMS: Power On Event
                    CMS->>Storage: Load LMS
                    Storage-->>CMS: Last Source = Spotify

                    CMS->>App: Start Service
                    App->>Session: Create MediaSession
                    Session-->>CMS: Session Ready

                    alt Auto-resume enabled
                        CMS->>App: onPlaybackResumption()
                        App->>Session: play()
                    else Auto-resume disabled
                        Note over CMS,App: ì¬ìƒ ì•ˆ í•¨ (ëŒ€ê¸°)
                    end
                </div>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ’¾ LMS ì €ì¥/ë³µì› êµ¬í˜„</h3>
            <div class="code-block">
                <pre><code>// Last Media Source ì €ì¥ ë° ë³µì›
class LastMediaSourceManager(private val context: Context) {
    private val prefs = context.getSharedPreferences("car_media_lms", Context.MODE_PRIVATE)

    companion object {
        const val KEY_LAST_PACKAGE = "last_media_package"
        const val KEY_LAST_CLASS = "last_media_class"
        const val KEY_LAST_TIMESTAMP = "last_timestamp"
        const val KEY_AUTO_RESUME = "auto_resume_enabled"
    }

    // LMS ì €ì¥
    fun saveLastMediaSource(componentName: ComponentName) {
        prefs.edit().apply {
            putString(KEY_LAST_PACKAGE, componentName.packageName)
            putString(KEY_LAST_CLASS, componentName.className)
            putLong(KEY_LAST_TIMESTAMP, System.currentTimeMillis())
            apply()
        }

        Log.d("LMS", "Saved: ${componentName.packageName}")
    }

    // LMS ë³µì›
    fun getLastMediaSource(): ComponentName? {
        val packageName = prefs.getString(KEY_LAST_PACKAGE, null)
        val className = prefs.getString(KEY_LAST_CLASS, null)

        if (packageName != null && className != null) {
            // ì•±ì´ ì—¬ì „íˆ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
            if (isAppInstalled(packageName)) {
                return ComponentName(packageName, className)
            } else {
                Log.w("LMS", "Last media app not installed: $packageName")
                clearLastMediaSource()
            }
        }

        return null
    }

    private fun isAppInstalled(packageName: String): Boolean {
        return try {
            context.packageManager.getPackageInfo(packageName, 0)
            true
        } catch (e: PackageManager.NameNotFoundException) {
            false
        }
    }

    fun clearLastMediaSource() {
        prefs.edit().clear().apply()
    }

    // Auto-resume ì„¤ì •
    fun setAutoResumeEnabled(enabled: Boolean) {
        prefs.edit().putBoolean(KEY_AUTO_RESUME, enabled).apply()
    }

    fun isAutoResumeEnabled(): Boolean {
        return prefs.getBoolean(KEY_AUTO_RESUME, true)  // ê¸°ë³¸ê°’: true
    }

    // ë§ˆì§€ë§‰ ì¬ìƒ ì‹œê°„ í™•ì¸
    fun getLastPlayedTime(): Long {
        return prefs.getLong(KEY_LAST_TIMESTAMP, 0)
    }
}

// CarMediaServiceì—ì„œ ì‚¬ìš©
class CarMediaServiceImpl {
    private lateinit var lmsManager: LastMediaSourceManager

    fun onIgnitionOn() {
        // 1. LMS ë³µì›
        val lastSource = lmsManager.getLastMediaSource()

        if (lastSource != null) {
            // 2. ë¯¸ë””ì–´ ì†ŒìŠ¤ ì„¤ì •
            carMediaManager.setMediaSource(
                lastSource,
                CarMediaManager.MEDIA_SOURCE_MODE_PLAYBACK
            )

            // 3. Auto-resume í™•ì¸
            if (lmsManager.isAutoResumeEnabled()) {
                // ì•½ê°„ì˜ ì§€ì—° í›„ ìë™ ì¬ìƒ
                Handler(Looper.getMainLooper()).postDelayed({
                    resumePlayback(lastSource)
                }, 2000)  // 2ì´ˆ ëŒ€ê¸° (ë¶€íŒ… ì•ˆì •í™”)
            }
        } else {
            // Fallback: ê¸°ë³¸ ë¼ë””ì˜¤ ì•±
            setDefaultMediaSource()
        }
    }

    private fun resumePlayback(componentName: ComponentName) {
        // MediaControllerë¥¼ í†µí•´ ì¬ìƒ ëª…ë ¹
        val mediaController = getActiveMediaController()
        mediaController?.transportControls?.play()
    }
}</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ”„ ë¶€íŒ… ì‹œí€€ìŠ¤</h3>
            <div class="code-block">
                <pre><code># AAOS ë¶€íŒ… ì‹œ ë¯¸ë””ì–´ ë³µì› íƒ€ì´ë°

1. System Server ì‹œì‘ (0-5ì´ˆ)
   â””â”€ CarService ì´ˆê¸°í™”
      â””â”€ CarMediaService ì´ˆê¸°í™”
         â””â”€ Last Media Source ë¡œë“œ

2. Package Manager Ready (5-10ì´ˆ)
   â””â”€ ì„¤ì¹˜ëœ ì•± ëª©ë¡ í™•ì¸
   â””â”€ LMS ì•±ì´ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ ê²€ì¦

3. Boot Complete (10-15ì´ˆ)
   â””â”€ CarMediaService.onBootComplete()
   â””â”€ setMediaSource(lastSource)
   â””â”€ MediaBrowserService ë°”ì¸ë”© ì‹œì‘

4. Media Session Ready (15-20ì´ˆ)
   â””â”€ MediaSession ìƒì„± ì™„ë£Œ
   â””â”€ Auto-resume ì„¤ì • í™•ì¸
      â””â”€ play() ëª…ë ¹ ì „ì†¡ (ë˜ëŠ” ëŒ€ê¸°)

5. Audio Focus íšë“ (20-22ì´ˆ)
   â””â”€ requestAudioFocus()
   â””â”€ ì‹¤ì œ ì¬ìƒ ì‹œì‘

# ì£¼ì˜ì‚¬í•­:
# - ë„ˆë¬´ ë¹ ë¥¸ ì¬ìƒ ì‹œë„ëŠ” ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ë¯¸ì¤€ë¹„ë¡œ ì‹¤íŒ¨ ê°€ëŠ¥
# - 2-3ì´ˆ ì§€ì—° í›„ ì¬ìƒ ê¶Œì¥
# - Power Policyì— ë”°ë¼ ì¼ë¶€ ë‹¨ê³„ ì§€ì—° ê°€ëŠ¥</code></pre>
            </div>
        </section>

        <!-- Section 9: UX Restrictions -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">9</span>
                UX Restrictions (ìš´ì „ ì¤‘ ì œí•œ)
            </h2>
            <p class="section-description">
                ìš´ì „ ì¤‘ ì•ˆì „ì„ ìœ„í•œ UI/UX ì œí•œ ì‚¬í•­ ë° êµ¬í˜„ ë°©ë²•ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš ï¸</span>
                        ì œí•œ í•­ëª©
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>ë¦¬ìŠ¤íŠ¸ ê¸¸ì´</strong>: ìµœëŒ€ 6-12ê°œ í•­ëª©</li>
                            <li><strong>í…ìŠ¤íŠ¸ ì…ë ¥</strong>: ì£¼í–‰ ì¤‘ ì°¨ë‹¨</li>
                            <li><strong>ë¹„ë””ì˜¤ ì¬ìƒ</strong>: ìš´ì „ì„ í™”ë©´ ì°¨ë‹¨</li>
                            <li><strong>ë³µì¡í•œ UI</strong>: ê°„ì†Œí™”ëœ ì¸í„°í˜ì´ìŠ¤ë§Œ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš—</span>
                        Driving State
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>PARKED</strong>: ëª¨ë“  ê¸°ëŠ¥ í—ˆìš©</li>
                            <li><strong>IDLING</strong>: ëŒ€ë¶€ë¶„ í—ˆìš©</li>
                            <li><strong>MOVING</strong>: ì œí•œ ì ìš©</li>
                            <li><strong>UNKNOWN</strong>: ì•ˆì „ì„ ìœ„í•´ ì œí•œ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”§</span>
                        êµ¬í˜„ ë°©ë²•
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>CarUxRestrictionsManager ì‚¬ìš©</li>
                            <li>ë¦¬ìŠ¤ë„ˆë¡œ ìƒíƒœ ë³€í™” ê°ì§€</li>
                            <li>ë™ì  UI ì¡°ì •</li>
                            <li>CDD ì •ì±… ì¤€ìˆ˜</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸš¦ CarUxRestrictions êµ¬í˜„</h3>
            <div class="code-block">
                <pre><code>// ìš´ì „ ì¤‘ UI ì œí•œ êµ¬í˜„
class UxRestrictionsHandler(private val context: Context) {
    private lateinit var carUxRestrictionsManager: CarUxRestrictionsManager
    private var currentRestrictions: CarUxRestrictions? = null

    fun initialize() {
        val car = Car.createCar(context)
        carUxRestrictionsManager = car.getCarManager(
            Car.CAR_UX_RESTRICTION_SERVICE
        ) as CarUxRestrictionsManager

        // UX Restrictions ë³€í™” ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        carUxRestrictionsManager.registerListener(restrictionsListener)

        // í˜„ì¬ ì œí•œì‚¬í•­ ê°€ì ¸ì˜¤ê¸°
        currentRestrictions = carUxRestrictionsManager.currentCarUxRestrictions
    }

    private val restrictionsListener =
        CarUxRestrictionsManager.OnUxRestrictionsChangedListener { restrictions ->
            currentRestrictions = restrictions

            Log.d("UxRestrictions", "Active restrictions: ${restrictions.activeRestrictions}")

            // UI ì—…ë°ì´íŠ¸
            updateUIBasedOnRestrictions(restrictions)
        }

    private fun updateUIBasedOnRestrictions(restrictions: CarUxRestrictions) {
        // 1. ë¦¬ìŠ¤íŠ¸ ê¸¸ì´ ì œí•œ
        val maxListItems = restrictions.maxContentDepth
        if (maxListItems > 0) {
            limitListSize(maxListItems)
        }

        // 2. í…ìŠ¤íŠ¸ ì…ë ¥ ì œí•œ
        if (restrictions.isRequiresDistractionOptimization) {
            disableTextInput()
        } else {
            enableTextInput()
        }

        // 3. ë¹„ë””ì˜¤ ì¬ìƒ ì œí•œ
        if (restrictions.activeRestrictions and CarUxRestrictions.UX_RESTRICTIONS_NO_VIDEO != 0) {
            pauseVideoPlayback()
        }

        // 4. ë³µì¡í•œ UI ìˆ¨ê¸°ê¸°
        if (restrictions.activeRestrictions and CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP != 0) {
            hideComplexUI()
        }
    }

    fun isDrivingMode(): Boolean {
        return currentRestrictions?.isRequiresDistractionOptimization ?: false
    }

    fun getMaxListItems(): Int {
        return currentRestrictions?.maxContentDepth ?: 12
    }

    fun canShowTextInput(): Boolean {
        val restrictions = currentRestrictions?.activeRestrictions ?: 0
        return restrictions and CarUxRestrictions.UX_RESTRICTIONS_NO_KEYBOARD == 0
    }

    fun release() {
        carUxRestrictionsManager.unregisterListener()
    }
}

// MediaBrowserServiceì—ì„œ UX Restrictions ì ìš©
override fun onLoadChildren(
    parentId: String,
    result: Result&lt;List&lt;MediaBrowserCompat.MediaItem&gt;&gt;
) {
    result.detach()

    Thread {
        val allItems = loadAllMediaItems(parentId)

        // UX Restrictionsì— ë”°ë¼ ë¦¬ìŠ¤íŠ¸ í¬ê¸° ì œí•œ
        val maxItems = uxRestrictionsHandler.getMaxListItems()
        val limitedItems = allItems.take(maxItems)

        result.sendResult(limitedItems)
    }.start()
}</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“‹ UX Restrictions í”Œë˜ê·¸</h3>
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>í”Œë˜ê·¸</th>
                            <th>ì˜ë¯¸</th>
                            <th>ëŒ€ì‘ ë°©ë²•</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>UX_RESTRICTIONS_NO_DIALPAD</code></td>
                            <td>ë‹¤ì´ì–¼ íŒ¨ë“œ ì‚¬ìš© ê¸ˆì§€</td>
                            <td>ë‹¤ì´ì–¼ UI ë¹„í™œì„±í™”</td>
                        </tr>
                        <tr>
                            <td><code>UX_RESTRICTIONS_NO_FILTERING</code></td>
                            <td>ê²€ìƒ‰/í•„í„°ë§ ê¸ˆì§€</td>
                            <td>ê²€ìƒ‰ ê¸°ëŠ¥ ìˆ¨ê¹€</td>
                        </tr>
                        <tr>
                            <td><code>UX_RESTRICTIONS_LIMIT_STRING_LENGTH</code></td>
                            <td>í…ìŠ¤íŠ¸ ê¸¸ì´ ì œí•œ</td>
                            <td>ê¸´ í…ìŠ¤íŠ¸ ìƒëµ(...)</td>
                        </tr>
                        <tr>
                            <td><code>UX_RESTRICTIONS_NO_KEYBOARD</code></td>
                            <td>í‚¤ë³´ë“œ ì…ë ¥ ê¸ˆì§€</td>
                            <td>í…ìŠ¤íŠ¸ ì…ë ¥ í•„ë“œ ë¹„í™œì„±í™”</td>
                        </tr>
                        <tr>
                            <td><code>UX_RESTRICTIONS_NO_VIDEO</code></td>
                            <td>ë¹„ë””ì˜¤ ì¬ìƒ ê¸ˆì§€</td>
                            <td>ë¹„ë””ì˜¤ ì¼ì‹œì •ì§€, ì˜¤ë””ì˜¤ë§Œ</td>
                        </tr>
                        <tr>
                            <td><code>UX_RESTRICTIONS_LIMIT_CONTENT</code></td>
                            <td>ì»¨í…ì¸  ìˆ˜ ì œí•œ</td>
                            <td>maxContentDepth ê°’ ì‚¬ìš©</td>
                        </tr>
                        <tr>
                            <td><code>UX_RESTRICTIONS_NO_SETUP</code></td>
                            <td>ì„¤ì • í™”ë©´ ê¸ˆì§€</td>
                            <td>ì„¤ì • ë©”ë‰´ ë¹„í™œì„±í™”</td>
                        </tr>
                        <tr>
                            <td><code>UX_RESTRICTIONS_NO_TEXT_MESSAGE</code></td>
                            <td>ë¬¸ì ë©”ì‹œì§€ ì½ê¸°/ì“°ê¸° ê¸ˆì§€</td>
                            <td>ë©”ì‹œì§• ê¸°ëŠ¥ ì°¨ë‹¨</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 10: Android Auto vs AAOS -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">10</span>
                Android Auto vs AAOS ë¹„êµ
            </h2>
            <p class="section-description">
                Android Auto (í”„ë¡œì ì…˜)ì™€ Android Automotive OS (ë„¤ì´í‹°ë¸Œ)ì˜ ì°¨ì´ì ì…ë‹ˆë‹¤.
            </p>

            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>í•­ëª©</th>
                            <th>Android Auto</th>
                            <th>Android Automotive OS (AAOS)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ì‹¤í–‰ í™˜ê²½</td>
                            <td>ìŠ¤ë§ˆíŠ¸í° (í”„ë¡œì ì…˜)</td>
                            <td>ì°¨ëŸ‰ ì„ë² ë””ë“œ ì‹œìŠ¤í…œ</td>
                        </tr>
                        <tr>
                            <td>ì—°ê²° ë°©ì‹</td>
                            <td>USB ì¼€ì´ë¸” ë˜ëŠ” ë¬´ì„ </td>
                            <td>ë…ë¦½ ì‹¤í–‰ (ì—°ê²° ë¶ˆí•„ìš”)</td>
                        </tr>
                        <tr>
                            <td>OS</td>
                            <td>í°ì˜ Android OS</td>
                            <td>ì°¨ëŸ‰ì˜ Android OS (AOSP ê¸°ë°˜)</td>
                        </tr>
                        <tr>
                            <td>ì•± ì„¤ì¹˜ ìœ„ì¹˜</td>
                            <td>ìŠ¤ë§ˆíŠ¸í°</td>
                            <td>ì°¨ëŸ‰ ì‹œìŠ¤í…œ</td>
                        </tr>
                        <tr>
                            <td>ë¯¸ë””ì–´ ì„œë¹„ìŠ¤</td>
                            <td>MediaBrowserService (í°)</td>
                            <td>MediaBrowserService (ì°¨ëŸ‰) + CarMediaService</td>
                        </tr>
                        <tr>
                            <td>ì˜¤ë””ì˜¤ ë¼ìš°íŒ…</td>
                            <td>í° â†’ ì°¨ëŸ‰ ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ (Bluetooth/USB)</td>
                            <td>CarAudioService (ë„¤ì´í‹°ë¸Œ HAL)</td>
                        </tr>
                        <tr>
                            <td>UI ë Œë”ë§</td>
                            <td>í°ì—ì„œ ë Œë”ë§ í›„ ì „ì†¡</td>
                            <td>ì°¨ëŸ‰ì—ì„œ ì§ì ‘ ë Œë”ë§</td>
                        </tr>
                        <tr>
                            <td>ì„±ëŠ¥</td>
                            <td>í° ì„±ëŠ¥ì— ì˜ì¡´, ì§€ì—° ê°€ëŠ¥</td>
                            <td>ê³ ì„±ëŠ¥ (ë„¤ì´í‹°ë¸Œ)</td>
                        </tr>
                        <tr>
                            <td>ë©€í‹°ì¡´ ì˜¤ë””ì˜¤</td>
                            <td>âŒ ë¯¸ì§€ì›</td>
                            <td>âœ… ì§€ì› (ìš´ì „ì„/í›„ì„ ë…ë¦½)</td>
                        </tr>
                        <tr>
                            <td>ì°¨ëŸ‰ ë°ì´í„° ì ‘ê·¼</td>
                            <td>ì œí•œì  (í…œí”Œë¦¿ APIë§Œ)</td>
                            <td>ì „ì²´ ì ‘ê·¼ (Vehicle HAL)</td>
                        </tr>
                        <tr>
                            <td>Google ì„œë¹„ìŠ¤</td>
                            <td>í°ì˜ Google Play Services</td>
                            <td>GAS (Google Automotive Services)</td>
                        </tr>
                        <tr>
                            <td>ì•± ê°œë°œ</td>
                            <td>Media App Template (ì œí•œì )</td>
                            <td>Full Android App (ììœ ë¡œì›€)</td>
                        </tr>
                        <tr>
                            <td>ë°°í¬</td>
                            <td>Google Play Store</td>
                            <td>Google Play Store (Automotive)</td>
                        </tr>
                        <tr>
                            <td>ì‚¬ìš© ì‚¬ë¡€</td>
                            <td>ê¸°ì¡´ ì°¨ëŸ‰ (ì• í”„í„°ë§ˆì¼“)</td>
                            <td>ì‹ ê·œ ì°¨ëŸ‰ (OEM í†µí•©)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph AA["Android Auto (Projection)"]
                    PHONE[Smartphone]
                    AA_APP[Media App]
                    AA_FW[Android Framework]

                    AA_APP --> AA_FW
                    AA_FW --> PHONE
                    end

                    subgraph VEHICLE_AA["Vehicle (Display Only)"]
                    CAR_DISPLAY[Car Display]
                    CAR_AUDIO[Car Audio System]
                    end

                    PHONE -->|USB/Wireless| CAR_DISPLAY
                    PHONE -->|Bluetooth/USB Audio| CAR_AUDIO

                    subgraph AAOS["Android Automotive OS"]
                    CAR_OS[Android OS<br />(Embedded)]
                    CAR_APPS[Media Apps<br />(Native)]
                    CAR_SERVICE[CarService<br />CarMediaService<br />CarAudioService]
                    VEHICLE_HAL[Vehicle HAL]

                    CAR_APPS --> CAR_SERVICE
                    CAR_SERVICE --> CAR_OS
                    CAR_OS --> VEHICLE_HAL
                    end

                    style AA fill:#e3f2fd
                    style AAOS fill:#f3e5f5
                </div>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“± ì•± ê°œë°œ ì°¨ì´ì </h3>
            <div class="code-block">
                <pre><code>// Android Auto: í…œí”Œë¦¿ ê¸°ë°˜ (ì œí•œì )
// AndroidManifest.xml
&lt;application&gt;
    &lt;service android:name=".MyMediaBrowserService"
             android:exported="true"&gt;
        &lt;intent-filter&gt;
            &lt;action android:name="android.media.browse.MediaBrowserService"/&gt;
        &lt;/intent-filter&gt;
    &lt;/service&gt;
&lt;/application&gt;

// - í…œí”Œë¦¿ APIë§Œ ì‚¬ìš© ê°€ëŠ¥
// - ì»¤ìŠ¤í…€ UI ë¶ˆê°€
// - ì°¨ëŸ‰ ë°ì´í„° ì ‘ê·¼ ì œí•œì 

// ========================================

// AAOS: Full Android (ììœ ë¡œì›€)
// AndroidManifest.xml
&lt;application&gt;
    &lt;!-- ì¼ë°˜ Android ì•±ê³¼ ë™ì¼ --&gt;
    &lt;activity android:name=".MainActivity"
              android:exported="true"&gt;
        &lt;intent-filter&gt;
            &lt;action android:name="android.intent.action.MAIN"/&gt;
            &lt;category android:name="android.intent.category.LAUNCHER"/&gt;
        &lt;/intent-filter&gt;
    &lt;/activity&gt;

    &lt;service android:name=".MyMediaBrowserService"
             android:exported="true"&gt;
        &lt;intent-filter&gt;
            &lt;action android:name="android.media.browse.MediaBrowserService"/&gt;
        &lt;/intent-filter&gt;
    &lt;/service&gt;

    &lt;!-- CarService ì‚¬ìš© ê°€ëŠ¥ --&gt;
    &lt;uses-library android:name="android.car" android:required="false"/&gt;
&lt;/application&gt;

// - ì»¤ìŠ¤í…€ UI ê°€ëŠ¥
// - CarService API ì‚¬ìš©
// - Vehicle HAL ì ‘ê·¼ (ê¶Œí•œ í•„ìš”)
// - ë©€í‹°ì¡´ ì˜¤ë””ì˜¤ ì œì–´</code></pre>
            </div>
        </section>

        <!-- Section 11: Volume Groups -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">11</span>
                Volume Groups
            </h2>
            <p class="section-description">
                CarAudioServiceì˜ ì»¨í…ìŠ¤íŠ¸ë³„ ë³¼ë¥¨ ê·¸ë£¹ ê´€ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”Š</span>
                        Volume Group ê°œë…
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>ê·¸ë£¹í™”</strong>: ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê·¸ë£¹ìœ¼ë¡œ ë¬¶ìŒ</li>
                            <li><strong>ë…ë¦½ ì œì–´</strong>: ê·¸ë£¹ë³„ ë…ë¦½ì ì¸ ë³¼ë¥¨</li>
                            <li><strong>Zoneë³„ ì„¤ì •</strong>: ê° Zoneë§ˆë‹¤ ë‹¤ë¥¸ ê·¸ë£¹</li>
                            <li><strong>ë””ë°”ì´ìŠ¤ ë§¤í•‘</strong>: ê·¸ë£¹ â†’ ë¬¼ë¦¬ì  ì¶œë ¥</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸšï¸</span>
                        ì¼ë°˜ì ì¸ ê·¸ë£¹
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>Group 0</strong>: Media, Game</li>
                            <li><strong>Group 1</strong>: Navigation</li>
                            <li><strong>Group 2</strong>: Voice Call</li>
                            <li><strong>Group 3</strong>: Alarm, Notification</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš™ï¸</span>
                        ì„¤ì • íŒŒì¼
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>car_audio_configuration.xml</li>
                            <li>Zone ë° VolumeGroup ì •ì˜</li>
                            <li>Context â†’ Group ë§¤í•‘</li>
                            <li>Device Address í• ë‹¹</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“‹ Volume Groups ì„¤ì • ì˜ˆì‹œ</h3>
            <div class="code-block">
                <pre><code>&lt;!-- car_audio_configuration.xml: ë³¼ë¥¨ ê·¸ë£¹ ì„¤ì • --&gt;
&lt;carAudioConfiguration version="2"&gt;
    &lt;!-- Zone 0: ìš´ì „ì„ --&gt;
    &lt;zone name="primary zone" audioZoneId="0" isPrimary="true"&gt;
        &lt;volumeGroups&gt;
            &lt;!-- Group 0: Media & Game --&gt;
            &lt;group&gt;
                &lt;device address="bus0_media_out"&gt;
                    &lt;context context="music"/&gt;
                    &lt;context context="game"/&gt;
                &lt;/device&gt;
            &lt;/group&gt;

            &lt;!-- Group 1: Navigation --&gt;
            &lt;group&gt;
                &lt;device address="bus1_navigation_out"&gt;
                    &lt;context context="navigation"/&gt;
                &lt;/device&gt;
            &lt;/group&gt;

            &lt;!-- Group 2: Voice Call --&gt;
            &lt;group&gt;
                &lt;device address="bus2_call_out"&gt;
                    &lt;context context="call"/&gt;
                    &lt;context context="call_ring"/&gt;
                &lt;/device&gt;
            &lt;/group&gt;

            &lt;!-- Group 3: Notification --&gt;
            &lt;group&gt;
                &lt;device address="bus3_notification_out"&gt;
                    &lt;context context="alarm"/&gt;
                    &lt;context context="notification"/&gt;
                &lt;/device&gt;
            &lt;/group&gt;
        &lt;/volumeGroups&gt;
    &lt;/zone&gt;

    &lt;!-- Zone 1: í›„ì„ --&gt;
    &lt;zone name="rear seat zone" audioZoneId="1"&gt;
        &lt;volumeGroups&gt;
            &lt;!-- RearëŠ” Mediaë§Œ --&gt;
            &lt;group&gt;
                &lt;device address="bus100_rear_media_out"&gt;
                    &lt;context context="music"/&gt;
                    &lt;context context="game"/&gt;
                &lt;/device&gt;
            &lt;/group&gt;
        &lt;/volumeGroups&gt;
    &lt;/zone&gt;
&lt;/carAudioConfiguration&gt;</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ›ï¸ Volume Groups API ì‚¬ìš©</h3>
            <div class="code-block">
                <pre><code>// CarAudioManagerë¡œ ë³¼ë¥¨ ê·¸ë£¹ ì œì–´
class VolumeGroupController(private val context: Context) {
    private lateinit var carAudioManager: CarAudioManager

    fun initialize() {
        val car = Car.createCar(context)
        carAudioManager = car.getCarManager(Car.AUDIO_SERVICE) as CarAudioManager
    }

    fun getVolumeGroupInfo(zoneId: Int) {
        // Zoneì˜ ëª¨ë“  ë³¼ë¥¨ ê·¸ë£¹ ì¡°íšŒ
        val groupCount = carAudioManager.getVolumeGroupCount(zoneId)

        for (groupId in 0 until groupCount) {
            val currentVolume = carAudioManager.getGroupVolume(zoneId, groupId)
            val maxVolume = carAudioManager.getGroupMaxVolume(zoneId, groupId)
            val minVolume = carAudioManager.getGroupMinVolume(zoneId, groupId)

            Log.d("VolumeGroup", "Zone $zoneId, Group $groupId:")
            Log.d("VolumeGroup", "  Current: $currentVolume")
            Log.d("VolumeGroup", "  Range: $minVolume - $maxVolume")
        }
    }

    fun setMediaVolume(zoneId: Int, volume: Int) {
        // MediaëŠ” ì¼ë°˜ì ìœ¼ë¡œ Group 0
        val mediaGroupId = 0
        carAudioManager.setGroupVolume(zoneId, mediaGroupId, volume, 0)
    }

    fun setNavigationVolume(zoneId: Int, volume: Int) {
        // Navigationì€ ì¼ë°˜ì ìœ¼ë¡œ Group 1
        val navGroupId = 1
        carAudioManager.setGroupVolume(zoneId, navGroupId, volume, 0)
    }

    // Usageë¡œ ë³¼ë¥¨ ê·¸ë£¹ ì°¾ê¸°
    fun getVolumeGroupForUsage(zoneId: Int, usage: Int): Int {
        return carAudioManager.getVolumeGroupIdForUsage(zoneId, usage)
    }

    fun adjustMediaVolumeUp(zoneId: Int) {
        val mediaGroupId = 0
        val currentVolume = carAudioManager.getGroupVolume(zoneId, mediaGroupId)
        val maxVolume = carAudioManager.getGroupMaxVolume(zoneId, mediaGroupId)

        if (currentVolume < maxVolume) {
            carAudioManager.setGroupVolume(zoneId, mediaGroupId, currentVolume + 1, 0)
        }
    }

    fun adjustMediaVolumeDown(zoneId: Int) {
        val mediaGroupId = 0
        val currentVolume = carAudioManager.getGroupVolume(zoneId, mediaGroupId)
        val minVolume = carAudioManager.getGroupMinVolume(zoneId, mediaGroupId)

        if (currentVolume > minVolume) {
            carAudioManager.setGroupVolume(zoneId, mediaGroupId, currentVolume - 1, 0)
        }
    }
}</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“Š AudioContext â†’ VolumeGroup ë§¤í•‘</h3>
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>Audio Context</th>
                            <th>Usage</th>
                            <th>ì¼ë°˜ì ì¸ Group ID</th>
                            <th>ì„¤ëª…</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>music</td>
                            <td>USAGE_MEDIA</td>
                            <td>Group 0</td>
                            <td>ìŒì•…, íŒŸìºìŠ¤íŠ¸</td>
                        </tr>
                        <tr>
                            <td>game</td>
                            <td>USAGE_GAME</td>
                            <td>Group 0</td>
                            <td>ê²Œì„ ì˜¤ë””ì˜¤</td>
                        </tr>
                        <tr>
                            <td>navigation</td>
                            <td>USAGE_ASSISTANCE_NAVIGATION_GUIDANCE</td>
                            <td>Group 1</td>
                            <td>ë‚´ë¹„ê²Œì´ì…˜ ì•ˆë‚´</td>
                        </tr>
                        <tr>
                            <td>call</td>
                            <td>USAGE_VOICE_COMMUNICATION</td>
                            <td>Group 2</td>
                            <td>ì „í™” í†µí™”</td>
                        </tr>
                        <tr>
                            <td>call_ring</td>
                            <td>USAGE_NOTIFICATION_RINGTONE</td>
                            <td>Group 2</td>
                            <td>ì „í™”ë²¨</td>
                        </tr>
                        <tr>
                            <td>alarm</td>
                            <td>USAGE_ALARM</td>
                            <td>Group 3</td>
                            <td>ì•ŒëŒ</td>
                        </tr>
                        <tr>
                            <td>notification</td>
                            <td>USAGE_NOTIFICATION</td>
                            <td>Group 3</td>
                            <td>ì•Œë¦¼ìŒ</td>
                        </tr>
                        <tr>
                            <td>system_sound</td>
                            <td>USAGE_ASSISTANCE_SONIFICATION</td>
                            <td>Group 3</td>
                            <td>ì‹œìŠ¤í…œ ì‚¬ìš´ë“œ</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 12: Debugging & Troubleshooting -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">12</span>
                ë””ë²„ê¹… & íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
            </h2>
            <p class="section-description">
                Car Media Service ë¬¸ì œë¥¼ ì§„ë‹¨í•˜ê³  í•´ê²°í•˜ê¸° ìœ„í•œ ë„êµ¬ ë° ë°©ë²•ë¡ ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        ì£¼ìš” ë””ë²„ê¹… ë„êµ¬
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><code>dumpsys car_service</code></li>
                            <li><code>dumpsys media_session</code></li>
                            <li><code>dumpsys audio</code></li>
                            <li><code>adb logcat -s CarMediaService:V</code></li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš ï¸</span>
                        ì¼ë°˜ì ì¸ ë¬¸ì œ
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>ë¯¸ë””ì–´ ì†ŒìŠ¤ ë³€ê²½ ì•ˆ ë¨</li>
                            <li>LMS ë³µì› ì‹¤íŒ¨</li>
                            <li>Audio Focus ì¶©ëŒ</li>
                            <li>ë©€í‹°ì¡´ ë¼ìš°íŒ… ë¬¸ì œ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ› ï¸</span>
                        ë¡œê·¸ ë¶„ì„
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>Media Source ë³€ê²½ ì¶”ì </li>
                            <li>Audio Focus ìš”ì²­/í•´ì œ</li>
                            <li>MediaSession ìƒíƒœ ë³€í™”</li>
                            <li>Zoneë³„ ì˜¤ë””ì˜¤ ë¼ìš°íŒ…</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ”§ ì£¼ìš” dumpsys ëª…ë ¹ì–´</h3>
            <div class="code-block">
                <pre><code># CarMediaService ìƒíƒœ í™•ì¸
adb shell dumpsys car_service --services CarMediaService

# ì¶œë ¥ ì˜ˆì‹œ:
# Active Media Source: com.spotify.music/.MainActivity
# Last Media Source: com.spotify.music/.MainActivity
# Auto-resume: enabled
# Media Source Change History:
#   [2024-01-20 10:15:30] Spotify
#   [2024-01-20 09:45:12] Radio

# CarAudioService ìƒíƒœ í™•ì¸
adb shell dumpsys car_service --services CarAudioService

# ì¶œë ¥ ì˜ˆì‹œ:
# Audio Zones: 2
# Zone 0 (Primary):
#   Volume Groups: 4
#   Group 0 (Media): 15/25
#   Group 1 (Navigation): 20/25
#   Group 2 (Call): 18/25
#   Group 3 (Notification): 12/25
#
# Zone 1 (Rear):
#   Volume Groups: 1
#   Group 0 (Media): 10/25

# MediaSession ìƒíƒœ í™•ì¸
adb shell dumpsys media_session

# Audio Focus ìƒíƒœ í™•ì¸
adb shell dumpsys audio | grep -A 20 "Audio Focus"

# ì „ì²´ Car Service ìƒíƒœ
adb shell dumpsys car_service</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“‹ logcat í•„í„°ë§</h3>
            <div class="code-block">
                <pre><code># CarMediaService ë¡œê·¸ë§Œ
adb logcat -s CarMediaService:V

# CarAudioService ë¡œê·¸ë§Œ
adb logcat -s CarAudioService:V

# Media ê´€ë ¨ ëª¨ë“  ë¡œê·¸
adb logcat -s CarMediaService:V CarAudioService:V MediaSessionService:V

# ë¯¸ë””ì–´ ì†ŒìŠ¤ ë³€ê²½ ì¶”ì 
adb logcat | grep -i "media source"

# Audio Focus ë³€ê²½ ì¶”ì 
adb logcat | grep -i "audio focus"

# íŠ¹ì • ì•±ì˜ MediaSession ë¡œê·¸
adb logcat | grep "com.spotify.music"

# Zone ë¼ìš°íŒ… ë¡œê·¸
adb logcat -s CarAudioService:V | grep -i "zone"</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">âš ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ</h3>
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>ë¬¸ì œ ì¦ìƒ</th>
                            <th>ê°€ëŠ¥í•œ ì›ì¸</th>
                            <th>í•´ê²° ë°©ë²•</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ë¯¸ë””ì–´ ì†ŒìŠ¤ ë³€ê²½ ì•ˆ ë¨</td>
                            <td>
                                â€¢ MediaBrowserService ë¯¸êµ¬í˜„<br />
                                â€¢ onGetRoot() null ë°˜í™˜<br />
                                â€¢ ì•± í¬ë˜ì‹œ
                            </td>
                            <td>
                                â€¢ MediaBrowserService êµ¬í˜„ í™•ì¸<br />
                                â€¢ onGetRoot() ë¡œê·¸ í™•ì¸<br />
                                â€¢ logcatì—ì„œ í¬ë˜ì‹œ ì¶”ì 
                            </td>
                        </tr>
                        <tr>
                            <td>LMS ë³µì› ì•ˆ ë¨</td>
                            <td>
                                â€¢ ì•± ì–¸ì¸ìŠ¤í†¨ë¨<br />
                                â€¢ SharedPreferences ì‚­ì œ<br />
                                â€¢ ë¶€íŒ… ì‹œí€€ìŠ¤ ë¬¸ì œ
                            </td>
                            <td>
                                â€¢ dumpsysë¡œ LMS í™•ì¸<br />
                                â€¢ ì•± ì¬ì„¤ì¹˜<br />
                                â€¢ ë¶€íŒ… ë¡œê·¸ ë¶„ì„
                            </td>
                        </tr>
                        <tr>
                            <td>ì¬ìƒ ìë™ ì‹œì‘ ì•ˆ ë¨</td>
                            <td>
                                â€¢ Auto-resume ë¹„í™œì„±í™”<br />
                                â€¢ Audio Focus ë¯¸íšë“<br />
                                â€¢ onPlaybackResumption() ë¯¸êµ¬í˜„
                            </td>
                            <td>
                                â€¢ Auto-resume ì„¤ì • í™•ì¸<br />
                                â€¢ Audio Focus ë¡œê·¸ í™•ì¸<br />
                                â€¢ ì½œë°± êµ¬í˜„ ê²€ì¦
                            </td>
                        </tr>
                        <tr>
                            <td>Audio Focus ì¶©ëŒ</td>
                            <td>
                                â€¢ Interaction Matrix ì„¤ì • ì˜¤ë¥˜<br />
                                â€¢ ì˜ëª»ëœ Usage ì‚¬ìš©<br />
                                â€¢ Focus ë¯¸í•´ì œ
                            </td>
                            <td>
                                â€¢ audio_focus_configuration.xml í™•ì¸<br />
                                â€¢ AudioAttributes Usage ê²€ì¦<br />
                                â€¢ abandonAudioFocus() í˜¸ì¶œ í™•ì¸
                            </td>
                        </tr>
                        <tr>
                            <td>ë©€í‹°ì¡´ ì˜¤ë””ì˜¤ ì•ˆ ë“¤ë¦¼</td>
                            <td>
                                â€¢ car_audio_configuration.xml ì˜¤ë¥˜<br />
                                â€¢ ì˜ëª»ëœ Zone ID<br />
                                â€¢ Device Address ë¯¸ë§¤ì¹­
                            </td>
                            <td>
                                â€¢ XML ì„¤ì • ê²€ì¦<br />
                                â€¢ dumpsys car_serviceë¡œ Zone í™•ì¸<br />
                                â€¢ Audio HAL ë¡œê·¸ í™•ì¸
                            </td>
                        </tr>
                        <tr>
                            <td>ë³¼ë¥¨ ì œì–´ ì•ˆ ë¨</td>
                            <td>
                                â€¢ ì˜ëª»ëœ Volume Group ID<br />
                                â€¢ Zone ID ë¶ˆì¼ì¹˜<br />
                                â€¢ ê¶Œí•œ ë¶€ì¡±
                            </td>
                            <td>
                                â€¢ getVolumeGroupIdForUsage() ì‚¬ìš©<br />
                                â€¢ Zone ID í™•ì¸<br />
                                â€¢ ê¶Œí•œ (MODIFY_AUDIO_ROUTING) í™•ì¸
                            </td>
                        </tr>
                        <tr>
                            <td>MediaBrowser ì—°ê²° ì‹¤íŒ¨</td>
                            <td>
                                â€¢ ì„œë¹„ìŠ¤ export ì•ˆ ë¨<br />
                                â€¢ Intent Filter ëˆ„ë½<br />
                                â€¢ íŒ¨í‚¤ì§€ëª… ì˜¤íƒ€
                            </td>
                            <td>
                                â€¢ AndroidManifest.xml ê²€ì¦<br />
                                â€¢ exported="true" í™•ì¸<br />
                                â€¢ ComponentName ì •í™•ë„ í™•ì¸
                            </td>
                        </tr>
                        <tr>
                            <td>UX Restrictions ì ìš© ì•ˆ ë¨</td>
                            <td>
                                â€¢ CarUxRestrictionsManager ë¯¸ì‚¬ìš©<br />
                                â€¢ ë¦¬ìŠ¤ë„ˆ ë¯¸ë“±ë¡<br />
                                â€¢ Driving State ê°ì§€ ì‹¤íŒ¨
                            </td>
                            <td>
                                â€¢ registerListener() í˜¸ì¶œ í™•ì¸<br />
                                â€¢ dumpsys car_serviceë¡œ Restrictions í™•ì¸<br />
                                â€¢ Vehicle HAL ë¡œê·¸ ë¶„ì„
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ” ë¯¸ë””ì–´ ì†ŒìŠ¤ ë³€ê²½ ì¶”ì </h3>
            <div class="code-block">
                <pre><code># ì‹¤ì‹œê°„ ë¯¸ë””ì–´ ì†ŒìŠ¤ ë³€ê²½ ëª¨ë‹ˆí„°ë§
adb logcat -s CarMediaService:V | grep -E "setMediaSource|onMediaSourceChanged"

# ì¶œë ¥ ì˜ˆì‹œ:
# CarMediaService: setMediaSource: com.spotify.music/.MainActivity
# CarMediaService: Updating active source
# CarMediaService: onMediaSourceChanged: com.spotify.music/.MainActivity
# CarMediaService: Saving LMS: com.spotify.music

# MediaSession ìƒíƒœ ë³€í™” ì¶”ì 
adb logcat -s MediaSessionService:V | grep -E "PlaybackState|Metadata"

# Audio Focus ìš”ì²­/í•´ì œ ì¶”ì 
adb logcat -s AudioManager:V | grep -E "requestAudioFocus|abandonAudioFocus"

# Zoneë³„ ì˜¤ë””ì˜¤ ë¼ìš°íŒ… ì¶”ì 
adb logcat -s CarAudioService:V | grep -E "zone|routing"</code></pre>
            </div>
        </section>

        <!-- Section 13: AOSP Source Reference -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">13</span>
                AOSP ì†ŒìŠ¤ ì½”ë“œ ì°¸ì¡°
            </h2>
            <p class="section-description">
                Car Media Serviceì˜ í•µì‹¬ ì†ŒìŠ¤ ì½”ë“œ ìœ„ì¹˜ ë° ì£¼ìš” íŒŒì¼ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“º</span>
                        CarMediaService
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>CarMediaService.java</strong></li>
                            <li>packages/services/Car/service/src/com/android/car/media/</li>
                            <li>Active Media Source ê´€ë¦¬</li>
                            <li>Last Media Source ì €ì¥/ë³µì›</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”Š</span>
                        CarAudioService
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>CarAudioService.java</strong></li>
                            <li>packages/services/Car/service/src/com/android/car/audio/</li>
                            <li>Audio Focus & Routing</li>
                            <li>Volume Groups, Multi-zone</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš—</span>
                        Car API
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>CarMediaManager.java</strong></li>
                            <li>packages/services/Car/car-lib/src/android/car/media/</li>
                            <li>Public API for apps</li>
                            <li>MediaSource management</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ“‚ ì£¼ìš” ë””ë ‰í† ë¦¬ êµ¬ì¡°</h3>
            <div class="code-block">
                <pre><code># CarMediaService ì†ŒìŠ¤
packages/services/Car/service/src/com/android/car/media/
â”œâ”€â”€ CarMediaService.java                # ë©”ì¸ ì„œë¹„ìŠ¤
â”œâ”€â”€ MediaSourceChangedListener.java     # ë¦¬ìŠ¤ë„ˆ ì¸í„°í˜ì´ìŠ¤
â””â”€â”€ PlaybackState.java                  # ì¬ìƒ ìƒíƒœ ê´€ë¦¬

# CarAudioService ì†ŒìŠ¤
packages/services/Car/service/src/com/android/car/audio/
â”œâ”€â”€ CarAudioService.java                # ë©”ì¸ ì˜¤ë””ì˜¤ ì„œë¹„ìŠ¤
â”œâ”€â”€ CarAudioZone.java                   # Zone ê´€ë¦¬
â”œâ”€â”€ CarVolumeGroup.java                 # Volume Group
â”œâ”€â”€ CarAudioFocus.java                  # Audio Focus ê´€ë¦¬
â”œâ”€â”€ CarAudioContext.java                # Audio Context ì •ì˜
â”œâ”€â”€ FocusInteraction.java               # Interaction Matrix
â””â”€â”€ CarAudioPlaybackCallback.java       # ì¬ìƒ ì½œë°±

# Car API (Public)
packages/services/Car/car-lib/src/android/car/media/
â”œâ”€â”€ CarMediaManager.java                # Media Manager API
â”œâ”€â”€ MediaSourceChangedListener.java     # Public ë¦¬ìŠ¤ë„ˆ
â””â”€â”€ PlaybackStateCallback.java          # ì¬ìƒ ìƒíƒœ ì½œë°±

packages/services/Car/car-lib/src/android/car/
â””â”€â”€ CarAudioManager.java                # Audio Manager API

# XML ì„¤ì • íŒŒì¼
hardware/[vendor]/[device]/audio/
â”œâ”€â”€ car_audio_configuration.xml         # ì˜¤ë””ì˜¤ Zone ë° Volume Groups
â””â”€â”€ audio_focus_configuration.xml       # Focus Interaction Matrix

# UX Restrictions
packages/services/Car/service/src/com/android/car/uxr/
â””â”€â”€ CarUxRestrictionsManagerService.java

# Vehicle HAL
hardware/interfaces/automotive/vehicle/
â””â”€â”€ 2.0/
    â””â”€â”€ IVehicle.hal                    # Vehicle ì¸í„°í˜ì´ìŠ¤</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸ” ì£¼ìš” í´ë˜ìŠ¤ ìƒì„¸</h3>
            <div class="code-block">
                <pre><code>// CarMediaService.java - í•µì‹¬ ë©”ì„œë“œ
public class CarMediaService extends ICarMedia.Stub {
    // Active Media Source ì„¤ì •
    public void setMediaSource(ComponentName componentName, int mode);

    // í˜„ì¬ Media Source ì¡°íšŒ
    public ComponentName getMediaSource();

    // Last Media Source ì¡°íšŒ
    public List&lt;ComponentName&gt; getLastMediaSources(int mode);

    // ë¦¬ìŠ¤ë„ˆ ë“±ë¡
    public void addMediaSourceListener(IMediaSourceListener listener);

    // ë¦¬ìŠ¤ë„ˆ ì œê±°
    public void removeMediaSourceListener(IMediaSourceListener listener);
}

// CarAudioService.java - í•µì‹¬ ë©”ì„œë“œ
public class CarAudioService extends ICarAudio.Stub {
    // Zoneë³„ Volume ì œì–´
    public void setGroupVolume(int zoneId, int groupId, int index, int flags);
    public int getGroupVolume(int zoneId, int groupId);
    public int getGroupMaxVolume(int zoneId, int groupId);

    // Volume Group ì¡°íšŒ
    public int getVolumeGroupCount(int zoneId);
    public int getVolumeGroupIdForUsage(int zoneId, int usage);

    // Audio Focus ê´€ë¦¬
    public int requestAudioFocusForUsage(int usage, int zoneId, int focusGain);
    public void abandonAudioFocusForUsage(int usage, int zoneId);

    // Zone ì •ë³´
    public int[] getAudioZoneIds();
    public boolean isAudioFeatureEnabled(int feature);
}

// CarAudioZone.java - Zone ê´€ë¦¬
public class CarAudioZone {
    private final int mId;
    private final String mName;
    private final List&lt;CarVolumeGroup&gt; mVolumeGroups;

    public int getId();
    public String getName();
    public List&lt;CarVolumeGroup&gt; getVolumeGroups();
    public CarVolumeGroup getVolumeGroup(int groupId);
}

// CarVolumeGroup.java - Volume Group
public class CarVolumeGroup {
    private final int mId;
    private final int mZoneId;
    private final SparseArray&lt;String&gt; mContextToAddress;  // Context â†’ Device Address

    public int getId();
    public void setCurrentGainIndex(int gainIndex);
    public int getCurrentGainIndex();
    public int getMaxGainIndex();
    public int getMinGainIndex();
}</code></pre>
            </div>

            <h3 style="color: var(--accent-primary); margin: 30px 0 20px 0; font-size: 1.5rem;">ğŸŒ ìœ ìš©í•œ AOSP ë§í¬</h3>
            <div class="code-block">
                <pre><code># CarMediaService ì†ŒìŠ¤
https://cs.android.com/android/platform/superproject/main/+/main:packages/services/Car/service/src/com/android/car/media/

# CarAudioService ì†ŒìŠ¤
https://cs.android.com/android/platform/superproject/main/+/main:packages/services/Car/service/src/com/android/car/audio/

# Car API (Public)
https://cs.android.com/android/platform/superproject/main/+/main:packages/services/Car/car-lib/src/android/car/media/

# AAOS ê³µì‹ ë¬¸ì„œ
https://source.android.com/docs/automotive

# Car Audio ë¬¸ì„œ
https://source.android.com/docs/automotive/audio

# UX Restrictions
https://source.android.com/docs/automotive/hmi/ux-restrictions</code></pre>
            </div>
        </section>

        <!-- Section 14: Related Documentation -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">14</span>
                ê´€ë ¨ ìƒì„¸ ë¬¸ì„œ
            </h2>
            <p class="section-description">
                Car Media Serviceì™€ ì—°ê´€ëœ ë‹¤ë¥¸ ì£¼ìš” ë¬¸ì„œ ë° ë¦¬ì†ŒìŠ¤ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”Š</span>
                        <a href="audio-framework.html" style="color: inherit; text-decoration: none;">
                            Audio Framework
                        </a>
                    </h3>
                    <div class="card-description">
                        AudioFlinger, AudioPolicyService, Audio HALê³¼ CarAudioServiceì˜ í†µí•©
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸµ</span>
                        <a href="mediasession.html" style="color: inherit; text-decoration: none;">
                            MediaSession
                        </a>
                    </h3>
                    <div class="card-description">
                        MediaSession í”„ë ˆì„ì›Œí¬ì™€ CarMediaServiceì˜ Active Source ê´€ë¦¬ ì—°ë™
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš—</span>
                        <a href="aaos.html" style="color: inherit; text-decoration: none;">
                            Android Automotive OS
                        </a>
                    </h3>
                    <div class="card-description">
                        AAOS ì „ì²´ ì•„í‚¤í…ì²˜, CarService, Vehicle HAL í†µí•©
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¬</span>
                        <a href="media-playback.html" style="color: inherit; text-decoration: none;">
                            Media Playback Pipeline
                        </a>
                    </h3>
                    <div class="card-description">
                        MediaPlayer, ExoPlayerì™€ CarAudioServiceì˜ ì˜¤ë””ì˜¤ ë¼ìš°íŒ… íŒŒì´í”„ë¼ì¸
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”‹</span>
                        <a href="power-policy-suspend.html" style="color: inherit; text-decoration: none;">
                            Power Policy & Suspend
                        </a>
                    </h3>
                    <div class="card-description">
                        ì°¨ëŸ‰ ì „ì› ê´€ë¦¬, Deep Sleep ë° Last Media Source ë³µì› íƒ€ì´ë°
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¯</span>
                        <a href="aaos-last-media.html" style="color: inherit; text-decoration: none;">
                            Last Media Source & Autoplay
                        </a>
                    </h3>
                    <div class="card-description">
                        LMS ë©”ì»¤ë‹ˆì¦˜ ìƒì„¸, ìë™ ì¬ìƒ ì •ì±…, ì‚¬ìš©ì ì„¤ì •
                    </div>
                </div>
            </div>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>ğŸ’¡ ì¶”ê°€ ë¦¬ì†ŒìŠ¤:</strong> Android ê³µì‹ ë¬¸ì„œ
                <a href="https://source.android.com/docs/automotive" target="_blank"
                   style="color: var(--accent-primary);">AOSP Automotive</a>,
                <a href="https://source.android.com/docs/automotive/audio" target="_blank"
                   style="color: var(--accent-primary);">Car Audio System</a>
            </div>
        </section>

        <!-- Footer -->
        <footer
            style="text-align: center; padding: 40px 20px; color: var(--text-muted); border-top: 1px solid var(--border-color); margin-top: 60px;">
            <p>Android Automotive OS Media Architecture</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                CarMediaService & CarAudioService Deep Dive
            </p>
            <p style="margin-top: 20px;">
                <a href="index.html" style="color: var(--accent-car); text-decoration: none;">
                    â† AOSP Media Frameworkë¡œ ëŒì•„ê°€ê¸°
                </a>
            </p>
        </footer>
    </div>

    <script src="scripts/mermaid-theme.js"></script>
    <script>
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(30px)';
            section.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
            observer.observe(section);
        });
    </script>
    <!-- Navigation & Copy Features -->
    <script src="scripts/copy-code.js"></script>
    <script src="scripts/toc-generator.js"></script>
    <script src="scripts/page-navigation.js"></script>
    <!-- Interactive Diagram Features -->
    <script src="scripts/diagram-data.js"></script>
    <script src="scripts/diagram-interactive.js"></script>

    <script src="scripts/theme-toggle.js"></script>
</body>

</html>