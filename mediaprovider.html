<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Android MediaProvider Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700;900&family=IBM+Plex+Mono:wght@400;500;600&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/design-system.css">

        <style>
        /* Page-specific styles */

        /* Header Action Button */
        .header-action {
            margin-top: 2rem;
        }

        .action-button {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.5rem;
            background: rgba(0, 212, 255, 0.08);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            color: var(--color-accent, #00d4ff);
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .action-button::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(139, 92, 246, 0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .action-button:hover {
            background: rgba(0, 212, 255, 0.15);
            border-color: rgba(0, 212, 255, 0.5);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.2),
                        0 4px 12px rgba(0, 0, 0, 0.3);
            transform: translateY(-2px);
        }

        .action-button:hover::before {
            opacity: 1;
        }

        .action-icon {
            font-size: 1.25rem;
            z-index: 1;
        }

        .action-text {
            z-index: 1;
        }

        .action-arrow {
            z-index: 1;
            transition: transform 0.3s ease;
        }

        .action-button:hover .action-arrow {
            transform: translateX(4px);
        }

        /* Light theme */
        [data-theme="light"] .action-button {
            background: rgba(0, 150, 200, 0.1);
            border-color: rgba(0, 150, 200, 0.3);
            color: #0096c8;
        }

        [data-theme="light"] .action-button:hover {
            background: rgba(0, 150, 200, 0.15);
            border-color: rgba(0, 150, 200, 0.5);
            box-shadow: 0 0 20px rgba(0, 150, 200, 0.15),
                        0 4px 12px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>
    <nav class="nav">
        <a href="index.html" class="nav-button">
            â† AOSP Media Framework
        </a>
    </nav>

    <div class="container">
        <header>
            <h1 class="page-title">ğŸ—„ï¸ MediaProvider</h1>
            <p class="page-subtitle">Android ë¯¸ë””ì–´ ë°ì´í„° ê´€ë¦¬ ë° Scoped Storage ì•„í‚¤í…ì²˜</p>
            <div class="header-action">
                <a href="media-playback.html" class="action-button">
                    <span class="action-icon">ğŸ¬</span>
                    <span class="action-text">ë¯¸ë””ì–´ ì¬ìƒ í”Œë¡œìš°</span>
                    <svg class="action-arrow" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="18" height="18">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                    </svg>
                </a>
            </div>
        </header>

        <!-- Section 1: Overview -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">1</span>
                Overview: MediaProviderì˜ ì—­í• 
            </h2>
            <p class="section-description">
                MediaProviderëŠ” Android ì‹œìŠ¤í…œì—ì„œ ë¯¸ë””ì–´ íŒŒì¼ì˜ ë©”íƒ€ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ê³ , ì•±ì˜ íŒŒì¼ ì ‘ê·¼ì„ ì œì–´í•˜ëŠ” í•µì‹¬ ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“Š</span>
                        MediaStore ê´€ë¦¬
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¸ë””ì–´ ë©”íƒ€ë°ì´í„° ì¸ë±ì‹±</strong></p>
                        <ul>
                            <li>Audio, Video, Images íŒŒì¼ì˜ ë©”íƒ€ë°ì´í„° ìµœì í™” ë° ì¸ë±ì‹±</li>
                            <li>ë‚´ë¶€/ì™¸ë¶€ ì €ì¥ì†Œ(SDì¹´ë“œ, USB) ìŠ¤ìº” ë° ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•</li>
                            <li><code>MediaStore</code> APIë¥¼ í†µí•œ ì•± ì ‘ê·¼ ì œê³µ</li>
                            <li>MIME íƒ€ì… ìë™ ê°ì§€ ë° ë¶„ë¥˜</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”’</span>
                        Scoped Storage ë³´ì•ˆ
                    </h3>
                    <div class="card-description">
                        <p><strong>ì•±ë³„ ê²©ë¦¬ëœ ì €ì¥ì†Œ</strong></p>
                        <ul>
                            <li>Android 10+ í•„ìˆ˜ ì ìš© (Scoped Storage)</li>
                            <li>ì•±ì€ ìì‹ ì˜ ë°ì´í„°ì—ë§Œ ì§ì ‘ ì ‘ê·¼ ê°€ëŠ¥</li>
                            <li>ë‹¤ë¥¸ ì•±ì˜ ë¯¸ë””ì–´ëŠ” <code>MediaStore</code>ë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼</li>
                            <li>ìœ„ì¹˜ ì •ë³´ ë“± ë¯¼ê° ë©”íƒ€ë°ì´í„° ìë™ ì‚­ì œ(Redaction)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš¡</span>
                        FUSE íŒŒì¼ ì‹œìŠ¤í…œ
                    </h3>
                    <div class="card-description">
                        <p><strong>User-space íŒŒì¼ í•¸ë“¤ë§</strong></p>
                        <ul>
                            <li>Android 11+ì—ì„œ FUSE Daemonìœ¼ë¡œ ë™ì‘</li>
                            <li>ì»¤ë„ íŒŒì¼ ì‘ì—…ì„ User-spaceì—ì„œ ê°€ë¡œì±„ê¸°</li>
                            <li>íŒŒì¼ ì ‘ê·¼ ì‹œ ì‹¤ì‹œê°„ ê¶Œí•œ ê²€ì‚¬ ë° í•„í„°ë§</li>
                            <li>FUSE Passthroughë¡œ ì„±ëŠ¥ ìµœì í™” (Android 12+)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”„</span>
                        Mainline ëª¨ë“ˆ
                    </h3>
                    <div class="card-description">
                        <p><strong>ë…ë¦½ ì—…ë°ì´íŠ¸ ê°€ëŠ¥</strong></p>
                        <ul>
                            <li>APK-in-APEX í˜•íƒœë¡œ ë°°í¬ (Android 11+)</li>
                            <li>OS ì—…ë°ì´íŠ¸ ì—†ì´ ë³´ì•ˆ íŒ¨ì¹˜ ë° ê¸°ëŠ¥ ì¶”ê°€</li>
                            <li>ìƒˆë¡œìš´ ë¯¸ë””ì–´ í¬ë§· ì§€ì› ì‹ ì† ëŒ€ì‘</li>
                            <li>Google Playë¥¼ í†µí•œ ìë™ ì—…ë°ì´íŠ¸</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Architecture -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">2</span>
                MediaProvider Architecture
            </h2>
            <p class="section-description">
                Applicationë¶€í„° File Systemê¹Œì§€ MediaProviderê°€ ê´€ì—¬í•˜ëŠ” ì „ì²´ ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    subgraph APP ["Application Layer"]
                    GALLERY["Gallery App"]
                    MUSIC["Music Player"]
                    CAMERA["Camera App"]
                    end

                    subgraph FRAMEWORK ["Android Framework"]
                    CR["ContentResolver"]
                    MS_API["MediaStore API<br />(Contract)"]
                    end

                    subgraph PROVIDER ["MediaProvider Module"]
                    MP["MediaProvider<br />(ContentProvider)"]
                    DB["SQLite Database<br />(Metadata)"]
                    SCANNER["Media Scanner"]
                    end

                    subgraph FUSE_LAYER ["FUSE Layer (Android 11+)"]
                    FD["FuseDaemon<br />(User-space Handler)"]
                    KERNEL_FUSE["FUSE Driver<br />(Kernel)"]
                    end

                    subgraph STORAGE ["File System"]
                    INT_STORAGE["Internal Storage"]
                    EXT_STORAGE["External Storage<br />(SD Card, USB)"]
                    end

                    APP --> CR
                    CR --> MS_API
                    MS_API --> MP
                    MP --> DB
                    MP --> SCANNER
                    MP <--> FD
                        FD <--> KERNEL_FUSE
                            KERNEL_FUSE <--> INT_STORAGE
                                KERNEL_FUSE <--> EXT_STORAGE
                                    SCANNER -.->|Scan Files| INT_STORAGE
                                    SCANNER -.->|Scan Files| EXT_STORAGE

                </div>
            </div>

            <div class="highlight-box">
                <strong>í•µì‹¬ í¬ì¸íŠ¸:</strong>
                <ul>
                    <li><strong>ContentResolver</strong>: ì•±ì´ MediaProviderì™€ í†µì‹ í•˜ëŠ” ìœ ì¼í•œ ì¸í„°í˜ì´ìŠ¤</li>
                    <li><strong>MediaProvider</strong>: ContentProviderë¥¼ êµ¬í˜„í•˜ì—¬ CRUD ì‘ì—… ì²˜ë¦¬</li>
                    <li><strong>FuseDaemon</strong>: íŒŒì¼ ì‹œìŠ¤í…œ ì‘ì—…ì„ ê°€ë¡œì±„ ê¶Œí•œ ê²€ì‚¬ ìˆ˜í–‰</li>
                    <li><strong>SQLite DB</strong>: ë¯¸ë””ì–´ ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥í•˜ì—¬ ë¹ ë¥¸ ì¿¼ë¦¬ ì§€ì›</li>
                </ul>
            </div>
        </section>

        <!-- Section 3: Data Flow -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">3</span>
                MediaStore Data Flow
            </h2>
            <p class="section-description">
                ì•±ì´ MediaStore APIë¥¼ í†µí•´ ë¯¸ë””ì–´ ë°ì´í„°ë¥¼ ì¿¼ë¦¬í•˜ê³  ì¡°ì‘í•˜ëŠ” ì „ì²´ íë¦„ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant App as Application
                    participant CR as ContentResolver
                    participant MP as MediaProvider
                    participant DB as SQLite DB
                    participant FS as File System

                    Note over App,FS: Query ì‘ì—… (ë¯¸ë””ì–´ ê²€ìƒ‰)
                    App->>CR: query(MediaStore.Images.EXTERNAL_CONTENT_URI)
                    CR->>MP: query() í˜¸ì¶œ
                    MP->>DB: SELECT * FROM images WHERE...
                    DB-->>MP: Cursor (ê²°ê³¼ì…‹)
                    MP-->>CR: Cursor ë°˜í™˜
                    CR-->>App: Cursor ë°˜í™˜
                    App->>App: Cursor ìˆœíšŒ ë° ë°ì´í„° ì¶”ì¶œ

                    Note over App,FS: Insert ì‘ì—… (ìƒˆ ë¯¸ë””ì–´ ì¶”ê°€)
                    App->>CR: insert(uri, ContentValues)
                    CR->>MP: insert() í˜¸ì¶œ
                    MP->>DB: INSERT INTO images VALUES(...)
                    DB-->>MP: Row ID
                    MP->>FS: íŒŒì¼ ìƒì„± ì¤€ë¹„
                    MP-->>CR: ìƒˆ ë¯¸ë””ì–´ URI ë°˜í™˜
                    CR-->>App: URI ë°˜í™˜
                    App->>FS: OutputStreamìœ¼ë¡œ íŒŒì¼ ì“°ê¸°

                    Note over App,FS: Delete ì‘ì—… (ë¯¸ë””ì–´ ì‚­ì œ)
                    App->>CR: delete(uri)
                    CR->>MP: delete() í˜¸ì¶œ
                    MP->>DB: DELETE FROM images WHERE _id=...
                    MP->>FS: ì‹¤ì œ íŒŒì¼ ì‚­ì œ
                    FS-->>MP: ì‚­ì œ ì™„ë£Œ
                    MP-->>CR: ì‚­ì œëœ í–‰ ìˆ˜ ë°˜í™˜
                    CR-->>App: ê²°ê³¼ ë°˜í™˜
                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        Query (ì¡°íšŒ)
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¸ë””ì–´ ê²€ìƒ‰ ë° í•„í„°ë§</strong></p>
                        <ul>
                            <li><code>contentResolver.query()</code> í˜¸ì¶œ</li>
                            <li>MediaProviderê°€ SQLite DBì—ì„œ ë©”íƒ€ë°ì´í„° ê²€ìƒ‰</li>
                            <li>Cursor ê°ì²´ë¡œ ê²°ê³¼ ë°˜í™˜ (Worker Thread ê¶Œì¥)</li>
                            <li>Projection, Selection, Sort Order ì§€ì›</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">â•</span>
                        Insert (ì¶”ê°€)
                    </h3>
                    <div class="card-description">
                        <p><strong>ìƒˆ ë¯¸ë””ì–´ íŒŒì¼ ë“±ë¡</strong></p>
                        <ul>
                            <li><code>contentResolver.insert()</code>ë¡œ ë©”íƒ€ë°ì´í„° ë“±ë¡</li>
                            <li>MediaProviderê°€ DBì— ë ˆì½”ë“œ ìƒì„±</li>
                            <li>ìƒˆ ë¯¸ë””ì–´ URI ë°˜í™˜ (íŒŒì¼ ê²½ë¡œ í¬í•¨)</li>
                            <li>OutputStreamìœ¼ë¡œ ì‹¤ì œ íŒŒì¼ ë°ì´í„° ì“°ê¸°</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âœï¸</span>
                        Update (ìˆ˜ì •)
                    </h3>
                    <div class="card-description">
                        <p><strong>ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸</strong></p>
                        <ul>
                            <li><code>contentResolver.update()</code>ë¡œ ìˆ˜ì •</li>
                            <li>ìì‹ ì˜ ë¯¸ë””ì–´ëŠ” ììœ ë¡­ê²Œ ìˆ˜ì • ê°€ëŠ¥</li>
                            <li>ë‹¤ë¥¸ ì•±ì˜ ë¯¸ë””ì–´ëŠ” ì‚¬ìš©ì ë™ì˜ í•„ìš”</li>
                            <li><code>is_favorite</code>, <code>is_trashed</code> ë“± í”Œë˜ê·¸ ë³€ê²½</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ—‘ï¸</span>
                        Delete (ì‚­ì œ)
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¸ë””ì–´ íŒŒì¼ ì œê±°</strong></p>
                        <ul>
                            <li><code>contentResolver.delete()</code>ë¡œ ì‚­ì œ</li>
                            <li>DB ë ˆì½”ë“œ ë° ì‹¤ì œ íŒŒì¼ ëª¨ë‘ ì œê±°</li>
                            <li>ë‹¤ë¥¸ ì•±ì˜ ë¯¸ë””ì–´ ì‚­ì œ ì‹œ ì‚¬ìš©ì í™•ì¸ í•„ìš”</li>
                            <li>íœ´ì§€í†µ(<code>is_trashed</code>) ê¸°ëŠ¥ ì§€ì› (Android 11+)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Scoped Storage -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">4</span>
                Scoped Storage Model
            </h2>
            <p class="section-description">
                Android 10ë¶€í„° ë„ì…ëœ Scoped StorageëŠ” ì•±ì˜ íŒŒì¼ ì ‘ê·¼ì„ ì œí•œí•˜ì—¬ ì‚¬ìš©ì í”„ë¼ì´ë²„ì‹œë¥¼ ê°•í™”í•©ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    flowchart TB
                    subgraph LEGACY ["Legacy Storage (Android 9 ì´í•˜)"]
                    L_APP["App"]
                    L_PERM["READ/WRITE_EXTERNAL_STORAGE"]
                    L_FS["ì „ì²´ íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼"]

                    L_APP --> L_PERM
                    L_PERM --> L_FS
                    end

                    subgraph SCOPED ["Scoped Storage (Android 10+)"]
                    S_APP["App"]
                    S_OWN["ìì‹ ì˜ ì•± ì „ìš© ë””ë ‰í† ë¦¬<br />(ê¶Œí•œ ë¶ˆí•„ìš”)"]
                    S_MEDIA["MediaStoreë¥¼ í†µí•œ<br />ë¯¸ë””ì–´ ì ‘ê·¼"]
                    S_SAF["Storage Access Framework<br />(ì‚¬ìš©ì ì„ íƒ)"]

                    S_APP --> S_OWN
                    S_APP --> S_MEDIA
                    S_APP --> S_SAF
                    end

                    LEGACY -.->|Android 10+| SCOPED

                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ </span>
                        App-specific Directory
                    </h3>
                    <div class="card-description">
                        <p><strong>ì•± ì „ìš© ì €ì¥ì†Œ</strong></p>
                        <ul>
                            <li><code>getExternalFilesDir()</code>ë¡œ ì ‘ê·¼</li>
                            <li>ê¶Œí•œ ì—†ì´ ì½ê¸°/ì“°ê¸° ê°€ëŠ¥</li>
                            <li>ì•± ì‚­ì œ ì‹œ ìë™ìœ¼ë¡œ ë°ì´í„° ì œê±°</li>
                            <li>ë‹¤ë¥¸ ì•±ì€ ì ‘ê·¼ ë¶ˆê°€ (ê²©ë¦¬)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“¸</span>
                        MediaStore Collections
                    </h3>
                    <div class="card-description">
                        <p><strong>ê³µìœ  ë¯¸ë””ì–´ ì ‘ê·¼</strong></p>
                        <ul>
                            <li>ìì‹ ì˜ ë¯¸ë””ì–´: ê¶Œí•œ ë¶ˆí•„ìš”</li>
                            <li>ë‹¤ë¥¸ ì•±ì˜ ë¯¸ë””ì–´ ì½ê¸°: <code>READ_MEDIA_*</code> ê¶Œí•œ</li>
                            <li>ë‹¤ë¥¸ ì•±ì˜ ë¯¸ë””ì–´ ìˆ˜ì •: ì‚¬ìš©ì ë™ì˜ í•„ìš”</li>
                            <li><code>Images</code>, <code>Video</code>, <code>Audio</code> ì»¬ë ‰ì…˜</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        Privacy Protection
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¼ê° ì •ë³´ ë³´í˜¸</strong></p>
                        <ul>
                            <li>ìœ„ì¹˜ ë©”íƒ€ë°ì´í„° ìë™ ì‚­ì œ (Redaction)</li>
                            <li>ì•± í´ëŸ¬í„° ë°©ì§€ (ì•± ì‚­ì œ ì‹œ ë°ì´í„° ì •ë¦¬)</li>
                            <li>íŒŒì¼ ì ‘ê·¼ ì´ë ¥ ì¶”ì  ê°€ëŠ¥</li>
                            <li>ì‚¬ìš©ì ì¤‘ì‹¬ì˜ ê¶Œí•œ ëª¨ë¸</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš™ï¸</span>
                        Special Permissions
                    </h3>
                    <div class="card-description">
                        <p><strong>íŠ¹ìˆ˜ ê¶Œí•œ</strong></p>
                        <ul>
                            <li><code>MANAGE_EXTERNAL_STORAGE</code>: ì „ì²´ íŒŒì¼ ì ‘ê·¼</li>
                            <li>íŒŒì¼ ê´€ë¦¬ì, ë°±ì—… ì•± ë“±ì—ë§Œ í—ˆìš©</li>
                            <li>Play Store ì •ì±…ìœ¼ë¡œ ì—„ê²©íˆ ì œí•œ</li>
                            <li>ì¼ë°˜ ì•±ì€ MediaStore/SAF ì‚¬ìš© ê¶Œì¥</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: FUSE Daemon -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">5</span>
                FUSE Daemon Architecture
            </h2>
            <p class="section-description">
                Android 11ë¶€í„° MediaProviderëŠ” FUSE(Filesystem in Userspace) ë°ëª¬ìœ¼ë¡œ ë™ì‘í•˜ì—¬ íŒŒì¼ ì ‘ê·¼ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì œì–´í•©ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant App as Application
                    participant Kernel as FUSE Driver (Kernel)
                    participant FD as FuseDaemon (MediaProvider)
                    participant FS as Underlying File System

                    Note over App,FS: íŒŒì¼ ì—´ê¸° (open)
                    App->>Kernel: open("/storage/emulated/0/DCIM/photo.jpg")
                    Kernel->>FD: FUSE_OPEN ìš”ì²­
                    FD->>FD: ê¶Œí•œ ê²€ì‚¬ (ì•± UID, íŒŒì¼ ì†Œìœ ì)
                    alt ê¶Œí•œ ìˆìŒ
                    FD->>FS: ì‹¤ì œ íŒŒì¼ ì—´ê¸°
                    FS-->>FD: File Descriptor
                    FD->>Kernel: FUSE Passthrough ì„¤ì • (Android 12+)
                    FD-->>Kernel: í—ˆìš© ì‘ë‹µ
                    Kernel-->>App: File Descriptor ë°˜í™˜
                    else ê¶Œí•œ ì—†ìŒ
                    FD-->>Kernel: ê±°ë¶€ ì‘ë‹µ (EACCES)
                    Kernel-->>App: ì—ëŸ¬ ë°˜í™˜
                    end

                    Note over App,FS: íŒŒì¼ ì½ê¸° (read) - Passthrough í™œì„±í™” ì‹œ
                    App->>Kernel: read(fd, buffer, size)
                    Kernel->>FS: ì§ì ‘ ì½ê¸° (FuseDaemon ìš°íšŒ)
                    FS-->>Kernel: ë°ì´í„°
                    Kernel-->>App: ë°ì´í„° ë°˜í™˜
                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ›¡ï¸</span>
                        Access Control
                    </h3>
                    <div class="card-description">
                        <p><strong>ì‹¤ì‹œê°„ ê¶Œí•œ ê²€ì‚¬</strong></p>
                        <ul>
                            <li>ëª¨ë“  íŒŒì¼ ì‘ì—…ì„ User-spaceì—ì„œ ê°€ë¡œì±„ê¸°</li>
                            <li>ì•± UIDì™€ íŒŒì¼ ì†Œìœ ì ë¹„êµ</li>
                            <li>Scoped Storage ì •ì±… ì ìš©</li>
                            <li>í—ˆìš©/ê±°ë¶€/Redaction ê²°ì •</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš¡</span>
                        FUSE Passthrough
                    </h3>
                    <div class="card-description">
                        <p><strong>ì„±ëŠ¥ ìµœì í™” (Android 12+)</strong></p>
                        <ul>
                            <li>ê¶Œí•œ í™•ì¸ í›„ ì§ì ‘ íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼ í—ˆìš©</li>
                            <li>Read/Write ì‘ì—… ì‹œ FuseDaemon ìš°íšŒ</li>
                            <li>User-space â†” Kernel-space ì „í™˜ ì˜¤ë²„í—¤ë“œ ì œê±°</li>
                            <li>I/O ì„±ëŠ¥ ëŒ€í­ í–¥ìƒ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”„</span>
                        JNI Integration
                    </h3>
                    <div class="card-description">
                        <p><strong>Java â†” Native í†µì‹ </strong></p>
                        <ul>
                            <li>FuseDaemonì€ C++ Native ì½”ë“œë¡œ êµ¬í˜„</li>
                            <li>MediaProviderWrapperë¡œ Java ë ˆì´ì–´ì™€ í†µì‹ </li>
                            <li>ê¶Œí•œ ê²€ì‚¬ ë¡œì§ì€ Javaì—ì„œ ì²˜ë¦¬</li>
                            <li><code>/dev/fuse</code> ë…¸ë“œë¥¼ í†µí•œ ì»¤ë„ í†µì‹ </li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš€</span>
                        Per-User Instance
                    </h3>
                    <div class="card-description">
                        <p><strong>ì‚¬ìš©ìë³„ ë°ëª¬</strong></p>
                        <ul>
                            <li>ê° ì‚¬ìš©ì(u0, u10 ë“±)ë§ˆë‹¤ FuseDaemon ì¸ìŠ¤í„´ìŠ¤ ìƒì„±</li>
                            <li>ë¶€íŒ… ì‹œ ì‹œì‘, ì¢…ë£Œ ì‹œê¹Œì§€ ì§€ì† ì‹¤í–‰</li>
                            <li><code>fuse_session_loop_mt</code>ë¡œ ë©€í‹°ìŠ¤ë ˆë“œ ì²˜ë¦¬</li>
                            <li>ì‚¬ìš©ìë³„ ë…ë¦½ì ì¸ íŒŒì¼ ì ‘ê·¼ ì œì–´</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6: Code Examples -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">6</span>
                ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ
            </h2>
            <p class="section-description">
                MediaStore APIë¥¼ ì‚¬ìš©í•œ ì‹¤ì œ êµ¬í˜„ ì½”ë“œì™€ Scoped Storage ë§ˆì´ê·¸ë ˆì´ì…˜ ì˜ˆì‹œë¥¼ ì œê³µí•©ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-bottom: 20px;">
                ğŸ” MediaStore Query (ì´ë¯¸ì§€ ì¡°íšŒ)
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// MediaStoreì—ì„œ ì´ë¯¸ì§€ ì¡°íšŒ
fun queryImages(context: Context): List<ImageData> {
    val images = mutableListOf<ImageData>()

    // Projection (ë°˜í™˜í•  ì»¬ëŸ¼ ì§€ì •)
    val projection = arrayOf(
        MediaStore.Images.Media._ID,
        MediaStore.Images.Media.DISPLAY_NAME,
        MediaStore.Images.Media.SIZE,
        MediaStore.Images.Media.DATE_ADDED,
        MediaStore.Images.Media.MIME_TYPE,
        MediaStore.Images.Media.WIDTH,
        MediaStore.Images.Media.HEIGHT
    )

    // Selection (WHERE ì ˆ)
    val selection = "${MediaStore.Images.Media.SIZE} > ?"
    val selectionArgs = arrayOf("10240") // 10KB ì´ìƒ

    // Sort Order
    val sortOrder = "${MediaStore.Images.Media.DATE_ADDED} DESC"

    // ContentResolverë¡œ ì¿¼ë¦¬
    context.contentResolver.query(
        MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
        projection,
        selection,
        selectionArgs,
        sortOrder
    )?.use { cursor ->
        val idColumn = cursor.getColumnIndexOrThrow(MediaStore.Images.Media._ID)
        val nameColumn = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DISPLAY_NAME)
        val sizeColumn = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.SIZE)
        val dateColumn = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATE_ADDED)
        val mimeColumn = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.MIME_TYPE)

        while (cursor.moveToNext()) {
            val id = cursor.getLong(idColumn)
            val name = cursor.getString(nameColumn)
            val size = cursor.getLong(sizeColumn)
            val dateAdded = cursor.getLong(dateColumn)
            val mimeType = cursor.getString(mimeColumn)

            // Content URI ìƒì„±
            val contentUri = ContentUris.withAppendedId(
                MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                id
            )

            images.add(ImageData(id, name, size, dateAdded, mimeType, contentUri))
        }
    }

    return images
}

data class ImageData(
    val id: Long,
    val name: String,
    val size: Long,
    val dateAdded: Long,
    val mimeType: String,
    val uri: Uri
)</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                â• MediaStore Insert (ìƒˆ ì´ë¯¸ì§€ ì €ì¥)
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// ìƒˆ ì´ë¯¸ì§€ë¥¼ MediaStoreì— ì €ì¥
fun saveImageToMediaStore(context: Context, bitmap: Bitmap, displayName: String): Uri? {
    // ContentValues ì„¤ì •
    val contentValues = ContentValues().apply {
        put(MediaStore.Images.Media.DISPLAY_NAME, displayName)
        put(MediaStore.Images.Media.MIME_TYPE, "image/jpeg")
        put(MediaStore.Images.Media.WIDTH, bitmap.width)
        put(MediaStore.Images.Media.HEIGHT, bitmap.height)

        // Android 10+ (Scoped Storage)
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
            put(MediaStore.Images.Media.RELATIVE_PATH, Environment.DIRECTORY_PICTURES)
            put(MediaStore.Images.Media.IS_PENDING, 1) // ì‘ì—… ì¤‘ ìƒíƒœ
        }
    }

    // MediaStoreì— ë ˆì½”ë“œ ì‚½ì…
    val uri = context.contentResolver.insert(
        MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
        contentValues
    ) ?: return null

    try {
        // OutputStreamìœ¼ë¡œ íŒŒì¼ ì“°ê¸°
        context.contentResolver.openOutputStream(uri)?.use { outputStream ->
            bitmap.compress(Bitmap.CompressFormat.JPEG, 95, outputStream)
        }

        // Android 10+: IS_PENDING í”Œë˜ê·¸ í•´ì œ (ì™„ë£Œ ìƒíƒœ)
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
            contentValues.clear()
            contentValues.put(MediaStore.Images.Media.IS_PENDING, 0)
            context.contentResolver.update(uri, contentValues, null, null)
        }

        return uri
    } catch (e: IOException) {
        // ì—ëŸ¬ ë°œìƒ ì‹œ ë ˆì½”ë“œ ì‚­ì œ
        context.contentResolver.delete(uri, null, null)
        return null
    }
}

// Bitmapì„ íŒŒì¼ë¡œ ì €ì¥í•˜ê³  MediaScannerë¡œ ìŠ¤ìº” (Legacy ë°©ì‹)
fun saveBitmapLegacy(context: Context, bitmap: Bitmap, filename: String) {
    val file = File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES), filename)

    FileOutputStream(file).use { out ->
        bitmap.compress(Bitmap.CompressFormat.JPEG, 95, out)
    }

    // MediaScannerConnectionìœ¼ë¡œ ìŠ¤ìº” ìš”ì²­
    MediaScannerConnection.scanFile(
        context,
        arrayOf(file.absolutePath),
        arrayOf("image/jpeg")
    ) { path, uri ->
        Log.d("MediaScanner", "Scanned: $path -> $uri")
    }
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                âœï¸ MediaStore Update & Delete
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸ (Favorite ì„¤ì •)
fun markAsFavorite(context: Context, imageUri: Uri) {
    val contentValues = ContentValues().apply {
        put(MediaStore.Images.Media.IS_FAVORITE, 1)
    }

    try {
        context.contentResolver.update(imageUri, contentValues, null, null)
    } catch (e: RecoverableSecurityException) {
        // Android 10+: ë‹¤ë¥¸ ì•±ì˜ íŒŒì¼ ìˆ˜ì • ì‹œ ì‚¬ìš©ì ë™ì˜ í•„ìš”
        val intentSender = e.userAction.actionIntent.intentSender
        startIntentSenderForResult(intentSender, REQUEST_CODE_MODIFY, null, 0, 0, 0, null)
    }
}

// ì´ë¯¸ì§€ ì‚­ì œ
fun deleteImage(context: Context, imageUri: Uri): Boolean {
    return try {
        val deletedRows = context.contentResolver.delete(imageUri, null, null)
        deletedRows > 0
    } catch (e: RecoverableSecurityException) {
        // ì‚¬ìš©ì ë™ì˜ í•„ìš”
        val intentSender = e.userAction.actionIntent.intentSender
        startIntentSenderForResult(intentSender, REQUEST_CODE_DELETE, null, 0, 0, 0, null)
        false
    }
}

// Activityì˜ onActivityResultì—ì„œ ì²˜ë¦¬
override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
    super.onActivityResult(requestCode, resultCode, data)

    when (requestCode) {
        REQUEST_CODE_MODIFY, REQUEST_CODE_DELETE -> {
            if (resultCode == Activity.RESULT_OK) {
                // ì‚¬ìš©ìê°€ ìŠ¹ì¸ â†’ ì‘ì—… ì¬ì‹œë„
                retryPendingOperation()
            } else {
                // ì‚¬ìš©ìê°€ ê±°ë¶€
                Toast.makeText(this, "ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤", Toast.LENGTH_SHORT).show()
            }
        }
    }
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ“‚ Storage Access Framework (SAF)
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// SAFë¡œ íŒŒì¼ ì„ íƒ (ì‚¬ìš©ìê°€ ì§ì ‘ ì„ íƒ)
fun openFilePicker() {
    val intent = Intent(Intent.ACTION_OPEN_DOCUMENT).apply {
        addCategory(Intent.CATEGORY_OPENABLE)
        type = "image/*"

        // ì—¬ëŸ¬ íŒŒì¼ ì„ íƒ í—ˆìš©
        putExtra(Intent.EXTRA_ALLOW_MULTIPLE, true)
    }
    startActivityForResult(intent, REQUEST_CODE_PICK_FILE)
}

// íŒŒì¼ ì„ íƒ ê²°ê³¼ ì²˜ë¦¬
override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
    super.onActivityResult(requestCode, resultCode, data)

    if (requestCode == REQUEST_CODE_PICK_FILE && resultCode == Activity.RESULT_OK) {
        data?.data?.let { uri ->
            // ë‹¨ì¼ íŒŒì¼ ì„ íƒ
            processFile(uri)
        }

        // ì—¬ëŸ¬ íŒŒì¼ ì„ íƒ
        data?.clipData?.let { clipData ->
            for (i in 0 until clipData.itemCount) {
                val uri = clipData.getItemAt(i).uri
                processFile(uri)
            }
        }
    }
}

// ì„ íƒí•œ íŒŒì¼ ì²˜ë¦¬
fun processFile(uri: Uri) {
    contentResolver.openInputStream(uri)?.use { inputStream ->
        val bitmap = BitmapFactory.decodeStream(inputStream)
        // Bitmap ì²˜ë¦¬...
    }

    // íŒŒì¼ ë©”íƒ€ë°ì´í„° ì¡°íšŒ
    contentResolver.query(uri, null, null, null, null)?.use { cursor ->
        if (cursor.moveToFirst()) {
            val displayNameIndex = cursor.getColumnIndex(OpenableColumns.DISPLAY_NAME)
            val sizeIndex = cursor.getColumnIndex(OpenableColumns.SIZE)

            val displayName = cursor.getString(displayNameIndex)
            val size = cursor.getLong(sizeIndex)

            Log.d("SAF", "File: $displayName, Size: $size bytes")
        }
    }

    // ì˜êµ¬ ê¶Œí•œ ë¶€ì—¬ (ì•± ì¬ì‹œì‘ í›„ì—ë„ ì ‘ê·¼ ê°€ëŠ¥)
    val takeFlags = Intent.FLAG_GRANT_READ_URI_PERMISSION or Intent.FLAG_GRANT_WRITE_URI_PERMISSION
    contentResolver.takePersistableUriPermission(uri, takeFlags)
}</code></pre>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>ğŸ’¡ ì½”ë“œ ì˜ˆì‹œ í•µì‹¬ í¬ì¸íŠ¸:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>Query</strong>: projectionìœ¼ë¡œ í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ì¡°íšŒ, cursor.useë¡œ ìë™ close</li>
                    <li><strong>Insert</strong>: IS_PENDING í”Œë˜ê·¸ë¡œ ì‘ì—… ì¤‘/ì™„ë£Œ ìƒíƒœ ê´€ë¦¬ (Android 10+)</li>
                    <li><strong>Update/Delete</strong>: RecoverableSecurityExceptionìœ¼ë¡œ ì‚¬ìš©ì ë™ì˜ ì²˜ë¦¬</li>
                    <li><strong>SAF</strong>: ì‚¬ìš©ìê°€ ì§ì ‘ íŒŒì¼ ì„ íƒ, takePersistableUriPermissionìœ¼ë¡œ ì˜êµ¬ ê¶Œí•œ</li>
                    <li><strong>Worker Thread</strong>: ëª¨ë“  ContentResolver ì‘ì—…ì€ ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ ê¶Œì¥</li>
                </ul>
            </div>
        </section>

        <!-- Section 7: Permissions & User Consent -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">7</span>
                ê¶Œí•œ ëª¨ë¸ & ì‚¬ìš©ì ë™ì˜
            </h2>
            <p class="section-description">
                Android ë²„ì „ë³„ ê¶Œí•œ ëª¨ë¸ê³¼ ì‚¬ìš©ì ë™ì˜ ì²˜ë¦¬ ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    flowchart TB
                    START[ì•±ì—ì„œ ë¯¸ë””ì–´ ì ‘ê·¼ ì‹œë„] --> VERSION{Android ë²„ì „}

                    VERSION -->|Android 12 ì´í•˜| OLD_PERM[READ_EXTERNAL_STORAGE]
                    VERSION -->|Android 13+| NEW_PERM[READ_MEDIA_IMAGES<br />READ_MEDIA_VIDEO<br />READ_MEDIA_AUDIO]

                    OLD_PERM --> CHECK_OLD{ê¶Œí•œ ìˆìŒ?}
                    NEW_PERM --> CHECK_NEW{ê¶Œí•œ ìˆìŒ?}

                    CHECK_OLD -->|Yes| OWN{ìì‹ ì˜ íŒŒì¼?}
                    CHECK_OLD -->|No| REQUEST_OLD[ê¶Œí•œ ìš”ì²­]

                    CHECK_NEW -->|Yes| OWN
                    CHECK_NEW -->|No| REQUEST_NEW[Granular ê¶Œí•œ ìš”ì²­]

                    OWN -->|Yes| FULL_ACCESS[ì½ê¸°/ì“°ê¸° ê°€ëŠ¥]
                    OWN -->|No| READ_ONLY[ì½ê¸°ë§Œ ê°€ëŠ¥]

                    READ_ONLY --> MODIFY{ìˆ˜ì •/ì‚­ì œ?}
                    MODIFY -->|Yes| USER_CONSENT[RecoverableSecurityException<br />ì‚¬ìš©ì ë™ì˜ ìš”ì²­]
                    MODIFY -->|No| SUCCESS[ì‘ì—… ì™„ë£Œ]

                    USER_CONSENT --> APPROVE{ìŠ¹ì¸?}
                    APPROVE -->|Yes| FULL_ACCESS
                    APPROVE -->|No| DENIED[ì‘ì—… ê±°ë¶€]

                    REQUEST_OLD --> GRANTED_OLD{ìŠ¹ì¸?}
                    REQUEST_NEW --> GRANTED_NEW{ìŠ¹ì¸?}

                    GRANTED_OLD -->|Yes| OWN
                    GRANTED_OLD -->|No| DENIED

                    GRANTED_NEW -->|Yes| OWN
                    GRANTED_NEW -->|No| DENIED
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ“± Android 13+ Granular ê¶Œí•œ
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// AndroidManifest.xml
&lt;manifest&gt;
    &lt;!-- Android 13+ Granular ê¶Œí•œ --&gt;
    &lt;uses-permission android:name="android.permission.READ_MEDIA_IMAGES" /&gt;
    &lt;uses-permission android:name="android.permission.READ_MEDIA_VIDEO" /&gt;
    &lt;uses-permission android:name="android.permission.READ_MEDIA_AUDIO" /&gt;

    &lt;!-- Android 12 ì´í•˜ í˜¸í™˜ì„± --&gt;
    &lt;uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"
                     android:maxSdkVersion="32" /&gt;
    &lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"
                     android:maxSdkVersion="29" /&gt;

    &lt;!-- íŠ¹ìˆ˜ ê¶Œí•œ (íŒŒì¼ ê´€ë¦¬ì ì•± ë“±) --&gt;
    &lt;uses-permission android:name="android.permission.MANAGE_EXTERNAL_STORAGE"
                     tools:ignore="ScopedStorage" /&gt;
&lt;/manifest&gt;

// Kotlin ê¶Œí•œ ìš”ì²­
class MainActivity : AppCompatActivity() {

    private val requestPermissionLauncher = registerForActivityResult(
        ActivityResultContracts.RequestMultiplePermissions()
    ) { permissions ->
        val allGranted = permissions.entries.all { it.value }
        if (allGranted) {
            loadMedia()
        } else {
            Toast.makeText(this, "ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤", Toast.LENGTH_SHORT).show()
        }
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        checkAndRequestPermissions()
    }

    private fun checkAndRequestPermissions() {
        val permissions = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
            // Android 13+: Granular ê¶Œí•œ
            arrayOf(
                Manifest.permission.READ_MEDIA_IMAGES,
                Manifest.permission.READ_MEDIA_VIDEO,
                Manifest.permission.READ_MEDIA_AUDIO
            )
        } else {
            // Android 12 ì´í•˜
            arrayOf(Manifest.permission.READ_EXTERNAL_STORAGE)
        }

        val notGranted = permissions.filter {
            ContextCompat.checkSelfPermission(this, it) != PackageManager.PERMISSION_GRANTED
        }

        if (notGranted.isNotEmpty()) {
            requestPermissionLauncher.launch(notGranted.toTypedArray())
        } else {
            loadMedia()
        }
    }
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ” RecoverableSecurityException ì²˜ë¦¬
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// ë‹¤ë¥¸ ì•±ì´ ë§Œë“  íŒŒì¼ ìˆ˜ì •/ì‚­ì œ ì‹œ ì‚¬ìš©ì ë™ì˜ ì²˜ë¦¬
class MediaEditor : AppCompatActivity() {

    private val modifyRequestLauncher = registerForActivityResult(
        ActivityResultContracts.StartIntentSenderForResult()
    ) { result ->
        if (result.resultCode == Activity.RESULT_OK) {
            // ì‚¬ìš©ìê°€ ìŠ¹ì¸ â†’ ì‘ì—… ì¬ì‹œë„
            pendingUri?.let { uri ->
                when (pendingAction) {
                    Action.UPDATE -> updateMediaItem(uri)
                    Action.DELETE -> deleteMediaItem(uri)
                }
            }
        } else {
            Toast.makeText(this, "ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤", Toast.LENGTH_SHORT).show()
        }
        pendingUri = null
        pendingAction = null
    }

    private var pendingUri: Uri? = null
    private var pendingAction: Action? = null

    enum class Action {
        UPDATE, DELETE
    }

    fun updateMediaItem(uri: Uri) {
        val contentValues = ContentValues().apply {
            put(MediaStore.Images.Media.IS_FAVORITE, 1)
        }

        try {
            contentResolver.update(uri, contentValues, null, null)
            Toast.makeText(this, "ì—…ë°ì´íŠ¸ ì™„ë£Œ", Toast.LENGTH_SHORT).show()
        } catch (e: RecoverableSecurityException) {
            // Android 10+: ì‚¬ìš©ì ë™ì˜ í•„ìš”
            pendingUri = uri
            pendingAction = Action.UPDATE

            val intentSender = e.userAction.actionIntent.intentSender
            val request = IntentSenderRequest.Builder(intentSender).build()
            modifyRequestLauncher.launch(request)
        } catch (e: SecurityException) {
            // ê¶Œí•œ ì—†ìŒ
            Toast.makeText(this, "ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤", Toast.LENGTH_SHORT).show()
        }
    }

    fun deleteMediaItem(uri: Uri) {
        try {
            val deletedRows = contentResolver.delete(uri, null, null)
            if (deletedRows > 0) {
                Toast.makeText(this, "ì‚­ì œ ì™„ë£Œ", Toast.LENGTH_SHORT).show()
            }
        } catch (e: RecoverableSecurityException) {
            pendingUri = uri
            pendingAction = Action.DELETE

            val intentSender = e.userAction.actionIntent.intentSender
            val request = IntentSenderRequest.Builder(intentSender).build()
            modifyRequestLauncher.launch(request)
        }
    }
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                âš™ï¸ MANAGE_EXTERNAL_STORAGE íŠ¹ìˆ˜ ê¶Œí•œ
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// MANAGE_EXTERNAL_STORAGE ê¶Œí•œ ìš”ì²­ (íŒŒì¼ ê´€ë¦¬ì ì•±)
fun requestManageExternalStorage() {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
        if (!Environment.isExternalStorageManager()) {
            val intent = Intent(Settings.ACTION_MANAGE_APP_ALL_FILES_ACCESS_PERMISSION).apply {
                data = Uri.parse("package:$packageName")
            }
            startActivityForResult(intent, REQUEST_CODE_MANAGE_STORAGE)
        } else {
            // ì´ë¯¸ ê¶Œí•œ ìˆìŒ
            accessAllFiles()
        }
    } else {
        // Android 10 ì´í•˜: WRITE_EXTERNAL_STORAGE ì‚¬ìš©
        requestPermissions(arrayOf(Manifest.permission.WRITE_EXTERNAL_STORAGE), REQUEST_CODE_STORAGE)
    }
}

override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
    super.onActivityResult(requestCode, resultCode, data)

    if (requestCode == REQUEST_CODE_MANAGE_STORAGE) {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
            if (Environment.isExternalStorageManager()) {
                accessAllFiles()
            } else {
                Toast.makeText(this, "All Files Accessê°€ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤", Toast.LENGTH_SHORT).show()
            }
        }
    }
}

fun accessAllFiles() {
    // ì „ì²´ íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼ ê°€ëŠ¥
    val rootDir = Environment.getExternalStorageDirectory()
    rootDir.listFiles()?.forEach { file ->
        Log.d("FileManager", "File: ${file.absolutePath}")
    }
}</code></pre>

            <div class="warning-box" style="margin-top: 30px;">
                <strong>âš ï¸ MANAGE_EXTERNAL_STORAGE ì œì•½ì‚¬í•­:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li>Google Play Storeì—ì„œ <strong>ë§¤ìš° ì—„ê²©íˆ ì œí•œ</strong>ë¨</li>
                    <li>í—ˆìš©ë˜ëŠ” ì•± ìœ í˜•: íŒŒì¼ ê´€ë¦¬ì, ë°±ì—…/ë³µì›, ì•ˆí‹°ë°”ì´ëŸ¬ìŠ¤, ë¬¸ì„œ ê´€ë¦¬</li>
                    <li>ì¼ë°˜ ì•±ì€ <strong>ì‹¬ì‚¬ ê±°ë¶€</strong>ë  ê°€ëŠ¥ì„± ë†’ìŒ</li>
                    <li>ëŒ€ë¶€ë¶„ì˜ ê²½ìš° <strong>MediaStore API + SAF</strong>ë¡œ ì¶©ë¶„</li>
                    <li>Play Store ì •ì±…: <a href="https://support.google.com/googleplay/android-developer/answer/10467955" target="_blank" style="color: var(--accent-primary);">MANAGE_EXTERNAL_STORAGE ì •ì±…</a></li>
                </ul>
            </div>
        </section>

        <!-- Section 8: Trash & Favorites -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">8</span>
                Trash & Favorites ê¸°ëŠ¥
            </h2>
            <p class="section-description">
                Android 11ë¶€í„° ì§€ì›í•˜ëŠ” íœ´ì§€í†µ ë° ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ì„ í™œìš©í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ—‘ï¸</span>
                        Trash (íœ´ì§€í†µ)
                    </h3>
                    <div class="card-description">
                        <p><strong>is_trashed í”Œë˜ê·¸</strong></p>
                        <ul>
                            <li>Android 11+ ì§€ì›</li>
                            <li>ì¦‰ì‹œ ì‚­ì œ ëŒ€ì‹  íœ´ì§€í†µìœ¼ë¡œ ì´ë™</li>
                            <li>30ì¼ í›„ ìë™ ì˜êµ¬ ì‚­ì œ</li>
                            <li>ì‚¬ìš©ìê°€ ë³µêµ¬ ê°€ëŠ¥</li>
                            <li>ì‹œìŠ¤í…œ ì„¤ì •ì—ì„œ ìˆ˜ë™ ë¹„ìš°ê¸° ê°€ëŠ¥</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">â­</span>
                        Favorites (ì¦ê²¨ì°¾ê¸°)
                    </h3>
                    <div class="card-description">
                        <p><strong>is_favorite í”Œë˜ê·¸</strong></p>
                        <ul>
                            <li>Android 11+ ì§€ì›</li>
                            <li>ì‚¬ìš©ìê°€ ì¦ê²¨ì°¾ê¸°ë¡œ í‘œì‹œí•œ ë¯¸ë””ì–´</li>
                            <li>ê°¤ëŸ¬ë¦¬ ì•±ì—ì„œ íŠ¹ë³„ ì»¬ë ‰ì…˜ í‘œì‹œ</li>
                            <li>ë¹ ë¥¸ ì ‘ê·¼ ê°€ëŠ¥</li>
                            <li>ìë™ ì‚­ì œ ë°©ì§€ (ì¼ë¶€ ì•±)</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“…</span>
                        is_pending
                    </h3>
                    <div class="card-description">
                        <p><strong>ì‘ì—… ì§„í–‰ ìƒíƒœ</strong></p>
                        <ul>
                            <li>Android 10+ ì§€ì›</li>
                            <li>íŒŒì¼ ì‘ì„± ì¤‘ ë‹¤ë¥¸ ì•±ì—ì„œ ìˆ¨ê¹€</li>
                            <li>ì™„ë£Œ í›„ 0ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ê³µê°œ</li>
                            <li>ë‹¤ìš´ë¡œë“œ, ì¹´ë©”ë¼ ì´¬ì˜ ì‹œ í™œìš©</li>
                            <li>ì›ìì  ì‘ì—… ë³´ì¥</li>
                        </ul>
                    </div>
                </card>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">â°</span>
                        date_expires
                    </h3>
                    <div class="card-description">
                        <p><strong>ìë™ ë§Œë£Œ ì‹œê°„</strong></p>
                        <ul>
                            <li>Android 11+ ì§€ì›</li>
                            <li>Trash íŒŒì¼ì˜ ì˜êµ¬ ì‚­ì œ ì‹œê°„</li>
                            <li>ê¸°ë³¸ 30ì¼ (2592000ì´ˆ)</li>
                            <li>Systemì´ ìë™ìœ¼ë¡œ ì„¤ì •</li>
                            <li>ë§Œë£Œ ì‹œ ìë™ ì‚­ì œ</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ—‘ï¸ Trash ì‚¬ìš© ì˜ˆì‹œ
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// íŒŒì¼ì„ íœ´ì§€í†µìœ¼ë¡œ ì´ë™ (Android 11+)
fun moveToTrash(context: Context, imageUri: Uri) {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
        val contentValues = ContentValues().apply {
            put(MediaStore.Images.Media.IS_TRASHED, 1)
            // date_expiresëŠ” Systemì´ ìë™ìœ¼ë¡œ ì„¤ì • (í˜„ì¬ ì‹œê°„ + 30ì¼)
        }

        try {
            val updatedRows = context.contentResolver.update(imageUri, contentValues, null, null)
            if (updatedRows > 0) {
                Toast.makeText(context, "íœ´ì§€í†µìœ¼ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤", Toast.LENGTH_SHORT).show()
            }
        } catch (e: RecoverableSecurityException) {
            // ë‹¤ë¥¸ ì•±ì˜ íŒŒì¼ â†’ ì‚¬ìš©ì ë™ì˜ í•„ìš”
            requestUserConsent(e)
        }
    } else {
        // Android 10 ì´í•˜: ì¦‰ì‹œ ì‚­ì œ
        context.contentResolver.delete(imageUri, null, null)
    }
}

// íœ´ì§€í†µì—ì„œ ë³µêµ¬
fun restoreFromTrash(context: Context, imageUri: Uri) {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
        val contentValues = ContentValues().apply {
            put(MediaStore.Images.Media.IS_TRASHED, 0)
        }

        try {
            context.contentResolver.update(imageUri, contentValues, null, null)
            Toast.makeText(context, "ë³µêµ¬í–ˆìŠµë‹ˆë‹¤", Toast.LENGTH_SHORT).show()
        } catch (e: RecoverableSecurityException) {
            requestUserConsent(e)
        }
    }
}

// íœ´ì§€í†µì˜ ëª¨ë“  íŒŒì¼ ì¡°íšŒ
fun queryTrashedFiles(context: Context): List<Uri> {
    val trashedFiles = mutableListOf<Uri>()

    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
        val projection = arrayOf(
            MediaStore.Images.Media._ID,
            MediaStore.Images.Media.DISPLAY_NAME,
            MediaStore.Images.Media.DATE_EXPIRES
        )

        val selection = "${MediaStore.Images.Media.IS_TRASHED} = ?"
        val selectionArgs = arrayOf("1")

        context.contentResolver.query(
            MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
            projection,
            Bundle().apply {
                putString(ContentResolver.QUERY_ARG_SQL_SELECTION, selection)
                putStringArray(ContentResolver.QUERY_ARG_SQL_SELECTION_ARGS, selectionArgs)
                putInt(MediaStore.QUERY_ARG_MATCH_TRASHED, MediaStore.MATCH_INCLUDE)
            },
            null
        )?.use { cursor ->
            val idColumn = cursor.getColumnIndexOrThrow(MediaStore.Images.Media._ID)

            while (cursor.moveToNext()) {
                val id = cursor.getLong(idColumn)
                val uri = ContentUris.withAppendedId(
                    MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                    id
                )
                trashedFiles.add(uri)
            }
        }
    }

    return trashedFiles
}

// íœ´ì§€í†µ ì˜êµ¬ ë¹„ìš°ê¸° (ì¦‰ì‹œ ì‚­ì œ)
fun emptyTrash(context: Context, trashedUris: List<Uri>) {
    trashedUris.forEach { uri ->
        try {
            context.contentResolver.delete(uri, null, null)
        } catch (e: RecoverableSecurityException) {
            requestUserConsent(e)
        }
    }
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                â­ Favorites ì‚¬ìš© ì˜ˆì‹œ
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// ì¦ê²¨ì°¾ê¸°ë¡œ í‘œì‹œ
fun markAsFavorite(context: Context, imageUri: Uri, isFavorite: Boolean) {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
        val contentValues = ContentValues().apply {
            put(MediaStore.Images.Media.IS_FAVORITE, if (isFavorite) 1 else 0)
        }

        try {
            context.contentResolver.update(imageUri, contentValues, null, null)
        } catch (e: RecoverableSecurityException) {
            requestUserConsent(e)
        }
    }
}

// ì¦ê²¨ì°¾ê¸° íŒŒì¼ë§Œ ì¡°íšŒ
fun queryFavorites(context: Context): List<Uri> {
    val favorites = mutableListOf<Uri>()

    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
        val projection = arrayOf(
            MediaStore.Images.Media._ID,
            MediaStore.Images.Media.DISPLAY_NAME
        )

        val selection = "${MediaStore.Images.Media.IS_FAVORITE} = ?"
        val selectionArgs = arrayOf("1")

        context.contentResolver.query(
            MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
            projection,
            selection,
            selectionArgs,
            "${MediaStore.Images.Media.DATE_ADDED} DESC"
        )?.use { cursor ->
            val idColumn = cursor.getColumnIndexOrThrow(MediaStore.Images.Media._ID)

            while (cursor.moveToNext()) {
                val id = cursor.getLong(idColumn)
                val uri = ContentUris.withAppendedId(
                    MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                    id
                )
                favorites.add(uri)
            }
        }
    }

    return favorites
}</code></pre>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>ğŸ’¡ Trash & Favorites í•µì‹¬ í¬ì¸íŠ¸:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>Trash</strong>: ì˜êµ¬ ì‚­ì œ ì „ 30ì¼ ìœ ì˜ˆ ê¸°ê°„, ì‚¬ìš©ì ì‹¤ìˆ˜ ë°©ì§€</li>
                    <li><strong>Favorites</strong>: ì‚¬ìš©ìê°€ ì¤‘ìš”í•˜ë‹¤ê³  í‘œì‹œí•œ ë¯¸ë””ì–´, UIì—ì„œ íŠ¹ë³„ ì·¨ê¸‰</li>
                    <li><strong>MATCH_INCLUDE</strong>: Trash íŒŒì¼ì„ ì¿¼ë¦¬ ê²°ê³¼ì— í¬í•¨í•˜ë ¤ë©´ ëª…ì‹œ í•„ìš”</li>
                    <li><strong>date_expires</strong>: Systemì´ ìë™ ì„¤ì •, ìˆ˜ë™ ë³€ê²½ ë¶ˆê°€</li>
                    <li><strong>í˜¸í™˜ì„±</strong>: Android 11 ë¯¸ë§Œì—ì„œëŠ” í”Œë˜ê·¸ ë¬´ì‹œë¨</li>
                </ul>
            </div>
        </section>

        <!-- Section 9: Performance Optimization -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">9</span>
                ì„±ëŠ¥ ìµœì í™”
            </h2>
            <p class="section-description">
                MediaStore ì¿¼ë¦¬ ë° íŒŒì¼ ì‘ì—…ì˜ ì„±ëŠ¥ì„ ìµœì í™”í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“Š</span>
                        Projection ìµœì í™”
                    </h3>
                    <div class="card-description">
                        <p><strong>í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ì¡°íšŒ</strong></p>
                        <ul>
                            <li>ëª¨ë“  ì»¬ëŸ¼(*) ëŒ€ì‹  í•„ìš”í•œ ê²ƒë§Œ ì§€ì •</li>
                            <li>BLOB ì»¬ëŸ¼ (ì¸ë„¤ì¼) ì œì™¸</li>
                            <li>ë°ì´í„° ì „ì†¡ëŸ‰ ê°ì†Œ</li>
                            <li>ì¿¼ë¦¬ ì†ë„ í–¥ìƒ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”¢</span>
                        Limit & Offset
                    </h3>
                    <div class="card-description">
                        <p><strong>í˜ì´ì§€ë„¤ì´ì…˜</strong></p>
                        <ul>
                            <li>í•œ ë²ˆì— ì†ŒëŸ‰ë§Œ ë¡œë“œ (ì˜ˆ: 20ê°œ)</li>
                            <li>ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„</li>
                            <li>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ</li>
                            <li>ì´ˆê¸° ë¡œë”© ì†ë„ í–¥ìƒ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“¦</span>
                        Batch ì‘ì—…
                    </h3>
                    <div class="card-description">
                        <p><strong>ì¼ê´„ ì²˜ë¦¬</strong></p>
                        <ul>
                            <li>bulkInsertë¡œ ì—¬ëŸ¬ ë ˆì½”ë“œ í•œ ë²ˆì— ì‚½ì…</li>
                            <li>applyBatchë¡œ íŠ¸ëœì­ì…˜ ì²˜ë¦¬</li>
                            <li>Binder í˜¸ì¶œ íšŸìˆ˜ ê°ì†Œ</li>
                            <li>IPC ì˜¤ë²„í—¤ë“œ ìµœì†Œí™”</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”„</span>
                        ContentObserver
                    </h3>
                    <div class="card-description">
                        <p><strong>ë³€ê²½ ê°ì§€</strong></p>
                        <ul>
                            <li>MediaStore ë³€ê²½ ì‹¤ì‹œê°„ ê°ì§€</li>
                            <li>í´ë§ ëŒ€ì‹  í‘¸ì‹œ ë°©ì‹</li>
                            <li>UI ìë™ ì—…ë°ì´íŠ¸</li>
                            <li>ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì </li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ“Š Cursor ìµœì í™”
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// âŒ ë‚˜ìœ ì˜ˆ: ëª¨ë“  ì»¬ëŸ¼ ì¡°íšŒ
val cursor = contentResolver.query(
    MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
    null,  // ëª¨ë“  ì»¬ëŸ¼
    null,
    null,
    null
)

// âœ… ì¢‹ì€ ì˜ˆ: í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ì¡°íšŒ
val projection = arrayOf(
    MediaStore.Images.Media._ID,
    MediaStore.Images.Media.DISPLAY_NAME,
    MediaStore.Images.Media.DATE_ADDED
)

val cursor = contentResolver.query(
    MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
    projection,  // í•„ìš”í•œ ê²ƒë§Œ
    null,
    null,
    "${MediaStore.Images.Media.DATE_ADDED} DESC LIMIT 20"  // í˜ì´ì§€ë„¤ì´ì…˜
)

// âœ… Android 10+: Bundleë¡œ LIMIT/OFFSET ì§€ì •
val queryArgs = Bundle().apply {
    putInt(ContentResolver.QUERY_ARG_LIMIT, 20)
    putInt(ContentResolver.QUERY_ARG_OFFSET, 0)
    putString(ContentResolver.QUERY_ARG_SORT_COLUMNS, arrayOf(MediaStore.Images.Media.DATE_ADDED).first())
    putInt(ContentResolver.QUERY_ARG_SORT_DIRECTION, ContentResolver.QUERY_SORT_DIRECTION_DESCENDING)
}

val cursor = contentResolver.query(
    MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
    projection,
    queryArgs,
    null
)

// âš ï¸ ë°˜ë“œì‹œ Cursor close
cursor?.use { c ->
    while (c.moveToNext()) {
        // ë°ì´í„° ì²˜ë¦¬
    }
}  // use ë¸”ë¡ ì¢…ë£Œ ì‹œ ìë™ close</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ“¦ Batch ì‘ì—…
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// bulkInsertë¡œ ì—¬ëŸ¬ ì´ë¯¸ì§€ í•œ ë²ˆì— ì‚½ì…
fun bulkInsertImages(context: Context, images: List<ImageInfo>): Int {
    val contentValues = images.map { image ->
        ContentValues().apply {
            put(MediaStore.Images.Media.DISPLAY_NAME, image.name)
            put(MediaStore.Images.Media.MIME_TYPE, "image/jpeg")
            put(MediaStore.Images.Media.RELATIVE_PATH, Environment.DIRECTORY_PICTURES)
        }
    }.toTypedArray()

    return context.contentResolver.bulkInsert(
        MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
        contentValues
    )
}

// applyBatchë¡œ ì—¬ëŸ¬ ì‘ì—…ì„ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì‹¤í–‰
fun batchOperations(context: Context, operations: List<ContentProviderOperation>) {
    try {
        val results = context.contentResolver.applyBatch(
            MediaStore.AUTHORITY,
            ArrayList(operations)
        )
        Log.d("Batch", "Success: ${results.size} operations")
    } catch (e: Exception) {
        Log.e("Batch", "Failed", e)
    }
}

// ì˜ˆì‹œ: ì—¬ëŸ¬ ì´ë¯¸ì§€ë¥¼ Favoriteë¡œ í‘œì‹œ
fun batchMarkFavorite(context: Context, imageUris: List<Uri>) {
    val operations = imageUris.map { uri ->
        ContentProviderOperation.newUpdate(uri)
            .withValue(MediaStore.Images.Media.IS_FAVORITE, 1)
            .build()
    }

    batchOperations(context, operations)
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ”„ ContentObserver ë³€ê²½ ê°ì§€
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// MediaStore ë³€ê²½ ê°ì§€
class MediaObserver(
    private val handler: Handler,
    private val onChange: () -> Unit
) : ContentObserver(handler) {

    override fun onChange(selfChange: Boolean) {
        super.onChange(selfChange)
        onChange()
    }

    override fun onChange(selfChange: Boolean, uri: Uri?) {
        super.onChange(selfChange, uri)
        Log.d("MediaObserver", "Changed: $uri")
        onChange()
    }
}

// Activityì—ì„œ ì‚¬ìš©
class GalleryActivity : AppCompatActivity() {
    private lateinit var mediaObserver: ContentObserver

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        // ContentObserver ë“±ë¡
        val handler = Handler(Looper.getMainLooper())
        mediaObserver = MediaObserver(handler) {
            // MediaStore ë³€ê²½ ì‹œ UI ì—…ë°ì´íŠ¸
            loadImages()
        }

        contentResolver.registerContentObserver(
            MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
            true,  // descendantsë„ ê°ì§€
            mediaObserver
        )
    }

    override fun onDestroy() {
        super.onDestroy()
        contentResolver.unregisterContentObserver(mediaObserver)
    }

    private fun loadImages() {
        // ì´ë¯¸ì§€ ë‹¤ì‹œ ë¡œë“œ ë° UI ì—…ë°ì´íŠ¸
        lifecycleScope.launch {
            val images = withContext(Dispatchers.IO) {
                queryImages(this@GalleryActivity)
            }
            adapter.submitList(images)
        }
    }
}</code></pre>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>ğŸ“ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬:</strong>
                <table style="width: 100%; margin-top: 15px; border-collapse: collapse;">
                    <thead>
                        <tr style="background: var(--bg-secondary); border-bottom: 2px solid var(--accent-primary);">
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">ì‘ì—…</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">ìµœì í™” ì „</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">ìµœì í™” í›„</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">ê°œì„ ìœ¨</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Query (1000ê°œ)</strong></td>
                            <td style="padding: 10px;">250ms (ì „ì²´ ì»¬ëŸ¼)</td>
                            <td style="padding: 10px;">80ms (Projection)</td>
                            <td style="padding: 10px;">68% í–¥ìƒ</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Insert (100ê°œ)</strong></td>
                            <td style="padding: 10px;">1500ms (ê°œë³„ ì‚½ì…)</td>
                            <td style="padding: 10px;">120ms (bulkInsert)</td>
                            <td style="padding: 10px;">92% í–¥ìƒ</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Update (50ê°œ)</strong></td>
                            <td style="padding: 10px;">800ms (ê°œë³„ ì—…ë°ì´íŠ¸)</td>
                            <td style="padding: 10px;">90ms (applyBatch)</td>
                            <td style="padding: 10px;">89% í–¥ìƒ</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px;"><strong>ë³€ê²½ ê°ì§€</strong></td>
                            <td style="padding: 10px;">í´ë§ (1ì´ˆë§ˆë‹¤ ì¿¼ë¦¬)</td>
                            <td style="padding: 10px;">ContentObserver (í‘¸ì‹œ)</td>
                            <td style="padding: 10px;">CPU 95% ê°ì†Œ</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Section 10: Android Version Changes -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">10</span>
                Android ë²„ì „ë³„ ë³€í™”
            </h2>
            <p class="section-description">
                Android 10ë¶€í„° 13ê¹Œì§€ Scoped Storage ë° ê¶Œí•œ ëª¨ë¸ì˜ ì£¼ìš” ë³€í™”ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤.
            </p>

            <div class="highlight-box">
                <table style="width: 100%; margin-top: 15px; border-collapse: collapse;">
                    <thead>
                        <tr style="background: var(--bg-secondary); border-bottom: 2px solid var(--accent-primary);">
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">í•­ëª©</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">Android 9 (Pie)</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">Android 10 (Q)</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">Android 11 (R)</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">Android 12 (S)</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">Android 13 (T)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Storage ëª¨ë¸</strong></td>
                            <td style="padding: 10px;">Legacy Storage</td>
                            <td style="padding: 10px;">Scoped Storage (ì„ íƒ)</td>
                            <td style="padding: 10px;">Scoped Storage (ê°•ì œ)</td>
                            <td style="padding: 10px;">Scoped Storage</td>
                            <td style="padding: 10px;">Scoped Storage</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ê¶Œí•œ</strong></td>
                            <td style="padding: 10px;">READ/WRITE_EXTERNAL_STORAGE</td>
                            <td style="padding: 10px;">READ_EXTERNAL_STORAGE</td>
                            <td style="padding: 10px;">READ_EXTERNAL_STORAGE</td>
                            <td style="padding: 10px;">READ_EXTERNAL_STORAGE</td>
                            <td style="padding: 10px;">READ_MEDIA_IMAGES/VIDEO/AUDIO</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>íŒŒì¼ ì ‘ê·¼</strong></td>
                            <td style="padding: 10px;">File API ì§ì ‘ ì ‘ê·¼</td>
                            <td style="padding: 10px;">MediaStore + File API</td>
                            <td style="padding: 10px;">MediaStore (ê¶Œì¥)</td>
                            <td style="padding: 10px;">MediaStore (í•„ìˆ˜)</td>
                            <td style="padding: 10px;">MediaStore (í•„ìˆ˜)</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>FUSE</strong></td>
                            <td style="padding: 10px;">ì—†ìŒ</td>
                            <td style="padding: 10px;">ì—†ìŒ</td>
                            <td style="padding: 10px;">FUSE Daemon</td>
                            <td style="padding: 10px;">FUSE Passthrough</td>
                            <td style="padding: 10px;">FUSE Passthrough</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Trash & Favorites</strong></td>
                            <td style="padding: 10px;">ì—†ìŒ</td>
                            <td style="padding: 10px;">ì—†ìŒ</td>
                            <td style="padding: 10px;">is_trashed, is_favorite</td>
                            <td style="padding: 10px;">ë™ì¼</td>
                            <td style="padding: 10px;">ë™ì¼</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ë‹¤ë¥¸ ì•± íŒŒì¼ ìˆ˜ì •</strong></td>
                            <td style="padding: 10px;">ììœ ë¡­ê²Œ ê°€ëŠ¥</td>
                            <td style="padding: 10px;">RecoverableSecurityException</td>
                            <td style="padding: 10px;">RecoverableSecurityException</td>
                            <td style="padding: 10px;">ë™ì¼</td>
                            <td style="padding: 10px;">ë™ì¼</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Location Redaction</strong></td>
                            <td style="padding: 10px;">ì—†ìŒ</td>
                            <td style="padding: 10px;">ACCESS_MEDIA_LOCATION í•„ìš”</td>
                            <td style="padding: 10px;">ë™ì¼</td>
                            <td style="padding: 10px;">ë™ì¼</td>
                            <td style="padding: 10px;">ë™ì¼</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px;"><strong>MANAGE_EXTERNAL_STORAGE</strong></td>
                            <td style="padding: 10px;">ì—†ìŒ</td>
                            <td style="padding: 10px;">ì—†ìŒ</td>
                            <td style="padding: 10px;">ë„ì… (íŠ¹ìˆ˜ ê¶Œí•œ)</td>
                            <td style="padding: 10px;">Play Store ì œí•œ ê°•í™”</td>
                            <td style="padding: 10px;">ë”ìš± ì—„ê²©í•œ ì œí•œ</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ”„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">1ï¸âƒ£</span>
                        Android 9 â†’ 10
                    </h3>
                    <div class="card-description">
                        <p><strong>Scoped Storage ì„ íƒ ë„ì…</strong></p>
                        <ul>
                            <li><code>requestLegacyExternalStorage=true</code>ë¡œ ì¼ì‹œì  íšŒí”¼ ê°€ëŠ¥</li>
                            <li>File API ëŒ€ì‹  MediaStore ì‚¬ìš© ì‹œì‘</li>
                            <li>WRITE_EXTERNAL_STORAGE ë¶ˆí•„ìš” (ìì‹ ì˜ ë¯¸ë””ì–´)</li>
                            <li>ContentValues + OutputStream íŒ¨í„´ ì ìš©</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">2ï¸âƒ£</span>
                        Android 10 â†’ 11
                    </h3>
                    <div class="card-description">
                        <p><strong>Scoped Storage ê°•ì œ ì ìš©</strong></p>
                        <ul>
                            <li><code>requestLegacyExternalStorage</code> ë¬´ì‹œë¨</li>
                            <li>File API ì ‘ê·¼ ì œí•œ (getExternalStorageDirectory ë¶ˆê°€)</li>
                            <li>FUSE Daemon ë„ì…ìœ¼ë¡œ ì‹¤ì‹œê°„ ê¶Œí•œ ê²€ì‚¬</li>
                            <li>Trash & Favorites ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">3ï¸âƒ£</span>
                        Android 11 â†’ 12
                    </h3>
                    <div class="card-description">
                        <p><strong>FUSE Passthrough ìµœì í™”</strong></p>
                        <ul>
                            <li>I/O ì„±ëŠ¥ ëŒ€í­ í–¥ìƒ (User-space ìš°íšŒ)</li>
                            <li>ì•± ì½”ë“œ ë³€ê²½ ë¶ˆí•„ìš” (ìë™ ì ìš©)</li>
                            <li>MANAGE_EXTERNAL_STORAGE ì •ì±… ê°•í™”</li>
                            <li>Play Store ì‹¬ì‚¬ ì—„ê²©</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">4ï¸âƒ£</span>
                        Android 12 â†’ 13
                    </h3>
                    <div class="card-description">
                        <p><strong>Granular ê¶Œí•œ ë„ì…</strong></p>
                        <ul>
                            <li>READ_MEDIA_IMAGES/VIDEO/AUDIOë¡œ ë¶„ë¦¬</li>
                            <li>ì‚¬ìš©ìê°€ ë¯¸ë””ì–´ íƒ€ì…ë³„ë¡œ ê¶Œí•œ ì œì–´</li>
                            <li>AndroidManifest.xmlì— 3ê°œ ê¶Œí•œ ì„ ì–¸</li>
                            <li>í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€ (maxSdkVersion)</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                âš ï¸ Deprecated API ëŒ€ì²´
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// âŒ Deprecated: File API ì§ì ‘ ì ‘ê·¼ (Android 10+)
val file = File(Environment.getExternalStorageDirectory(), "Pictures/photo.jpg")
FileOutputStream(file).use { out ->
    bitmap.compress(Bitmap.CompressFormat.JPEG, 95, out)
}

// âœ… ê¶Œì¥: MediaStore API
val contentValues = ContentValues().apply {
    put(MediaStore.Images.Media.DISPLAY_NAME, "photo.jpg")
    put(MediaStore.Images.Media.MIME_TYPE, "image/jpeg")
    put(MediaStore.Images.Media.RELATIVE_PATH, Environment.DIRECTORY_PICTURES)
}

val uri = contentResolver.insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, contentValues)
uri?.let {
    contentResolver.openOutputStream(it)?.use { out ->
        bitmap.compress(Bitmap.CompressFormat.JPEG, 95, out)
    }
}

// âŒ Deprecated: MediaStore.Images.Thumbnails (Android 10+)
val thumbnail = MediaStore.Images.Thumbnails.getThumbnail(
    contentResolver, imageId, MediaStore.Images.Thumbnails.MINI_KIND, null
)

// âœ… ê¶Œì¥: loadThumbnail()
val thumbnail = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
    contentResolver.loadThumbnail(imageUri, Size(512, 512), null)
} else {
    // Fallback for older versions
    MediaStore.Images.Thumbnails.getThumbnail(
        contentResolver, imageId, MediaStore.Images.Thumbnails.MINI_KIND, null
    )
}</code></pre>
        </section>

        <!-- Section 11: Debugging & Troubleshooting -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">11</span>
                ë””ë²„ê¹… & íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
            </h2>
            <p class="section-description">
                MediaProviderì˜ ë¬¸ì œë¥¼ ì§„ë‹¨í•˜ê³  í•´ê²°í•˜ê¸° ìœ„í•œ ë„êµ¬ì™€ ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-bottom: 20px;">
                ğŸ“Š dumpsys ëª…ë ¹ì–´
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;"># MediaProvider ìƒíƒœ ì¡°íšŒ
adb shell dumpsys media_provider

# ë°ì´í„°ë² ì´ìŠ¤ í†µê³„
adb shell dumpsys media_provider database

# FUSE ìƒíƒœ
adb shell dumpsys media_provider fuse

# ê¶Œí•œ ë° ì•±ë³„ ì ‘ê·¼ ê¸°ë¡
adb shell dumpsys media_provider permissions

# MediaStore ë°ì´í„°ë² ì´ìŠ¤ ì§ì ‘ ì¡°íšŒ (ê°œë°œ ë¹Œë“œ)
adb shell sqlite3 /data/data/com.android.providers.media.module/databases/external.db
> SELECT _id, _display_name, _size FROM files WHERE media_type=1 LIMIT 10;
> .quit</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ”§ adb shell content ëª…ë ¹ì–´
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;"># MediaStore ì¿¼ë¦¬ (ì´ë¯¸ì§€ ì¡°íšŒ)
adb shell content query --uri content://media/external/images/media \
  --projection _id,_display_name,_size

# íŠ¹ì • ì¡°ê±´ìœ¼ë¡œ ì¿¼ë¦¬ (í¬ê¸° > 1MB)
adb shell content query --uri content://media/external/images/media \
  --projection _id,_display_name,_size \
  --where "_size>1048576"

# ìƒˆ ë ˆì½”ë“œ ì‚½ì…
adb shell content insert --uri content://media/external/images/media \
  --bind _display_name:s:test.jpg \
  --bind mime_type:s:image/jpeg

# ë ˆì½”ë“œ ì—…ë°ì´íŠ¸ (Favorite ì„¤ì •)
adb shell content update --uri content://media/external/images/media/123 \
  --bind is_favorite:i:1

# ë ˆì½”ë“œ ì‚­ì œ
adb shell content delete --uri content://media/external/images/media/123

# MediaScanner íŠ¸ë¦¬ê±° (ì „ì²´ ìŠ¤ìº”)
adb shell am broadcast -a android.intent.action.MEDIA_MOUNTED \
  -d file:///storage/emulated/0</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ
            </h3>

            <div class="highlight-box">
                <table style="width: 100%; margin-top: 15px; border-collapse: collapse;">
                    <thead>
                        <tr style="background: var(--bg-secondary); border-bottom: 2px solid var(--accent-primary);">
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">ì¦ìƒ</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">ì›ì¸</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">í•´ê²° ë°©ë²•</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>query() ê²°ê³¼ê°€ ë¹„ì–´ìˆìŒ</strong></td>
                            <td style="padding: 10px;">ê¶Œí•œ ë¶€ì¡± ë˜ëŠ” ì‹¤ì œ íŒŒì¼ ì—†ìŒ</td>
                            <td style="padding: 10px;">1. READ_MEDIA_* ê¶Œí•œ í™•ì¸<br>2. adb shell content queryë¡œ DB í™•ì¸<br>3. MediaScanner íŠ¸ë¦¬ê±°</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>insert() í›„ URIê°€ null</strong></td>
                            <td style="padding: 10px;">ContentValues ì˜ëª»ë¨ ë˜ëŠ” ê¶Œí•œ ë¶€ì¡±</td>
                            <td style="padding: 10px;">1. DISPLAY_NAME, MIME_TYPE í•„ìˆ˜ í™•ì¸<br>2. RELATIVE_PATH ìœ íš¨ì„± ê²€ì¦<br>3. Logcatì—ì„œ ì—ëŸ¬ í™•ì¸</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>openOutputStream() ì‹¤íŒ¨</strong></td>
                            <td style="padding: 10px;">URIê°€ ìœ íš¨í•˜ì§€ ì•ŠìŒ</td>
                            <td style="padding: 10px;">1. insert() ë°˜í™˜ URI í™•ì¸<br>2. IS_PENDING í”Œë˜ê·¸ í•´ì œ í™•ì¸<br>3. Storage ê³µê°„ í™•ì¸</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>RecoverableSecurityException ë°œìƒ</strong></td>
                            <td style="padding: 10px;">ë‹¤ë¥¸ ì•±ì˜ íŒŒì¼ ìˆ˜ì • ì‹œë„</td>
                            <td style="padding: 10px;">1. e.userAction.actionIntentë¡œ ì‚¬ìš©ì ë™ì˜ ìš”ì²­<br>2. onActivityResultì—ì„œ ì¬ì‹œë„<br>3. ìì‹ ì˜ íŒŒì¼ì¸ì§€ í™•ì¸</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ìƒˆ íŒŒì¼ì´ ê°¤ëŸ¬ë¦¬ì— ì•ˆ ë³´ì„</strong></td>
                            <td style="padding: 10px;">MediaScanner ë¯¸ì‹¤í–‰</td>
                            <td style="padding: 10px;">1. IS_PENDING=0ìœ¼ë¡œ ì„¤ì • í™•ì¸<br>2. MediaScannerConnection.scanFile() í˜¸ì¶œ<br>3. ì•± ì¬ì‹œì‘ ë˜ëŠ” ê¸°ê¸° ì¬ë¶€íŒ…</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ìœ„ì¹˜ ì •ë³´ê°€ nullë¡œ í‘œì‹œë¨</strong></td>
                            <td style="padding: 10px;">Location Redaction (ìë™ ì‚­ì œ)</td>
                            <td style="padding: 10px;">1. ACCESS_MEDIA_LOCATION ê¶Œí•œ ì¶”ê°€<br>2. setRequireOriginal(true) ì‚¬ìš©<br>3. ExifInterfaceë¡œ ì›ë³¸ ì½ê¸°</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>FileNotFoundException (Android 10+)</strong></td>
                            <td style="padding: 10px;">File APIë¡œ ì§ì ‘ ì ‘ê·¼ ì‹œë„</td>
                            <td style="padding: 10px;">1. MediaStore APIë¡œ ì „í™˜<br>2. SAF ì‚¬ìš©<br>3. getExternalFilesDir() ì‚¬ìš©</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px;"><strong>ì„±ëŠ¥ ì €í•˜ (ëŠë¦° ì¿¼ë¦¬)</strong></td>
                            <td style="padding: 10px;">ì „ì²´ ì»¬ëŸ¼ ì¡°íšŒ ë˜ëŠ” ëŒ€ëŸ‰ ë°ì´í„°</td>
                            <td style="padding: 10px;">1. Projectionìœ¼ë¡œ í•„ìš”í•œ ì»¬ëŸ¼ë§Œ<br>2. LIMIT/OFFSETìœ¼ë¡œ í˜ì´ì§€ë„¤ì´ì…˜<br>3. Background Thread ì‚¬ìš©<br>4. Cursor ì¦‰ì‹œ close</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ“ˆ ì„±ëŠ¥ ë¶„ì„
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;"># Logcat í•„í„°ë§
adb logcat -s MediaProvider FuseDaemon

# StrictModeë¡œ ë©”ì¸ ìŠ¤ë ˆë“œ I/O ê°ì§€
if (BuildConfig.DEBUG) {
    StrictMode.setThreadPolicy(
        StrictMode.ThreadPolicy.Builder()
            .detectDiskReads()
            .detectDiskWrites()
            .penaltyLog()
            .build()
    )
}

// ì¿¼ë¦¬ ì„±ëŠ¥ ì¸¡ì •
val startTime = SystemClock.elapsedRealtime()
val cursor = contentResolver.query(...)
val queryTime = SystemClock.elapsedRealtime() - startTime
Log.d("Performance", "Query took ${queryTime}ms")

cursor?.use {
    val count = it.count
    Log.d("Performance", "Returned $count rows")
}

# Android Profiler ì‚¬ìš©
# Android Studio â†’ View â†’ Tool Windows â†’ Profiler
# - CPU: ContentResolver í˜¸ì¶œ ì¶”ì 
# - Memory: Cursor ëˆ„ìˆ˜ í™•ì¸
# - Network: ì—†ì–´ì•¼ í•¨ (ë¡œì»¬ DB)</code></pre>

            <div class="warning-box" style="margin-top: 30px;">
                <strong>ğŸ’¡ ë””ë²„ê¹… Best Practices:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li>dumpsys media_providerë¡œ ì „ì²´ ìƒíƒœ íŒŒì•… í›„ ë¬¸ì œ ì˜ì—­ íŠ¹ì •</li>
                    <li>adb shell contentë¡œ MediaStore DB ì§ì ‘ ì¡°ì‘í•˜ì—¬ ì•± ì™¸ë¶€ì—ì„œ ì¬í˜„</li>
                    <li>StrictModeë¡œ ë©”ì¸ ìŠ¤ë ˆë“œ I/O ì¡°ê¸° ë°œê²¬</li>
                    <li>Logcatì—ì„œ RecoverableSecurityException ìƒì„¸ ë©”ì‹œì§€ í™•ì¸</li>
                    <li>Android Profilerë¡œ Cursor ëˆ„ìˆ˜ ë° ì„±ëŠ¥ ë³‘ëª© ë¶„ì„</li>
                </ul>
            </div>
        </section>

        <!-- Section 12: AOSP Source Code Reference -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">12</span>
                AOSP ì†ŒìŠ¤ ì½”ë“œ ì°¸ì¡°
            </h2>
            <p class="section-description">
                MediaProvider êµ¬í˜„ì„ ì´í•´í•˜ê¸° ìœ„í•œ AOSP ì†ŒìŠ¤ ì½”ë“œ ìœ„ì¹˜ì™€ í•µì‹¬ ë¡œì§ì„ ì†Œê°œí•©ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-bottom: 20px;">
                ğŸ“‚ ì£¼ìš” ì†ŒìŠ¤ íŒŒì¼ ìœ„ì¹˜
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“±</span>
                        MediaProvider (Java)
                    </h3>
                    <div class="card-description">
                        <p><strong>ContentProvider êµ¬í˜„</strong></p>
                        <pre style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.75rem; margin-top: 10px;"><code>packages/providers/MediaProvider/src/com/android/providers/media/
â”œâ”€â”€ MediaProvider.java
â”œâ”€â”€ MediaService.java
â”œâ”€â”€ MediaVolume.java
â””â”€â”€ DatabaseHelper.java</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš™ï¸</span>
                        FuseDaemon (C++)
                    </h3>
                    <div class="card-description">
                        <p><strong>FUSE íŒŒì¼ ì‹œìŠ¤í…œ</strong></p>
                        <pre style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.75rem; margin-top: 10px;"><code>packages/providers/MediaProvider/jni/
â”œâ”€â”€ FuseDaemon.cpp
â”œâ”€â”€ MediaProviderWrapper.cpp
â””â”€â”€ node-inl.h</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“š</span>
                        MediaStore API
                    </h3>
                    <div class="card-description">
                        <p><strong>Framework Contract</strong></p>
                        <pre style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.75rem; margin-top: 10px;"><code>frameworks/base/core/java/android/provider/
â”œâ”€â”€ MediaStore.java
â””â”€â”€ MediaStore$*.java (Inner classes)</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ—„ï¸</span>
                        Database Schema
                    </h3>
                    <div class="card-description">
                        <p><strong>SQLite ìŠ¤í‚¤ë§ˆ ì •ì˜</strong></p>
                        <pre style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.75rem; margin-top: 10px;"><code>packages/providers/MediaProvider/src/com/android/providers/media/
â””â”€â”€ DatabaseHelper.java
  - createFilesTable()
  - createIndexes()</code></pre>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ’» í•µì‹¬ ì½”ë“œ ìŠ¤ë‹ˆí«
            </h3>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                1. MediaProvider.java (Query ì²˜ë¦¬)
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// packages/providers/MediaProvider/src/com/android/providers/media/MediaProvider.java

@Override
public Cursor query(Uri uri, String[] projection, String selection,
                    String[] selectionArgs, String sortOrder) {
    // ê¶Œí•œ ê²€ì‚¬
    enforceCallingOrSelfPermissionAndAppOps(uri, callingPackage);

    // URI íŒŒì‹± (ì–´ë–¤ í…Œì´ë¸”ì¸ì§€ ê²°ì •)
    final int match = matchUri(uri);
    final DatabaseHelper helper = getDatabaseForUri(uri);
    final SQLiteDatabase db = helper.getReadableDatabase();

    // ì¿¼ë¦¬ ë¹Œë“œ
    SQLiteQueryBuilder qb = new SQLiteQueryBuilder();
    switch (match) {
        case IMAGES_MEDIA:
            qb.setTables("files");
            qb.appendWhere("media_type=" + FileColumns.MEDIA_TYPE_IMAGE);
            break;
        case AUDIO_MEDIA:
            qb.setTables("files");
            qb.appendWhere("media_type=" + FileColumns.MEDIA_TYPE_AUDIO);
            break;
        // ...
    }

    // Scoped Storage: ë‹¤ë¥¸ ì•±ì˜ íŒŒì¼ í•„í„°ë§
    if (!isCallerAllowed(uri)) {
        qb.appendWhere("_data IS NOT NULL AND owner_package_name=?");
        selectionArgs = appendSelectionArgs(selectionArgs, callingPackage);
    }

    // ì¿¼ë¦¬ ì‹¤í–‰
    Cursor c = qb.query(db, projection, selection, selectionArgs,
                        null, null, sortOrder, limit);

    // ContentObserver ì•Œë¦¼ ì„¤ì •
    c.setNotificationUri(getContext().getContentResolver(), uri);

    return c;
}</code></pre>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                2. FuseDaemon.cpp (íŒŒì¼ ì—´ê¸° ì²˜ë¦¬)
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// packages/providers/MediaProvider/jni/FuseDaemon.cpp

static int fuse_open(const char* path, struct fuse_file_info* fi) {
    // JNIë¡œ Java ë ˆì´ì–´ì— ê¶Œí•œ ê²€ì‚¬ ìš”ì²­
    JNIEnv* env = MaybeAttachCurrentThread();
    jstring j_path = env->NewStringUTF(path);

    // MediaProvider.shouldAllowAccess() í˜¸ì¶œ
    bool allowed = env->CallBooleanMethod(
        media_provider_object_,
        mid_should_allow_access_,
        j_path,
        fi->fh,  // íŒŒì¼ í•¸ë“¤
        uid,     // í˜¸ì¶œì UID
        gid
    );

    if (!allowed) {
        // ê¶Œí•œ ê±°ë¶€
        return -EACCES;
    }

    // ì‹¤ì œ íŒŒì¼ ì—´ê¸°
    int fd = openat(AT_FDCWD, actual_path, fi->flags);
    if (fd < 0) {
        return -errno;
    }

    // FUSE Passthrough ì„¤ì • (Android 12+)
    if (supports_passthrough) {
        struct fuse_passthrough_out passthrough;
        passthrough.fd = fd;
        fuse_reply_open_passthrough(req, fi, &passthrough);
    } else {
        fi->fh = fd;
        fuse_reply_open(req, fi);
    }

    return 0;
}</code></pre>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                3. DatabaseHelper.java (í…Œì´ë¸” ìƒì„±)
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// packages/providers/MediaProvider/src/com/android/providers/media/DatabaseHelper.java

private void createFilesTable(SQLiteDatabase db) {
    db.execSQL("CREATE TABLE files (" +
        "_id INTEGER PRIMARY KEY AUTOINCREMENT," +
        "_data TEXT UNIQUE COLLATE NOCASE," +
        "_display_name TEXT," +
        "_size INTEGER," +
        "mime_type TEXT," +
        "date_added INTEGER," +
        "date_modified INTEGER," +
        "media_type INTEGER," +
        "width INTEGER," +
        "height INTEGER," +
        "duration INTEGER," +
        "album TEXT," +
        "artist TEXT," +
        "is_trashed INTEGER DEFAULT 0," +
        "is_favorite INTEGER DEFAULT 0," +
        "is_pending INTEGER DEFAULT 0," +
        "date_expires INTEGER," +
        "owner_package_name TEXT," +
        // ... ë” ë§ì€ ì»¬ëŸ¼
        ")"
    );

    // ì¸ë±ìŠ¤ ìƒì„± (ì„±ëŠ¥ ìµœì í™”)
    db.execSQL("CREATE INDEX media_type_index ON files(media_type)");
    db.execSQL("CREATE INDEX date_added_index ON files(date_added)");
    db.execSQL("CREATE INDEX owner_package_name_index ON files(owner_package_name)");
}</code></pre>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>ğŸ”— AOSP ì†ŒìŠ¤ ì½”ë“œ íƒìƒ‰ ë§í¬:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><a href="https://cs.android.com/android/platform/superproject/+/master:packages/providers/MediaProvider/" target="_blank" style="color: var(--accent-primary);">MediaProvider (Mainline ëª¨ë“ˆ)</a></li>
                    <li><a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/provider/MediaStore.java" target="_blank" style="color: var(--accent-primary);">MediaStore API (Framework)</a></li>
                    <li><a href="https://cs.android.com/android/platform/superproject/+/master:packages/providers/MediaProvider/jni/FuseDaemon.cpp" target="_blank" style="color: var(--accent-primary);">FuseDaemon (Native)</a></li>
                </ul>
            </div>
        </section>

        <!-- Section 13: Related Documentation -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">13</span>
                ê´€ë ¨ ìƒì„¸ ë¬¸ì„œ
            </h2>
            <p class="section-description">
                MediaProviderì™€ ê´€ë ¨ëœ ë‹¤ë¥¸ ìƒì„¸ ë¬¸ì„œ í˜ì´ì§€ë¡œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ—ï¸</span>
                        Media Framework Core
                    </h3>
                    <div class="card-description">
                        <p>Android ë¯¸ë””ì–´ í”„ë ˆì„ì›Œí¬ì˜ ì „ì²´ ì•„í‚¤í…ì²˜ì™€ ê³„ì¸µ êµ¬ì¡°ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>Framework â†’ Native ê³„ì¸µ ìƒí˜¸ì‘ìš©</li>
                            <li>MediaPlayer, MediaRecorder API</li>
                            <li>Binder IPC í†µì‹ </li>
                        </ul>
                        <a href="media-framework-core.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“¦</span>
                        MediaExtractor
                    </h3>
                    <div class="card-description">
                        <p>ì»¨í…Œì´ë„ˆ íŒŒì‹± ë° ë””ë¨¹ì‹± ì•„í‚¤í…ì²˜ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>MP4/MKV/WebM Parser</li>
                            <li>ìƒ˜í”Œ ì¶”ì¶œ ë©”ì»¤ë‹ˆì¦˜</li>
                            <li>Seeking ë° Metadata</li>
                        </ul>
                        <a href="media-extractor.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¥</span>
                        Media Playback Pipeline
                    </h3>
                    <div class="card-description">
                        <p>ë¯¸ë””ì–´ ì¬ìƒ íŒŒì´í”„ë¼ì¸ê³¼ NuPlayerë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>NuPlayer ì•„í‚¤í…ì²˜</li>
                            <li>ë²„í¼ ê´€ë¦¬ ë° A/V Sync</li>
                            <li>ìŠ¤íŠ¸ë¦¬ë° íŒŒì´í”„ë¼ì¸</li>
                        </ul>
                        <a href="media-playback.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”Š</span>
                        Audio Framework
                    </h3>
                    <div class="card-description">
                        <p>AudioFlingerì™€ ì˜¤ë””ì˜¤ íŒŒì´í”„ë¼ì¸ì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>AudioTrack/AudioRecord</li>
                            <li>AudioFlinger ë¯¹ì‹±</li>
                            <li>ì˜¤ë””ì˜¤ ë¼ìš°íŒ… ì •ì±…</li>
                        </ul>
                        <a href="audio-framework.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸµ</span>
                        MediaSession
                    </h3>
                    <div class="card-description">
                        <p>ë¯¸ë””ì–´ ì¬ìƒ ì œì–´ ë° ì„¸ì…˜ ê´€ë¦¬ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>MediaSession í”„ë ˆì„ì›Œí¬</li>
                            <li>Android Auto í†µí•©</li>
                            <li>Media3 vs Legacy</li>
                        </ul>
                        <a href="mediasession.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        Widevine DRM
                    </h3>
                    <div class="card-description">
                        <p>Widevine DRM ì•„í‚¤í…ì²˜ì™€ ë³´ì•ˆ ë ˆë²¨ì„ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>L1/L2/L3 ë³´ì•ˆ ë ˆë²¨</li>
                            <li>MediaDrm API</li>
                            <li>Provisioning & ë¼ì´ì„ ìŠ¤</li>
                        </ul>
                        <a href="widevine.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>
            </div>

            <div class="highlight-box" style="margin-top: 40px;">
                <h3 style="color: var(--accent-primary); font-size: 1.2rem; margin-bottom: 15px;">
                    ğŸ“š ì¶”ê°€ í•™ìŠµ ë¦¬ì†ŒìŠ¤
                </h3>
                <ul style="padding-left: 20px;">
                    <li><strong>Android Developer - Storage</strong>: <a href="https://developer.android.com/training/data-storage" target="_blank" style="color: var(--accent-primary);">developer.android.com/training/data-storage</a></li>
                    <li><strong>Scoped Storage ê°€ì´ë“œ</strong>: <a href="https://developer.android.com/about/versions/11/privacy/storage" target="_blank" style="color: var(--accent-primary);">developer.android.com/about/versions/11/privacy/storage</a></li>
                    <li><strong>MediaStore API ë ˆí¼ëŸ°ìŠ¤</strong>: <a href="https://developer.android.com/reference/android/provider/MediaStore" target="_blank" style="color: var(--accent-primary);">developer.android.com/reference/android/provider/MediaStore</a></li>
                    <li><strong>Storage Access Framework</strong>: <a href="https://developer.android.com/guide/topics/providers/document-provider" target="_blank" style="color: var(--accent-primary);">developer.android.com/guide/topics/providers/document-provider</a></li>
                </ul>
            </div>
        </section>

        <!-- Footer -->
        <footer
            style="text-align: center; padding: 40px 20px; color: var(--text-muted); border-top: 1px solid var(--border-color); margin-top: 60px;">
            <p>Android MediaProvider Architecture</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                MediaStore, Scoped Storage & FUSE Daemon Deep Dive
            </p>
            <p style="margin-top: 20px;">
                <a href="index.html" style="color: var(--accent-primary); text-decoration: none;">
                    â† AOSP Media Frameworkë¡œ ëŒì•„ê°€ê¸°
                </a>
            </p>
        </footer>
    </div>

    <script src="scripts/mermaid-theme.js"></script>
    <script>
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(30px)';
            section.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
            observer.observe(section);
        });
    </script>
    <!-- Navigation & Copy Features -->
    <script src="scripts/copy-code.js"></script>
    <script src="scripts/toc-generator.js"></script>
    <script src="scripts/page-navigation.js"></script>
    <!-- Interactive Diagram Features -->
    <script src="scripts/diagram-data.js"></script>
    <script src="scripts/diagram-interactive.js"></script>

    <script src="scripts/theme-toggle.js"></script>
</body>

</html>