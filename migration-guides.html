<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Migration Guides</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700;900&family=IBM+Plex+Mono:wght@400;500;600&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/design-system.css">

        <style>
        /* Page-specific styles loaded from design-system.css */
    </style>
</head>

<body>
    <nav class="nav">
        <a href="index.html" class="nav-button">
            â† Android Media Framework
        </a>
    </nav>
    <div class="container">
        <header>
            <h1 class="page-title">ğŸ”„ Migration Guides</h1>
            <p class="page-subtitle">ë ˆê±°ì‹œ APIì—ì„œ ìµœì‹  APIë¡œì˜ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ</p>
        </header>

        

        <!-- TOC -->
        <section class="content-section section">
            <h2 class="section-title"><span class="section-number">01</span>ëª©ì°¨ (Table of Contents)</h2>
            <ol>
                <li><a href="#mediaplayer-to-exoplayer">MediaPlayer â†’ ExoPlayer ë§ˆì´ê·¸ë ˆì´ì…˜</a></li>
                <li><a href="#exoplayer-to-media3">ExoPlayer 2.x â†’ Media3 ë§ˆì´ê·¸ë ˆì´ì…˜</a></li>
                <li><a href="#audio-focus">Legacy Audio Focus â†’ AudioFocusRequest</a></li>
                <li><a href="#mediasession">MediaSession â†’ MediaBrowserService</a></li>
                <li><a href="#android-versions">Android ë²„ì „ë³„ ì£¼ìš” ë³€ê²½ì‚¬í•­</a></li>
                <li><a href="#deprecated-apis">Deprecated API ëŒ€ì²´ ê°€ì´ë“œ</a></li>
            </ol>
        </section>

        <!-- Section 1: MediaPlayer to ExoPlayer -->
        <section id="mediaplayer-to-exoplayer" class="content-section section">
            <h2 class="section-title"><span class="section-number">02</span>1. MediaPlayer â†’ ExoPlayer ë§ˆì´ê·¸ë ˆì´ì…˜</h2>

            <div class="info-box">
                <strong>ğŸ’¡ ì™œ ExoPlayerë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•´ì•¼ í•˜ë‚˜ìš”?</strong>
                <ul>
                    <li><strong>ìœ ì—°ì„±</strong>: ì»¤ìŠ¤í…€ ë Œë”ëŸ¬, ë°ì´í„° ì†ŒìŠ¤, DRM ì§€ì›</li>
                    <li><strong>ìµœì‹  ê¸°ëŠ¥</strong>: DASH/HLS/SmoothStreaming, ABR (Adaptive Bitrate)</li>
                    <li><strong>ë””ë²„ê¹…</strong>: ìƒì„¸í•œ ì´ë²¤íŠ¸ ì½œë°±, ë¡œê¹…</li>
                    <li><strong>ì„±ëŠ¥</strong>: íš¨ìœ¨ì ì¸ ë²„í¼ ê´€ë¦¬, í”„ë¦¬ë¡œë”©</li>
                    <li><strong>í™•ì¥ì„±</strong>: í”ŒëŸ¬ê·¸ì¸ ì•„í‚¤í…ì²˜</li>
                </ul>
            </div>

            <h3>1.1 ê¸°ë³¸ ì¬ìƒ ë§ˆì´ê·¸ë ˆì´ì…˜</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>MediaPlayer (ê¸°ì¡´)</h4>
                    <pre><code class="language-kotlin">// MediaPlayer
val mediaPlayer = MediaPlayer().apply {
    setDataSource(context, uri)
    setOnPreparedListener { mp ->
        mp.start()
    }
    setOnCompletionListener { mp ->
        Log.d(TAG, "ì¬ìƒ ì™„ë£Œ")
    }
    setOnErrorListener { mp, what, extra ->
        Log.e(TAG, "ì—ëŸ¬: $what")
        true
    }
    prepareAsync()
}

// ì¼ì‹œì •ì§€
mediaPlayer.pause()

// Seek
mediaPlayer.seekTo(30000)

// ë¦¬ì†ŒìŠ¤ í•´ì œ
mediaPlayer.release()</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>ExoPlayer / Media3 (ì‹ ê·œ)</h4>
                    <pre><code class="language-kotlin">// ExoPlayer (Media3)
val player = ExoPlayer.Builder(context).build()

player.addListener(object : Player.Listener {
    override fun onPlaybackStateChanged(state: Int) {
        when (state) {
            Player.STATE_READY -> Log.d(TAG, "ì¤€ë¹„ ì™„ë£Œ")
            Player.STATE_ENDED -> Log.d(TAG, "ì¬ìƒ ì™„ë£Œ")
        }
    }

    override fun onPlayerError(error: PlaybackException) {
        Log.e(TAG, "ì—ëŸ¬: ${error.errorCode}", error)
    }
})

val mediaItem = MediaItem.fromUri(uri)
player.setMediaItem(mediaItem)
player.prepare()
player.play()

// ì¼ì‹œì •ì§€
player.pause()

// Seek
player.seekTo(30_000)

// ë¦¬ì†ŒìŠ¤ í•´ì œ
player.release()</code></pre>
                </div>
            </div>

            <h3>1.2 ë¦¬ìŠ¤ë„ˆ ë§¤í•‘</h3>
            <table>
                <thead>
                    <tr>
                        <th>MediaPlayer</th>
                        <th>ExoPlayer / Media3</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>OnPreparedListener</code></td>
                        <td><code>Player.Listener.onPlaybackStateChanged(STATE_READY)</code></td>
                    </tr>
                    <tr>
                        <td><code>OnCompletionListener</code></td>
                        <td><code>Player.Listener.onPlaybackStateChanged(STATE_ENDED)</code></td>
                    </tr>
                    <tr>
                        <td><code>OnErrorListener</code></td>
                        <td><code>Player.Listener.onPlayerError()</code></td>
                    </tr>
                    <tr>
                        <td><code>OnSeekCompleteListener</code></td>
                        <td><code>Player.Listener.onPositionDiscontinuity()</code></td>
                    </tr>
                    <tr>
                        <td><code>OnBufferingUpdateListener</code></td>
                        <td><code>Player.Listener.onPlaybackStateChanged(STATE_BUFFERING)</code></td>
                    </tr>
                </tbody>
            </table>

            <h3>1.3 í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë§ˆì´ê·¸ë ˆì´ì…˜</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>MediaPlayer (ê¸°ì¡´)</h4>
                    <pre><code class="language-kotlin">// MediaPlayerëŠ” í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë¯¸ì§€ì›
// ìˆ˜ë™ìœ¼ë¡œ ê´€ë¦¬ í•„ìš”
val playlist = listOf(uri1, uri2, uri3)
var currentIndex = 0

fun playNext() {
    if (currentIndex < playlist.size - 1) {
        currentIndex++
        mediaPlayer.reset()
        mediaPlayer.setDataSource(context, playlist[currentIndex])
        mediaPlayer.prepareAsync()
    }
}

mediaPlayer.setOnCompletionListener {
    playNext()
}</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>ExoPlayer / Media3 (ì‹ ê·œ)</h4>
                    <pre><code class="language-kotlin">// ExoPlayerëŠ” ë„¤ì´í‹°ë¸Œ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì§€ì›
val mediaItems = listOf(
    MediaItem.fromUri(uri1),
    MediaItem.fromUri(uri2),
    MediaItem.fromUri(uri3)
)

player.setMediaItems(mediaItems)
player.prepare()
player.play()

// ìë™ìœ¼ë¡œ ë‹¤ìŒ íŠ¸ë™ ì¬ìƒ
// ë˜ëŠ” ìˆ˜ë™ ì œì–´
player.seekToNext()
player.seekToPrevious()</code></pre>
                </div>
            </div>

            <h3>1.4 DRM ë§ˆì´ê·¸ë ˆì´ì…˜</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>MediaPlayer (ê¸°ì¡´)</h4>
                    <pre><code class="language-kotlin">// MediaPlayer DRM (ë³µì‚)
val mediaDrm = MediaDrm(C.WIDEVINE_UUID)
val sessionId = mediaDrm.openSession()

mediaDrm.setOnEventListener { drm, sessionId, event, extra, data ->
    // ìˆ˜ë™ ë¼ì´ì„ ìŠ¤ ì²˜ë¦¬
}

val mediaCrypto = MediaCrypto(C.WIDEVINE_UUID, sessionId)

// MediaCodecì— ì§ì ‘ ì „ë‹¬
decoder.configure(format, surface, mediaCrypto, 0)</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>ExoPlayer / Media3 (ì‹ ê·œ)</h4>
                    <pre><code class="language-kotlin">// ExoPlayer DRM (ê°„ë‹¨)
val mediaItem = MediaItem.Builder()
    .setUri(videoUri)
    .setDrmConfiguration(
        MediaItem.DrmConfiguration.Builder(C.WIDEVINE_UUID)
            .setLicenseUri("https://license.example.com/widevine")
            .build()
    )
    .build()

player.setMediaItem(mediaItem)
player.prepare()
player.play()

// DRM ì„¸ì…˜ ìë™ ê´€ë¦¬!</code></pre>
                </div>
            </div>

            <h3>1.5 UI í†µí•©</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>MediaPlayer (ê¸°ì¡´)</h4>
                    <pre><code class="language-xml">&lt;!-- VideoView (ì œí•œì  ì»¤ìŠ¤í„°ë§ˆì´ì§•) --&gt;
&lt;VideoView
    android:id="@+id/video_view"
    android:layout_width="match_parent"
    android:layout_height="match_parent" /&gt;</code></pre>
                    <pre><code class="language-kotlin">val videoView = findViewById&lt;VideoView&gt;(R.id.video_view)
videoView.setVideoURI(uri)
videoView.start()</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>ExoPlayer / Media3 (ì‹ ê·œ)</h4>
                    <pre><code class="language-xml">&lt;!-- PlayerView (ì™„ì „ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥) --&gt;
&lt;androidx.media3.ui.PlayerView
    android:id="@+id/player_view"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:show_buffering="when_playing"
    app:resize_mode="fit"
    app:controller_layout_id="@layout/custom_controls" /&gt;</code></pre>
                    <pre><code class="language-kotlin">val playerView = findViewById&lt;PlayerView&gt;(R.id.player_view)
playerView.player = player</code></pre>
                </div>
            </div>

            <div class="success-box">
                <strong>âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸</strong>
                <ol>
                    <li>Gradle ì˜ì¡´ì„± ì¶”ê°€: <code>androidx.media3:media3-exoplayer:1.2.0</code></li>
                    <li>MediaPlayer ë¦¬ìŠ¤ë„ˆë¥¼ Player.Listenerë¡œ ë³€í™˜</li>
                    <li>prepare()/prepareAsync() â†’ prepare() + play()</li>
                    <li>VideoView â†’ PlayerView</li>
                    <li>DRM ì„¤ì •ì„ MediaItem.DrmConfigurationìœ¼ë¡œ ê°„ì†Œí™”</li>
                </ol>
            </div>
        </section>

        <!-- Section 2: ExoPlayer to Media3 -->
        <section id="exoplayer-to-media3" class="content-section section">
            <h2 class="section-title"><span class="section-number">03</span>2. ExoPlayer 2.x â†’ Media3 ë§ˆì´ê·¸ë ˆì´ì…˜</h2>

            <div class="info-box">
                <strong>ğŸ’¡ Media3ë€?</strong>
                <p>Media3ëŠ” ExoPlayer 2.xì˜ <strong>AndroidX ë§ˆì´ê·¸ë ˆì´ì…˜ ë²„ì „</strong>ì…ë‹ˆë‹¤. íŒ¨í‚¤ì§€ ì´ë¦„ê³¼ ì¼ë¶€ APIê°€ ë³€ê²½ë˜ì—ˆì§€ë§Œ ëŒ€ë¶€ë¶„ì˜ ê¸°ëŠ¥ì€ ë™ì¼í•©ë‹ˆë‹¤.</p>
            </div>

            <h3>2.1 íŒ¨í‚¤ì§€ ì´ë¦„ ë³€ê²½</h3>

            <table>
                <thead>
                    <tr>
                        <th>ExoPlayer 2.x</th>
                        <th>Media3</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>com.google.android.exoplayer2.*</code></td>
                        <td><code>androidx.media3.*</code></td>
                    </tr>
                    <tr>
                        <td><code>com.google.android.exoplayer2.ExoPlayer</code></td>
                        <td><code>androidx.media3.exoplayer.ExoPlayer</code></td>
                    </tr>
                    <tr>
                        <td><code>com.google.android.exoplayer2.ui.PlayerView</code></td>
                        <td><code>androidx.media3.ui.PlayerView</code></td>
                    </tr>
                    <tr>
                        <td><code>com.google.android.exoplayer2.source.MediaSource</code></td>
                        <td><code>androidx.media3.exoplayer.source.MediaSource</code></td>
                    </tr>
                </tbody>
            </table>

            <h3>2.2 Gradle ì˜ì¡´ì„± ë³€ê²½</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>ExoPlayer 2.x (ê¸°ì¡´)</h4>
                    <pre><code class="language-groovy">// build.gradle
dependencies {
    implementation 'com.google.android.exoplayer:exoplayer:2.18.7'
    implementation 'com.google.android.exoplayer:exoplayer-core:2.18.7'
    implementation 'com.google.android.exoplayer:exoplayer-ui:2.18.7'
    implementation 'com.google.android.exoplayer:exoplayer-dash:2.18.7'
    implementation 'com.google.android.exoplayer:exoplayer-hls:2.18.7'
}</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>Media3 (ì‹ ê·œ)</h4>
                    <pre><code class="language-groovy">// build.gradle
dependencies {
    implementation 'androidx.media3:media3-exoplayer:1.2.0'
    implementation 'androidx.media3:media3-ui:1.2.0'
    implementation 'androidx.media3:media3-exoplayer-dash:1.2.0'
    implementation 'androidx.media3:media3-exoplayer-hls:1.2.0'
    implementation 'androidx.media3:media3-session:1.2.0'  // NEW!
}</code></pre>
                </div>
            </div>

            <h3>2.3 SimpleExoPlayer â†’ ExoPlayer</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>ExoPlayer 2.x (ê¸°ì¡´)</h4>
                    <pre><code class="language-kotlin">import com.google.android.exoplayer2.SimpleExoPlayer

val player = SimpleExoPlayer.Builder(context).build()</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>Media3 (ì‹ ê·œ)</h4>
                    <pre><code class="language-kotlin">import androidx.media3.exoplayer.ExoPlayer

val player = ExoPlayer.Builder(context).build()
// SimpleExoPlayerëŠ” ExoPlayerë¡œ í†µí•©ë¨</code></pre>
                </div>
            </div>

            <h3>2.4 MediaSource â†’ MediaItem</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>ExoPlayer 2.x (ê¸°ì¡´)</h4>
                    <pre><code class="language-kotlin">// MediaSource ìˆ˜ë™ ìƒì„±
val dataSourceFactory = DefaultHttpDataSource.Factory()
val mediaSource = ProgressiveMediaSource.Factory(dataSourceFactory)
    .createMediaSource(MediaItem.fromUri(uri))

player.setMediaSource(mediaSource)
player.prepare()</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>Media3 (ì‹ ê·œ)</h4>
                    <pre><code class="language-kotlin">// MediaItemìœ¼ë¡œ ê°„ì†Œí™” (ìë™ MediaSource ìƒì„±)
val mediaItem = MediaItem.fromUri(uri)
player.setMediaItem(mediaItem)
player.prepare()

// ë˜ëŠ” ì»¤ìŠ¤í…€ MediaSource ê³„ì† ì‚¬ìš© ê°€ëŠ¥
val mediaSource = ProgressiveMediaSource.Factory(dataSourceFactory)
    .createMediaSource(MediaItem.fromUri(uri))
player.setMediaSource(mediaSource)</code></pre>
                </div>
            </div>

            <h3>2.5 EventListener â†’ Player.Listener</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>ExoPlayer 2.x (ê¸°ì¡´)</h4>
                    <pre><code class="language-kotlin">import com.google.android.exoplayer2.Player

player.addListener(object : Player.EventListener {
    override fun onPlayerStateChanged(playWhenReady: Boolean, playbackState: Int) {
        // ì²˜ë¦¬
    }
})</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>Media3 (ì‹ ê·œ)</h4>
                    <pre><code class="language-kotlin">import androidx.media3.common.Player

player.addListener(object : Player.Listener {
    override fun onPlaybackStateChanged(playbackState: Int) {
        // onPlayerStateChanged â†’ onPlaybackStateChanged
        // playWhenReadyëŠ” onPlayWhenReadyChangedë¡œ ë¶„ë¦¬
    }

    override fun onPlayWhenReadyChanged(playWhenReady: Boolean, reason: Int) {
        // ìƒˆ ì½œë°±
    }
})</code></pre>
                </div>
            </div>

            <h3>2.6 ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸</h3>

            <pre><code class="language-bash"># Android Studio: Replace in Path (Ctrl+Shift+R / Cmd+Shift+R)

# 1. íŒ¨í‚¤ì§€ ì´ë¦„ ë³€ê²½
com.google.android.exoplayer2 â†’ androidx.media3

# 2. SimpleExoPlayer â†’ ExoPlayer
SimpleExoPlayer.Builder â†’ ExoPlayer.Builder

# 3. EventListener â†’ Listener
Player.EventListener â†’ Player.Listener

# 4. onPlayerStateChanged â†’ onPlaybackStateChanged
onPlayerStateChanged â†’ onPlaybackStateChanged</code></pre>

            <div class="warning-box">
                <strong>âš ï¸ Breaking Changes</strong>
                <ul>
                    <li><code>Player.EventListener</code>ì˜ ì¼ë¶€ ë©”ì†Œë“œ ì‹œê·¸ë‹ˆì²˜ ë³€ê²½</li>
                    <li><code>SimpleExoPlayer</code> í´ë˜ìŠ¤ ì œê±° (ExoPlayerë¡œ í†µí•©)</li>
                    <li>ì¼ë¶€ Deprecated API ì œê±°</li>
                </ul>
            </div>

            <div class="success-box">
                <strong>âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ ë‹¨ê³„</strong>
                <ol>
                    <li>Gradle ì˜ì¡´ì„±ì„ <code>androidx.media3:media3-*</code>ë¡œ ë³€ê²½</li>
                    <li>Android Studioì˜ "Replace in Path"ë¡œ íŒ¨í‚¤ì§€ ì´ë¦„ ì¼ê´„ ë³€ê²½</li>
                    <li><code>SimpleExoPlayer</code> â†’ <code>ExoPlayer</code></li>
                    <li><code>Player.EventListener</code> â†’ <code>Player.Listener</code></li>
                    <li>ì»´íŒŒì¼ ì—ëŸ¬ ìˆ˜ì • ë° í…ŒìŠ¤íŠ¸</li>
                </ol>
            </div>
        </section>

        <!-- Section 3: Audio Focus -->
        <section id="audio-focus" class="content-section section">
            <h2 class="section-title"><span class="section-number">04</span>3. Legacy Audio Focus â†’ AudioFocusRequest</h2>

            <div class="info-box">
                <strong>ğŸ’¡ Android 8.0 (API 26)ë¶€í„° AudioFocusRequest ì‚¬ìš© ê¶Œì¥</strong>
                <p>ë ˆê±°ì‹œ <code>requestAudioFocus(OnAudioFocusChangeListener, int, int)</code>ëŠ” Deprecatedë˜ì—ˆìŠµë‹ˆë‹¤.</p>
            </div>

            <h3>3.1 ê¸°ë³¸ Audio Focus ë§ˆì´ê·¸ë ˆì´ì…˜</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>Legacy (ê¸°ì¡´)</h4>
                    <pre><code class="language-kotlin">val audioManager = getSystemService(Context.AUDIO_SERVICE) as AudioManager

val focusChangeListener = AudioManager.OnAudioFocusChangeListener { focusChange ->
    when (focusChange) {
        AudioManager.AUDIOFOCUS_GAIN -> player.play()
        AudioManager.AUDIOFOCUS_LOSS -> player.pause()
    }
}

val result = audioManager.requestAudioFocus(
    focusChangeListener,
    AudioManager.STREAM_MUSIC,
    AudioManager.AUDIOFOCUS_GAIN
)

if (result == AudioManager.AUDIOFOCUS_REQUEST_GRANTED) {
    player.play()
}</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>AudioFocusRequest (ì‹ ê·œ)</h4>
                    <pre><code class="language-kotlin">val audioManager = getSystemService(Context.AUDIO_SERVICE) as AudioManager

val audioAttributes = AudioAttributes.Builder()
    .setUsage(AudioAttributes.USAGE_MEDIA)
    .setContentType(AudioAttributes.CONTENT_TYPE_MUSIC)
    .build()

val focusRequest = AudioFocusRequest.Builder(AudioManager.AUDIOFOCUS_GAIN)
    .setAudioAttributes(audioAttributes)
    .setAcceptsDelayedFocusGain(true)  // NEW!
    .setWillPauseWhenDucked(false)     // NEW!
    .setOnAudioFocusChangeListener { focusChange ->
        when (focusChange) {
            AudioManager.AUDIOFOCUS_GAIN -> player.play()
            AudioManager.AUDIOFOCUS_LOSS -> player.pause()
        }
    }
    .build()

val result = audioManager.requestAudioFocus(focusRequest)
if (result == AudioManager.AUDIOFOCUS_REQUEST_GRANTED) {
    player.play()
}</code></pre>
                </div>
            </div>

            <h3>3.2 AudioAttributes ë§¤í•‘</h3>

            <table>
                <thead>
                    <tr>
                        <th>Legacy StreamType</th>
                        <th>AudioAttributes.USAGE_*</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>STREAM_MUSIC</code></td>
                        <td><code>USAGE_MEDIA</code></td>
                    </tr>
                    <tr>
                        <td><code>STREAM_ALARM</code></td>
                        <td><code>USAGE_ALARM</code></td>
                    </tr>
                    <tr>
                        <td><code>STREAM_NOTIFICATION</code></td>
                        <td><code>USAGE_NOTIFICATION</code></td>
                    </tr>
                    <tr>
                        <td><code>STREAM_VOICE_CALL</code></td>
                        <td><code>USAGE_VOICE_COMMUNICATION</code></td>
                    </tr>
                    <tr>
                        <td><code>STREAM_RING</code></td>
                        <td><code>USAGE_NOTIFICATION_RINGTONE</code></td>
                    </tr>
                </tbody>
            </table>

            <h3>3.3 Delayed Focus Gain (ìƒˆ ê¸°ëŠ¥)</h3>

            <pre><code class="language-kotlin">// API 26+: Delayed Focus ì§€ì›
val focusRequest = AudioFocusRequest.Builder(AudioManager.AUDIOFOCUS_GAIN)
    .setAudioAttributes(audioAttributes)
    .setAcceptsDelayedFocusGain(true)  // í¬ì»¤ìŠ¤ë¥¼ ë‚˜ì¤‘ì— ë°›ì„ ìˆ˜ ìˆìŒ
    .setOnAudioFocusChangeListener { focusChange ->
        when (focusChange) {
            AudioManager.AUDIOFOCUS_GAIN -> {
                // ì¦‰ì‹œ ë˜ëŠ” ì§€ì—°ëœ í¬ì»¤ìŠ¤ íšë“
                player.play()
            }
        }
    }
    .build()

val result = audioManager.requestAudioFocus(focusRequest)
when (result) {
    AudioManager.AUDIOFOCUS_REQUEST_GRANTED -> {
        // ì¦‰ì‹œ í¬ì»¤ìŠ¤ íšë“
        player.play()
    }
    AudioManager.AUDIOFOCUS_REQUEST_DELAYED -> {
        // í¬ì»¤ìŠ¤ë¥¼ ë‚˜ì¤‘ì— íšë“ (OnAudioFocusChangeListenerì—ì„œ GAIN ë°›ìŒ)
        showBuffering()
    }
    AudioManager.AUDIOFOCUS_REQUEST_FAILED -> {
        // ì‹¤íŒ¨
        showError()
    }
}</code></pre>

            <h3>3.4 í˜¸í™˜ì„± ì½”ë“œ</h3>

            <pre><code class="language-kotlin">fun requestAudioFocusCompat(audioManager: AudioManager): Int {
    return if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
        // API 26+: AudioFocusRequest
        val focusRequest = AudioFocusRequest.Builder(AudioManager.AUDIOFOCUS_GAIN)
            .setAudioAttributes(audioAttributes)
            .setOnAudioFocusChangeListener(focusChangeListener)
            .build()
        audioManager.requestAudioFocus(focusRequest)
    } else {
        // API 25 ì´í•˜: Legacy
        @Suppress("DEPRECATION")
        audioManager.requestAudioFocus(
            focusChangeListener,
            AudioManager.STREAM_MUSIC,
            AudioManager.AUDIOFOCUS_GAIN
        )
    }
}</code></pre>
        </section>

        <!-- Section 4: MediaSession -->
        <section id="mediasession" class="content-section section">
            <h2 class="section-title"><span class="section-number">05</span>4. MediaSession â†’ MediaBrowserService</h2>

            <div class="info-box">
                <strong>ğŸ’¡ Car Media / Wear OS í†µí•©</strong>
                <p><code>MediaBrowserService</code>ë¥¼ êµ¬í˜„í•˜ë©´ Android Auto, Wear OS, Google Assistantì—ì„œ ìë™ìœ¼ë¡œ ë¯¸ë””ì–´ ì•±ì„ ì¸ì‹í•©ë‹ˆë‹¤.</p>
            </div>

            <h3>4.1 ê¸°ë³¸ MediaSession â†’ MediaBrowserService</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>MediaSessionë§Œ (ê¸°ì¡´)</h4>
                    <pre><code class="language-kotlin">// Activityì—ì„œë§Œ ì‚¬ìš©
class MusicPlayerActivity : AppCompatActivity() {
    private lateinit var mediaSession: MediaSession

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        mediaSession = MediaSession(this, "MyMediaSession")
        mediaSession.isActive = true

        mediaSession.setCallback(object : MediaSession.Callback() {
            override fun onPlay() {
                player.play()
            }
        })
    }
}</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>MediaBrowserService (ì‹ ê·œ)</h4>
                    <pre><code class="language-kotlin">// Serviceë¡œ ë¶„ë¦¬ (ë°±ê·¸ë¼ìš´ë“œ ì¬ìƒ)
class MusicService : MediaBrowserServiceCompat() {
    private lateinit var mediaSession: MediaSessionCompat

    override fun onCreate() {
        super.onCreate()

        mediaSession = MediaSessionCompat(this, "MusicService")
        mediaSession.isActive = true
        sessionToken = mediaSession.sessionToken

        mediaSession.setCallback(object : MediaSessionCompat.Callback() {
            override fun onPlay() {
                player.play()
            }
        })
    }

    override fun onGetRoot(
        clientPackageName: String,
        clientUid: Int,
        rootHints: Bundle?
    ): BrowserRoot? {
        return BrowserRoot("root", null)
    }

    override fun onLoadChildren(
        parentId: String,
        result: Result&lt;List&lt;MediaBrowserCompat.MediaItem&gt;&gt;
    ) {
        val mediaItems = buildMediaItems()
        result.sendResult(mediaItems)
    }
}</code></pre>
                </div>
            </div>

            <h3>4.2 AndroidManifest.xml ì„¤ì •</h3>

            <pre><code class="language-xml">&lt;service
    android:name=".MusicService"
    android:exported="true"&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="android.media.browse.MediaBrowserService" /&gt;
    &lt;/intent-filter&gt;
&lt;/service&gt;</code></pre>

            <h3>4.3 MediaBrowser í´ë¼ì´ì–¸íŠ¸ (Activity)</h3>

            <pre><code class="language-kotlin">class MusicPlayerActivity : AppCompatActivity() {
    private lateinit var mediaBrowser: MediaBrowserCompat
    private lateinit var mediaController: MediaControllerCompat

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        mediaBrowser = MediaBrowserCompat(
            this,
            ComponentName(this, MusicService::class.java),
            object : MediaBrowserCompat.ConnectionCallback() {
                override fun onConnected() {
                    val sessionToken = mediaBrowser.sessionToken
                    mediaController = MediaControllerCompat(this@MusicPlayerActivity, sessionToken)
                    MediaControllerCompat.setMediaController(this@MusicPlayerActivity, mediaController)

                    buildTransportControls()
                }
            },
            null
        )

        mediaBrowser.connect()
    }

    private fun buildTransportControls() {
        val transportControls = mediaController.transportControls

        findViewById&lt;Button&gt;(R.id.play_button).setOnClickListener {
            transportControls.play()
        }

        findViewById&lt;Button&gt;(R.id.pause_button).setOnClickListener {
            transportControls.pause()
        }
    }

    override fun onDestroy() {
        super.onDestroy()
        mediaBrowser.disconnect()
    }
}</code></pre>

            <h3>4.4 Media3 MediaSession (ìµœì‹ )</h3>

            <div class="success-box">
                <strong>âœ… Media3 1.xë¶€í„° ìƒˆë¡œìš´ MediaSession API ì œê³µ</strong>
                <pre><code class="language-kotlin">import androidx.media3.session.MediaSession
import androidx.media3.session.MediaSessionService

class MusicService : MediaSessionService() {
    private var mediaSession: MediaSession? = null

    override fun onCreate() {
        super.onCreate()

        val player = ExoPlayer.Builder(this).build()
        mediaSession = MediaSession.Builder(this, player).build()
    }

    override fun onGetSession(controllerInfo: MediaSession.ControllerInfo): MediaSession? {
        return mediaSession
    }

    override fun onDestroy() {
        mediaSession?.run {
            player.release()
            release()
            mediaSession = null
        }
        super.onDestroy()
    }
}</code></pre>
            </div>
        </section>

        <!-- Section 5: Android Versions -->
        <section id="android-versions" class="content-section section">
            <h2 class="section-title"><span class="section-number">06</span>5. Android ë²„ì „ë³„ ì£¼ìš” ë³€ê²½ì‚¬í•­</h2>

            <h3>5.1 Android 14 (API 34)</h3>
            <ul>
                <li><span class="badge badge-new">NEW</span> <strong>Ultra HDR</strong>: 10-bit HDR ì´ë¯¸ì§€ ì§€ì›</li>
                <li><span class="badge badge-new">NEW</span> <strong>Lossless USB Audio</strong>: USB ì˜¤ë””ì˜¤ ë¬´ì†ì‹¤ ì „ì†¡</li>
                <li><span class="badge badge-breaking">BREAKING</span> <strong>Foreground Service ê¶Œí•œ</strong>: ë¯¸ë””ì–´ ì¬ìƒ ì‹œ <code>FOREGROUND_SERVICE_MEDIA_PLAYBACK</code> ê¶Œí•œ í•„ìš”</li>
            </ul>

            <pre><code class="language-xml">&lt;!-- AndroidManifest.xml --&gt;
&lt;uses-permission android:name="android.permission.FOREGROUND_SERVICE" /&gt;
&lt;uses-permission android:name="android.permission.FOREGROUND_SERVICE_MEDIA_PLAYBACK" /&gt;

&lt;service
    android:name=".MusicService"
    android:foregroundServiceType="mediaPlayback" /&gt;</code></pre>

            <h3>5.2 Android 13 (API 33)</h3>
            <ul>
                <li><span class="badge badge-new">NEW</span> <strong>POST_NOTIFICATIONS ê¶Œí•œ</strong>: ì•Œë¦¼ í‘œì‹œ ì‹œ ëŸ°íƒ€ì„ ê¶Œí•œ í•„ìš”</li>
                <li><span class="badge badge-new">NEW</span> <strong>Photo Picker</strong>: ë¯¸ë””ì–´ ì„ íƒ UI ê°œì„ </li>
            </ul>

            <pre><code class="language-kotlin">// Android 13+: ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
    if (ContextCompat.checkSelfPermission(this, Manifest.permission.POST_NOTIFICATIONS)
        != PackageManager.PERMISSION_GRANTED) {
        ActivityCompat.requestPermissions(
            this,
            arrayOf(Manifest.permission.POST_NOTIFICATIONS),
            REQUEST_CODE
        )
    }
}</code></pre>

            <h3>5.3 Android 12 (API 31)</h3>
            <ul>
                <li><span class="badge badge-new">NEW</span> <strong>Performance Class</strong>: ë¯¸ë””ì–´ ì„±ëŠ¥ ë“±ê¸‰ (Class 11/12/13/14)</li>
                <li><span class="badge badge-new">NEW</span> <strong>Transcoding</strong>: HEVC â†’ AVC ìë™ ë³€í™˜</li>
                <li><span class="badge badge-new">NEW</span> <strong>Compat Media Transcoding</strong>: ë ˆê±°ì‹œ ì•± í˜¸í™˜ì„±</li>
            </ul>

            <pre><code class="language-kotlin">// Performance Class í™•ì¸
val perfClass = Build.VERSION.MEDIA_PERFORMANCE_CLASS
when {
    perfClass >= 31 -> enableHighEndFeatures()  // Class 11+
    perfClass >= 32 -> enableUltraHighEndFeatures()  // Class 12+
}</code></pre>

            <h3>5.4 Android 11 (API 30)</h3>
            <ul>
                <li><span class="badge badge-new">NEW</span> <strong>Scoped Storage ê°•ì œ</strong>: <code>MANAGE_EXTERNAL_STORAGE</code> ê¶Œí•œ í•„ìš”</li>
                <li><span class="badge badge-new">NEW</span> <strong>Auto-resume on Bluetooth</strong>: ë¸”ë£¨íˆ¬ìŠ¤ ì¬ì—°ê²° ì‹œ ìë™ ì¬ìƒ</li>
            </ul>

            <h3>5.5 Android 10 (API 29)</h3>
            <ul>
                <li><span class="badge badge-new">NEW</span> <strong>Scoped Storage</strong>: MediaStore API í•„ìˆ˜</li>
                <li><span class="badge badge-new">NEW</span> <strong>AV1 Codec</strong>: AV1 ë””ì½”ë” ì§€ì›</li>
                <li><span class="badge badge-deprecated">DEPRECATED</span> <code>ACTION_OPEN_DOCUMENT</code> ëŒ€ì‹  <code>ACTION_GET_CONTENT</code></li>
            </ul>

            <h3>5.6 Android 9 (API 28)</h3>
            <ul>
                <li><span class="badge badge-new">NEW</span> <strong>HDR VP9 Video</strong>: VP9 Profile 2 (10-bit)</li>
                <li><span class="badge badge-new">NEW</span> <strong>HEIF Image</strong>: HEIF/HEIC í¬ë§· ì§€ì›</li>
                <li><span class="badge badge-breaking">BREAKING</span> <strong>Clear-text Traffic ì°¨ë‹¨</strong>: HTTPS ê°•ì œ (HTTP â†’ HTTPS)</li>
            </ul>

            <pre><code class="language-xml">&lt;!-- HTTP í—ˆìš© (ê°œë°œ í™˜ê²½ë§Œ) --&gt;
&lt;application
    android:usesCleartextTraffic="true"&gt;</code></pre>

            <h3>5.7 Android 8.0 (API 26)</h3>
            <ul>
                <li><span class="badge badge-new">NEW</span> <strong>AudioFocusRequest</strong>: ìƒˆë¡œìš´ Audio Focus API</li>
                <li><span class="badge badge-new">NEW</span> <strong>Notification Channels</strong>: ì•Œë¦¼ ì±„ë„ í•„ìˆ˜</li>
                <li><span class="badge badge-breaking">BREAKING</span> <strong>Background Service ì œí•œ</strong>: Foreground Service í•„ìˆ˜</li>
            </ul>

            <pre><code class="language-kotlin">// Notification Channel ìƒì„± (Android 8.0+)
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
    val channel = NotificationChannel(
        CHANNEL_ID,
        "Music Playback",
        NotificationManager.IMPORTANCE_LOW
    )
    val notificationManager = getSystemService(NotificationManager::class.java)
    notificationManager.createNotificationChannel(channel)
}</code></pre>
        </section>

        <!-- Section 6: Deprecated APIs -->
        <section id="deprecated-apis" class="content-section section">
            <h2 class="section-title"><span class="section-number">07</span>6. Deprecated API ëŒ€ì²´ ê°€ì´ë“œ</h2>

            <h3>6.1 MediaPlayer Deprecated ë©”ì†Œë“œ</h3>

            <table>
                <thead>
                    <tr>
                        <th>Deprecated</th>
                        <th>ëŒ€ì²´</th>
                        <th>ë¹„ê³ </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>setAudioStreamType(int)</code></td>
                        <td><code>setAudioAttributes(AudioAttributes)</code></td>
                        <td>API 21+</td>
                    </tr>
                    <tr>
                        <td><code>attachAuxEffect(int)</code></td>
                        <td><code>AudioEffect API</code></td>
                        <td>ì§ì ‘ AudioEffect ì‚¬ìš©</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>Deprecated</h4>
                    <pre><code class="language-kotlin">mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC)</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>ëŒ€ì²´</h4>
                    <pre><code class="language-kotlin">val audioAttributes = AudioAttributes.Builder()
    .setUsage(AudioAttributes.USAGE_MEDIA)
    .setContentType(AudioAttributes.CONTENT_TYPE_MUSIC)
    .build()

mediaPlayer.setAudioAttributes(audioAttributes)</code></pre>
                </div>
            </div>

            <h3>6.2 AudioManager Deprecated ë©”ì†Œë“œ</h3>

            <table>
                <thead>
                    <tr>
                        <th>Deprecated</th>
                        <th>ëŒ€ì²´</th>
                        <th>ë¹„ê³ </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>requestAudioFocus(OnAudioFocusChangeListener, int, int)</code></td>
                        <td><code>requestAudioFocus(AudioFocusRequest)</code></td>
                        <td>API 26+</td>
                    </tr>
                    <tr>
                        <td><code>abandonAudioFocus(OnAudioFocusChangeListener)</code></td>
                        <td><code>abandonAudioFocus(AudioFocusRequest)</code></td>
                        <td>API 26+</td>
                    </tr>
                    <tr>
                        <td><code>setStreamVolume(int, int, int)</code></td>
                        <td><code>AudioAttributes ì‚¬ìš©</code></td>
                        <td>ì§ì ‘ ì œì–´ ì§€ì–‘</td>
                    </tr>
                </tbody>
            </table>

            <h3>6.3 MediaCodec Deprecated ìƒìˆ˜</h3>

            <table>
                <thead>
                    <tr>
                        <th>Deprecated</th>
                        <th>ëŒ€ì²´</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>INFO_OUTPUT_BUFFERS_CHANGED</code></td>
                        <td><code>getOutputBuffer(index)</code> ì‚¬ìš©</td>
                    </tr>
                    <tr>
                        <td><code>INFO_OUTPUT_FORMAT_CHANGED</code></td>
                        <td><code>getOutputFormat()</code></td>
                    </tr>
                </tbody>
            </table>

            <h3>6.4 Scoped Storage ë§ˆì´ê·¸ë ˆì´ì…˜</h3>

            <div class="code-comparison">
                <div class="code-block-before">
                    <h4>Legacy (Android 9 ì´í•˜)</h4>
                    <pre><code class="language-kotlin">// ì§ì ‘ íŒŒì¼ ê²½ë¡œ ì ‘ê·¼
val file = File("/sdcard/Music/song.mp3")
val uri = Uri.fromFile(file)
mediaPlayer.setDataSource(uri.toString())</code></pre>
                </div>

                <div class="code-block-after">
                    <h4>Scoped Storage (Android 10+)</h4>
                    <pre><code class="language-kotlin">// MediaStoreë¥¼ í†µí•œ ì ‘ê·¼
val projection = arrayOf(MediaStore.Audio.Media._ID, MediaStore.Audio.Media.DATA)
val cursor = contentResolver.query(
    MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,
    projection,
    "${MediaStore.Audio.Media.TITLE} = ?",
    arrayOf("song"),
    null
)

cursor?.use {
    if (it.moveToFirst()) {
        val id = it.getLong(it.getColumnIndexOrThrow(MediaStore.Audio.Media._ID))
        val uri = ContentUris.withAppendedId(MediaStore.Audio.Media.EXTERNAL_CONTENT_URI, id)
        mediaPlayer.setDataSource(applicationContext, uri)
    }
}</code></pre>
                </div>
            </div>

            <div class="warning-box">
                <strong>âš ï¸ Android 11ë¶€í„° Scoped Storage ê°•ì œ</strong>
                <p><code>requestLegacyExternalStorage</code> í”Œë˜ê·¸ê°€ ë¬´ì‹œë©ë‹ˆë‹¤. ëª¨ë“  íŒŒì¼ ì ‘ê·¼ì€ MediaStore ë˜ëŠ” SAF(Storage Access Framework)ë¥¼ í†µí•´ì•¼ í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <!-- Back to Home -->
        <section style="text-align: center; padding: 3rem;" class="content-section section">
            <a href="index.html" style="display: inline-block; padding: 1rem 2rem; background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple)); color: white; text-decoration: none; border-radius: 12px; font-weight: 600; transition: transform 0.3s ease;">
                â† Back to Main Page
            </a>
        </section>
    </div>

    <script src="scripts/mermaid-theme.js"></script>
    <!-- Navigation & Copy Features -->
    <script src="scripts/copy-code.js"></script>
    <script src="scripts/toc-generator.js"></script>
    <script src="scripts/page-navigation.js"></script>
    <!-- Interactive Diagram Features -->
    <script src="scripts/diagram-data.js"></script>
    <script src="scripts/diagram-interactive.js"></script>

    <script src="scripts/theme-toggle.js"></script>
</body>
</html>
