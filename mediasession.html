<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Android MediaSession Framework</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700;900&family=IBM+Plex+Mono:wght@400;500;600&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/design-system.css">

        <style>
        /* Page-specific styles loaded from design-system.css */
    </style>
</head>

<body>
    <nav class="nav">
        <a href="index.html" class="nav-button">
            â† AOSP Media Framework
        </a>
    </nav>

    <div class="container">
        <header>
            <h1 class="page-title">ğŸµ MediaSession</h1>
            <p class="page-subtitle">Android ë¯¸ë””ì–´ ì¬ìƒ ì œì–´ í”„ë ˆì„ì›Œí¬</p>
        </header>

        <!-- Section 1: Overview -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">1</span>
                MediaSession ê°œìš”
            </h2>
            <p class="section-description">
                MediaSessionì€ Androidì—ì„œ ë¯¸ë””ì–´ ì¬ìƒì„ ì œì–´í•˜ê³  ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” í•µì‹¬ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.
            </p>

            <div class="highlight-box">
                <strong>MediaSessionì´ë€?</strong> ì•±ì˜ ë¯¸ë””ì–´ í”Œë ˆì´ì–´ë¥¼ ì‹œìŠ¤í…œê³¼ ì™¸ë¶€ ì•±ì— ê´‘ê³ í•˜ê³ ,
                ë‹¤ì–‘í•œ ì†ŒìŠ¤(ì•Œë¦¼, Android Auto, Google Assistant ë“±)ë¡œë¶€í„° ì¬ìƒ ëª…ë ¹ì„ ë°›ì•„ ë¯¸ë””ì–´ ì¬ìƒì„ í†µí•© ì œì–´í•˜ëŠ” í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¯</span>
                        ì£¼ìš” ëª©ì 
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>ë¯¸ë””ì–´ ì¬ìƒ ìƒíƒœë¥¼ ì‹œìŠ¤í…œì— ê´‘ê³ </li>
                            <li>ì™¸ë¶€ì—ì„œ ë¯¸ë””ì–´ ì œì–´ ê°€ëŠ¥</li>
                            <li>ì¼ê´€ëœ ë¯¸ë””ì–´ ê²½í—˜ ì œê³µ</li>
                            <li>ë°±ê·¸ë¼ìš´ë“œ ì¬ìƒ ì§€ì›</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”Œ</span>
                        ì œì–´ ì†ŒìŠ¤
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>Notification</strong>: ì•Œë¦¼ ë¯¸ë””ì–´ ì»¨íŠ¸ë¡¤</li>
                            <li><strong>Android Auto</strong>: ì°¨ëŸ‰ ë””ìŠ¤í”Œë ˆì´</li>
                            <li><strong>Wear OS</strong>: ìŠ¤ë§ˆíŠ¸ì›Œì¹˜</li>
                            <li><strong>Google Assistant</strong>: ìŒì„± ëª…ë ¹</li>
                            <li><strong>Media Buttons</strong>: í—¤ë“œí° ë²„íŠ¼</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš™ï¸</span>
                        í•µì‹¬ ê¸°ëŠ¥
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>ì¬ìƒ/ì¼ì‹œì •ì§€/ì •ì§€/ê±´ë„ˆë›°ê¸°</li>
                            <li>ì¬ìƒ ìƒíƒœ ë° ë©”íƒ€ë°ì´í„° ì „ì†¡</li>
                            <li>í(Queue) ê´€ë¦¬</li>
                            <li>ë¯¸ë””ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ì²˜ë¦¬</li>
                            <li>ì™¸ë¶€ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ í†µì‹ </li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“š</span>
                        Media3 vs Legacy
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>Legacy</strong>: MediaSessionCompat</li>
                            <li><strong>Media3</strong>: androidx.media3.session</li>
                            <li>Media3ëŠ” í†µí•© Player ì¸í„°í˜ì´ìŠ¤</li>
                            <li>ExoPlayer ê¸°ë³¸ í†µí•©</li>
                            <li>ë” ë‹¨ìˆœí•œ ì•„í‚¤í…ì²˜</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Architecture -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">2</span>
                MediaSession ì•„í‚¤í…ì²˜
            </h2>
            <p class="section-description">
                MediaSession í”„ë ˆì„ì›Œí¬ëŠ” Client-Server êµ¬ì¡°ë¡œ ë¯¸ë””ì–´ ì•±ê³¼ ì™¸ë¶€ ì»¨íŠ¸ë¡¤ëŸ¬ ê°„ì˜ í†µì‹ ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    UI["ğŸ“± UI Activity<br />(MediaBrowser + MediaController)"]

                    SERVICE["ğŸµ MediaBrowserService / MediaSessionService<br />(Background Service)"]

                    SESSION["MediaSession<br />(Hub / Middleware)"]

                    PLAYER["ğŸ¶ Player<br />(ExoPlayer / MediaPlayer)"]

                    EXTERNAL["External Controllers"]
                    NOTIF["ğŸ“¢ Notification<br />MediaStyle"]
                    AUTO["ğŸš— Android Auto"]
                    WEAR["âŒš Wear OS"]
                    ASSISTANT["ğŸ¤ Google Assistant"]
                    BUTTON["ğŸ§ Media Buttons"]

                    UI -->|Browse Media| SERVICE
                    UI -->|Control Commands| SESSION
                    SERVICE -->|Contains| SESSION
                    SESSION -->|Delegates| PLAYER

                    NOTIF -->|Commands| SESSION
                    AUTO -->|Commands| SESSION
                    WEAR -->|Commands| SESSION
                    ASSISTANT -->|Commands| SESSION
                    BUTTON -->|Commands| SESSION

                    SESSION -->|State/Metadata Updates| UI
                    SESSION -->|State/Metadata Updates| EXTERNAL

                    EXTERNAL -.->|Group| NOTIF
                    EXTERNAL -.->|Group| AUTO
                    EXTERNAL -.->|Group| WEAR
                    EXTERNAL -.->|Group| ASSISTANT
                    EXTERNAL -.->|Group| BUTTON

                </div>
            </div>
        </section>

        <!-- Section 3: Components -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">3</span>
                ì£¼ìš” ì»´í¬ë„ŒíŠ¸
            </h2>
            <p class="section-description">
                MediaSession í”„ë ˆì„ì›Œí¬ì˜ í•µì‹¬ ì»´í¬ë„ŒíŠ¸ì™€ ì—­í• ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸµ</span>
                        MediaSession
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¸ë””ì–´ ì¬ìƒ í—ˆë¸Œ</strong></p>
                        <ul>
                            <li>í”Œë ˆì´ì–´ë¥¼ ì‹œìŠ¤í…œì— ê´‘ê³ </li>
                            <li>ì™¸ë¶€ ëª…ë ¹ì„ í”Œë ˆì´ì–´ì— ì „ë‹¬</li>
                            <li>ì¬ìƒ ìƒíƒœ ë° ë©”íƒ€ë°ì´í„° ì „ì†¡</li>
                            <li>SessionTokenìœ¼ë¡œ ì‹ë³„</li>
                            <li>Callbackìœ¼ë¡œ ëª…ë ¹ ìˆ˜ì‹ </li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ®</span>
                        MediaController
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¸ë””ì–´ ì œì–´ ì¸í„°í˜ì´ìŠ¤</strong></p>
                        <ul>
                            <li>MediaSessionì— ì—°ê²°</li>
                            <li>ì¬ìƒ ëª…ë ¹ ì „ì†¡ (play, pause, skip)</li>
                            <li>ìƒíƒœ ì—…ë°ì´íŠ¸ ìˆ˜ì‹ </li>
                            <li>Player ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ (Media3)</li>
                            <li>UIì™€ í”Œë ˆì´ì–´ ë¶„ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”</span>
                        MediaBrowser
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¸ë””ì–´ ë¼ì´ë¸ŒëŸ¬ë¦¬ íƒìƒ‰</strong></p>
                        <ul>
                            <li>MediaBrowserServiceì— ì—°ê²°</li>
                            <li>ë¯¸ë””ì–´ ì½˜í…ì¸  ê³„ì¸µ íƒìƒ‰</li>
                            <li>MediaController ìƒì„±</li>
                            <li>Android Auto/Wear í†µí•©</li>
                            <li>ë°±ê·¸ë¼ìš´ë“œ ì„œë¹„ìŠ¤ ì ‘ê·¼</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš™ï¸</span>
                        MediaBrowserService
                    </h3>
                    <div class="card-description">
                        <p><strong>ë°±ê·¸ë¼ìš´ë“œ ë¯¸ë””ì–´ ì„œë¹„ìŠ¤</strong></p>
                        <ul>
                            <li>MediaSession í˜¸ìŠ¤íŒ…</li>
                            <li>ë¯¸ë””ì–´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë…¸ì¶œ</li>
                            <li>ë°±ê·¸ë¼ìš´ë“œ ì¬ìƒ ê´€ë¦¬</li>
                            <li>ì™¸ë¶€ ì•± ì—°ê²° í—ˆìš©</li>
                            <li>ìƒëª…ì£¼ê¸° ìë™ ê´€ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¶</span>
                        Player
                    </h3>
                    <div class="card-description">
                        <p><strong>ì‹¤ì œ ë¯¸ë””ì–´ í”Œë ˆì´ì–´</strong></p>
                        <ul>
                            <li>ì˜¤ë””ì˜¤/ë¹„ë””ì˜¤ ì¬ìƒ</li>
                            <li>ë””ì½”ë”© ë° ë²„í¼ë§</li>
                            <li>MediaPlayer (ê¸°ë³¸)</li>
                            <li>ExoPlayer (ê¶Œì¥, Media3)</li>
                            <li>Player ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“¢</span>
                        MediaStyle Notification
                    </h3>
                    <div class="card-description">
                        <p><strong>ë¯¸ë””ì–´ ì•Œë¦¼</strong></p>
                        <ul>
                            <li>NotificationCompat.MediaStyle</li>
                            <li>MediaSession ì—°ë™</li>
                            <li>ì¬ìƒ ì»¨íŠ¸ë¡¤ í‘œì‹œ</li>
                            <li>ì•¨ë²” ì•„íŠ¸ í‘œì‹œ</li>
                            <li>Auto/Wear ìë™ ë¸Œë¦¬ì§•</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Playback Control Flow -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">4</span>
                ì¬ìƒ ì œì–´ íë¦„
            </h2>
            <p class="section-description">
                ì‚¬ìš©ì ëª…ë ¹ì´ MediaSessionì„ í†µí•´ Playerë¡œ ì „ë‹¬ë˜ëŠ” ì „ì²´ íë¦„ì…ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant User as ğŸ‘¤ User
                    participant Notif as ğŸ“¢ Notification
                    participant Controller as ğŸ® MediaController
                    participant Session as ğŸµ MediaSession
                    participant Player as ğŸ¶ Player

                    User->>Notif: Click ì¬ìƒ ë²„íŠ¼
                    Notif->>Controller: play() ëª…ë ¹
                    Controller->>Session: onPlay() callback
                    Session->>Player: player.play()
                    Player->>Player: ì¬ìƒ ì‹œì‘

                    Player->>Session: ìƒíƒœ ë³€ê²½ (PLAYING)
                    Session->>Controller: onPlaybackStateChanged()
                    Controller->>Notif: UI ì—…ë°ì´íŠ¸ (ì¬ìƒ ì¤‘)
                    Notif->>User: ì¬ìƒ ì•„ì´ì½˜ â†’ ì¼ì‹œì •ì§€ ì•„ì´ì½˜

                    Note over Session,Player: ë©”íƒ€ë°ì´í„° ì „ì†¡
                    Player->>Session: íŠ¸ë™ ì •ë³´
                    Session->>Controller: onMetadataChanged()
                    Controller->>Notif: ì•¨ë²”ì•„íŠ¸, ì œëª©, ì•„í‹°ìŠ¤íŠ¸ í‘œì‹œ
                </div>
            </div>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>í•µì‹¬ í”„ë¡œì„¸ìŠ¤:</strong>
                <ol style="margin-top: 10px; padding-left: 20px;">
                    <li>ì‚¬ìš©ìê°€ ì•Œë¦¼, Auto, Wear ë“±ì—ì„œ ì¬ìƒ ë²„íŠ¼ í´ë¦­</li>
                    <li>í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ MediaSessionì— play() ëª…ë ¹ ì „ì†¡</li>
                    <li>MediaSessionì˜ Callbackì—ì„œ onPlay() í˜¸ì¶œ</li>
                    <li>Playerì—ê²Œ ì‹¤ì œ ì¬ìƒ ëª…ë ¹ ì „ë‹¬</li>
                    <li>Playerê°€ ì¬ìƒ ì‹œì‘ í›„ ìƒíƒœ ë³€ê²½</li>
                    <li>MediaSessionì´ ëª¨ë“  ì—°ê²°ëœ ì»¨íŠ¸ë¡¤ëŸ¬ì— ìƒíƒœ ì—…ë°ì´íŠ¸</li>
                    <li>UI ìë™ ê°±ì‹  (ì•Œë¦¼, Auto, Wear ë™ì‹œ ì—…ë°ì´íŠ¸)</li>
                </ol>
            </div>
        </section>

        <!-- Section 5: Integration -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">5</span>
                Auto & Wear í†µí•©
            </h2>
            <p class="section-description">
                MediaSessionì„ ì‚¬ìš©í•˜ë©´ Android Autoì™€ Wear OS í†µí•©ì´ ìë™ìœ¼ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    graph TB
                    APP["ğŸ“± Media App<br />(Phone)"]
                    SESSION["ğŸµ MediaSession"]
                    NOTIF["ğŸ“¢ MediaStyle<br />Notification"]

                    AUTO_SYS["ğŸš— Android Auto<br />System"]
                    WEAR_SYS["âŒš Wear OS<br />System"]

                    AUTO_UI["Car Display<br />Media Controls"]
                    WEAR_UI["Watch Display<br />Media Controls"]

                    APP --> SESSION
                    SESSION --> NOTIF
                    NOTIF -.->|Auto Bridge| AUTO_SYS
                    NOTIF -.->|Auto Bridge| WEAR_SYS

                    AUTO_SYS --> AUTO_UI
                    WEAR_SYS --> WEAR_UI

                    AUTO_UI -->|Commands| SESSION
                    WEAR_UI -->|Commands| SESSION

                </div>
            </div>

            <div class="content-grid" style="margin-top: 30px;">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš—</span>
                        Android Auto í†µí•©
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>ìë™ ë¸Œë¦¬ì§•</strong>: MediaStyle ì•Œë¦¼ ìë™ ì „ì†¡</li>
                            <li><strong>MediaBrowserService</strong>: ì½˜í…ì¸  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë…¸ì¶œ</li>
                            <li><strong>ì°¨ëŸ‰ ë””ìŠ¤í”Œë ˆì´</strong>: ë„¤ì´í‹°ë¸Œ ë¯¸ë””ì–´ UI</li>
                            <li><strong>ìŒì„± ëª…ë ¹</strong>: Google Assistant í†µí•©</li>
                            <li>ë³„ë„ Auto ì „ìš© ì½”ë“œ ë¶ˆí•„ìš”</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âŒš</span>
                        Wear OS í†µí•©
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li><strong>ìë™ ë¸Œë¦¬ì§•</strong>: ì•Œë¦¼ì´ Watchë¡œ ì „ì†¡</li>
                            <li><strong>Ongoing Activity</strong>: ì¬ìƒ ì¤‘ Watch Face í‘œì‹œ</li>
                            <li><strong>ë¯¸ë””ì–´ ì»¨íŠ¸ë¡¤</strong>: ì•¨ë²” ì•„íŠ¸, ì¬ìƒ ë²„íŠ¼</li>
                            <li><strong>Media3 ìë™ ì§€ì›</strong>: ì¶”ê°€ êµ¬í˜„ ë¶ˆí•„ìš”</li>
                            <li>í˜ì–´ë§ëœ ê¸°ê¸° ìë™ ë™ê¸°í™”</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ’¡</span>
                        êµ¬í˜„ íŒ
                    </h3>
                    <div class="card-description">
                        <ul>
                            <li>MediaSession ë°˜ë“œì‹œ ìƒì„±</li>
                            <li>MediaStyleë¡œ Notification ì„¤ì •</li>
                            <li>setMediaSession(token) í˜¸ì¶œ</li>
                            <li>MediaBrowserService êµ¬í˜„ (ì½˜í…ì¸  íƒìƒ‰ìš©)</li>
                            <li>ë©”íƒ€ë°ì´í„° ë° ìƒíƒœ ì •í™•íˆ ì—…ë°ì´íŠ¸</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6: Implementation -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">6</span>
                êµ¬í˜„ ì˜ˆì‹œ
            </h2>
            <p class="section-description">
                MediaSessionì„ ì‚¬ìš©í•œ ê¸°ë³¸ ë¯¸ë””ì–´ ì•± êµ¬í˜„ êµ¬ì¡°ì…ë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">1ï¸âƒ£</span>
                        MediaSession ìƒì„±
                    </h3>
                    <div class="card-description">
                        <p><strong>Serviceì—ì„œ ìƒì„±</strong></p>
                        <ul>
                            <li><code>MediaSession(context, TAG)</code></li>
                            <li>Callback ì„¤ì •</li>
                            <li>Player ì—°ê²°</li>
                            <li>SessionToken íšë“</li>
                            <li>Active ìƒíƒœ ì„¤ì •</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">2ï¸âƒ£</span>
                        Callback êµ¬í˜„
                    </h3>
                    <div class="card-description">
                        <p><strong>MediaSession.Callback</strong></p>
                        <ul>
                            <li><code>onPlay()</code>: ì¬ìƒ ì‹œì‘</li>
                            <li><code>onPause()</code>: ì¼ì‹œì •ì§€</li>
                            <li><code>onStop()</code>: ì •ì§€</li>
                            <li><code>onSkipToNext()</code>: ë‹¤ìŒ íŠ¸ë™</li>
                            <li><code>onSeekTo()</code>: íƒìƒ‰</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">3ï¸âƒ£</span>
                        Notification ì„¤ì •
                    </h3>
                    <div class="card-description">
                        <p><strong>MediaStyle Notification</strong></p>
                        <ul>
                            <li><code>NotificationCompat.MediaStyle()</code></li>
                            <li><code>setMediaSession(token)</code></li>
                            <li>Action ì¶”ê°€ (play, pause, skip)</li>
                            <li>ì•¨ë²” ì•„íŠ¸ ì„¤ì •</li>
                            <li>Ongoing notification</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">4ï¸âƒ£</span>
                        UI ì—°ê²°
                    </h3>
                    <div class="card-description">
                        <p><strong>Activityì—ì„œ MediaController</strong></p>
                        <ul>
                            <li>MediaBrowserë¡œ Service ì—°ê²°</li>
                            <li>SessionTokenìœ¼ë¡œ Controller ìƒì„±</li>
                            <li>Transport controls í˜¸ì¶œ</li>
                            <li>Callbackìœ¼ë¡œ UI ì—…ë°ì´íŠ¸</li>
                            <li>ì—°ê²° í•´ì œ ê´€ë¦¬</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">5ï¸âƒ£</span>
                        ìƒíƒœ ì—…ë°ì´íŠ¸
                    </h3>
                    <div class="card-description">
                        <p><strong>PlaybackState ë° Metadata</strong></p>
                        <ul>
                            <li><code>setPlaybackState()</code></li>
                            <li>STATE_PLAYING, STATE_PAUSED ë“±</li>
                            <li><code>setMetadata()</code></li>
                            <li>ì œëª©, ì•„í‹°ìŠ¤íŠ¸, ì•¨ë²” ì•„íŠ¸</li>
                            <li>Duration, Position ì •ë³´</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">6ï¸âƒ£</span>
                        ìƒëª…ì£¼ê¸° ê´€ë¦¬
                    </h3>
                    <div class="card-description">
                        <p><strong>Service Lifecycle</strong></p>
                        <ul>
                            <li>onCreate(): MediaSession ìƒì„±</li>
                            <li>onStartCommand(): ì¬ìƒ ì‹œì‘</li>
                            <li>startForeground(): Notification</li>
                            <li>onDestroy(): ì •ë¦¬ ë° release()</li>
                            <li>MediaBrowser ì—°ê²° ê´€ë¦¬</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 7: Code Examples -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">7</span>
                ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ
            </h2>
            <p class="section-description">
                MediaSessionì„ ì‚¬ìš©í•œ ì‹¤ì œ êµ¬í˜„ ì½”ë“œë¥¼ Legacyì™€ Media3 ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ì œê³µí•©ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-bottom: 20px;">
                ğŸ“± Legacy: MediaSessionCompat + MediaBrowserServiceCompat
            </h3>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                1. MediaBrowserServiceCompat êµ¬í˜„
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// MusicService.kt (Legacy)
class MusicService : MediaBrowserServiceCompat() {
    private var mediaSession: MediaSessionCompat? = null
    private lateinit var stateBuilder: PlaybackStateCompat.Builder
    private lateinit var player: MediaPlayer

    override fun onCreate() {
        super.onCreate()

        // MediaSession ìƒì„±
        mediaSession = MediaSessionCompat(baseContext, "MusicService").apply {
            // Callback ì„¤ì •
            setCallback(MediaSessionCallback())

            // Flags ì„¤ì •
            setFlags(
                MediaSessionCompat.FLAG_HANDLES_MEDIA_BUTTONS or
                MediaSessionCompat.FLAG_HANDLES_TRANSPORT_CONTROLS
            )

            // PlaybackState ì´ˆê¸°í™”
            stateBuilder = PlaybackStateCompat.Builder()
                .setActions(
                    PlaybackStateCompat.ACTION_PLAY or
                    PlaybackStateCompat.ACTION_PAUSE or
                    PlaybackStateCompat.ACTION_SKIP_TO_NEXT or
                    PlaybackStateCompat.ACTION_SKIP_TO_PREVIOUS
                )
            setPlaybackState(stateBuilder.build())

            // Session í™œì„±í™”
            isActive = true
        }

        // SessionToken ì„¤ì •
        sessionToken = mediaSession?.sessionToken

        // Player ì´ˆê¸°í™”
        player = MediaPlayer()
    }

    override fun onGetRoot(
        clientPackageName: String,
        clientUid: Int,
        rootHints: Bundle?
    ): BrowserRoot? {
        // Android Auto/Wear OS ì ‘ê·¼ í—ˆìš©
        return BrowserRoot("root", null)
    }

    override fun onLoadChildren(
        parentId: String,
        result: Result<MutableList<MediaBrowserCompat.MediaItem>>
    ) {
        val mediaItems = mutableListOf<MediaBrowserCompat.MediaItem>()

        when (parentId) {
            "root" -> {
                // ìµœìƒìœ„ ë©”ë‰´
                mediaItems.add(
                    MediaBrowserCompat.MediaItem(
                        MediaDescriptionCompat.Builder()
                            .setMediaId("albums")
                            .setTitle("Albums")
                            .setSubtitle("Browse by album")
                            .build(),
                        MediaBrowserCompat.MediaItem.FLAG_BROWSABLE
                    )
                )
                mediaItems.add(
                    MediaBrowserCompat.MediaItem(
                        MediaDescriptionCompat.Builder()
                            .setMediaId("artists")
                            .setTitle("Artists")
                            .build(),
                        MediaBrowserCompat.MediaItem.FLAG_BROWSABLE
                    )
                )
            }
            "albums" -> {
                // ì•¨ë²” ëª©ë¡
                mediaItems.add(
                    MediaBrowserCompat.MediaItem(
                        MediaDescriptionCompat.Builder()
                            .setMediaId("album_1")
                            .setTitle("Album Title")
                            .setSubtitle("Artist Name")
                            .setIconUri(Uri.parse("android.resource://..."))
                            .build(),
                        MediaBrowserCompat.MediaItem.FLAG_PLAYABLE
                    )
                )
            }
        }

        result.sendResult(mediaItems)
    }

    inner class MediaSessionCallback : MediaSessionCompat.Callback() {
        override fun onPlay() {
            player.start()
            updatePlaybackState(PlaybackStateCompat.STATE_PLAYING)
            showNotification()
        }

        override fun onPause() {
            player.pause()
            updatePlaybackState(PlaybackStateCompat.STATE_PAUSED)
        }

        override fun onStop() {
            player.stop()
            updatePlaybackState(PlaybackStateCompat.STATE_STOPPED)
            stopForeground(true)
        }

        override fun onSkipToNext() {
            // ë‹¤ìŒ íŠ¸ë™ ì¬ìƒ
            loadNextTrack()
            onPlay()
        }

        override fun onSeekTo(pos: Long) {
            player.seekTo(pos.toInt())
            updatePlaybackState(PlaybackStateCompat.STATE_PLAYING)
        }
    }

    private fun updatePlaybackState(state: Int) {
        val position = if (player.isPlaying) player.currentPosition.toLong() else 0
        mediaSession?.setPlaybackState(
            stateBuilder.setState(state, position, 1.0f).build()
        )
    }

    private fun showNotification() {
        val notification = NotificationCompat.Builder(this, CHANNEL_ID)
            .setContentTitle("Song Title")
            .setContentText("Artist Name")
            .setSmallIcon(R.drawable.ic_music)
            .setLargeIcon(albumArtBitmap)
            .setStyle(
                androidx.media.app.NotificationCompat.MediaStyle()
                    .setMediaSession(mediaSession?.sessionToken)
                    .setShowActionsInCompactView(0, 1, 2)
            )
            .addAction(R.drawable.ic_skip_previous, "Previous", previousPendingIntent)
            .addAction(R.drawable.ic_pause, "Pause", pausePendingIntent)
            .addAction(R.drawable.ic_skip_next, "Next", nextPendingIntent)
            .build()

        startForeground(NOTIFICATION_ID, notification)
    }

    override fun onDestroy() {
        super.onDestroy()
        mediaSession?.release()
        player.release()
    }
}</code></pre>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                2. Activityì—ì„œ MediaController ì—°ê²°
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// MainActivity.kt (Legacy)
class MainActivity : AppCompatActivity() {
    private lateinit var mediaBrowser: MediaBrowserCompat
    private var mediaController: MediaControllerCompat? = null

    private val connectionCallbacks = object : MediaBrowserCompat.ConnectionCallback() {
        override fun onConnected() {
            mediaController = MediaControllerCompat(
                this@MainActivity,
                mediaBrowser.sessionToken
            ).apply {
                // Controllerë¥¼ Activityì— ì—°ê²°
                MediaControllerCompat.setMediaController(this@MainActivity, this)

                // Callback ë“±ë¡
                registerCallback(controllerCallback)

                // í˜„ì¬ ìƒíƒœ ê°€ì ¸ì˜¤ê¸°
                playbackState?.let { controllerCallback.onPlaybackStateChanged(it) }
                metadata?.let { controllerCallback.onMetadataChanged(it) }
            }
        }

        override fun onConnectionSuspended() {
            mediaController = null
        }

        override fun onConnectionFailed() {
            // ì—°ê²° ì‹¤íŒ¨ ì²˜ë¦¬
        }
    }

    private val controllerCallback = object : MediaControllerCompat.Callback() {
        override fun onPlaybackStateChanged(state: PlaybackStateCompat?) {
            state?.let {
                when (it.state) {
                    PlaybackStateCompat.STATE_PLAYING -> {
                        playPauseButton.setImageResource(R.drawable.ic_pause)
                    }
                    PlaybackStateCompat.STATE_PAUSED -> {
                        playPauseButton.setImageResource(R.drawable.ic_play)
                    }
                }
            }
        }

        override fun onMetadataChanged(metadata: MediaMetadataCompat?) {
            metadata?.let {
                titleTextView.text = it.getString(MediaMetadataCompat.METADATA_KEY_TITLE)
                artistTextView.text = it.getString(MediaMetadataCompat.METADATA_KEY_ARTIST)
                albumArtImageView.setImageBitmap(
                    it.getBitmap(MediaMetadataCompat.METADATA_KEY_ALBUM_ART)
                )
            }
        }
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        // MediaBrowser ìƒì„±
        mediaBrowser = MediaBrowserCompat(
            this,
            ComponentName(this, MusicService::class.java),
            connectionCallbacks,
            null
        )

        // UI ë²„íŠ¼ ë¦¬ìŠ¤ë„ˆ
        playPauseButton.setOnClickListener {
            val controller = MediaControllerCompat.getMediaController(this)
            val state = controller.playbackState?.state

            if (state == PlaybackStateCompat.STATE_PLAYING) {
                controller.transportControls.pause()
            } else {
                controller.transportControls.play()
            }
        }
    }

    override fun onStart() {
        super.onStart()
        mediaBrowser.connect()
    }

    override fun onStop() {
        super.onStop()
        mediaController?.unregisterCallback(controllerCallback)
        mediaBrowser.disconnect()
    }
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸš€ Media3: MediaSessionService + MediaSession
            </h3>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                1. MediaSessionService êµ¬í˜„
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// MusicService.kt (Media3)
class MusicService : MediaSessionService() {
    private var mediaSession: MediaSession? = null

    override fun onCreate() {
        super.onCreate()

        // ExoPlayer ìƒì„±
        val player = ExoPlayer.Builder(this).build()

        // MediaSession ìƒì„±
        mediaSession = MediaSession.Builder(this, player)
            .setCallback(MediaSessionCallback())
            .build()
    }

    override fun onGetSession(controllerInfo: MediaSession.ControllerInfo): MediaSession? {
        return mediaSession
    }

    private inner class MediaSessionCallback : MediaSession.Callback {
        override fun onConnect(
            session: MediaSession,
            controller: MediaSession.ControllerInfo
        ): MediaSession.ConnectionResult {
            val connectionResult = super.onConnect(session, controller)

            // Session Commands ì„¤ì •
            val sessionCommands = connectionResult.availableSessionCommands.buildUpon()
                .add(SessionCommand("CUSTOM_COMMAND", Bundle()))
                .build()

            return MediaSession.ConnectionResult.accept(
                sessionCommands,
                connectionResult.availablePlayerCommands
            )
        }

        override fun onAddMediaItems(
            mediaSession: MediaSession,
            controller: MediaSession.ControllerInfo,
            mediaItems: List<MediaItem>
        ): ListenableFuture<List<MediaItem>> {
            // ë¯¸ë””ì–´ ì•„ì´í…œ ì²˜ë¦¬
            val updatedMediaItems = mediaItems.map { mediaItem ->
                mediaItem.buildUpon()
                    .setUri(getMediaUri(mediaItem.mediaId))
                    .build()
            }
            return Futures.immediateFuture(updatedMediaItems)
        }
    }

    override fun onDestroy() {
        mediaSession?.run {
            player.release()
            release()
            mediaSession = null
        }
        super.onDestroy()
    }
}</code></pre>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                2. Activityì—ì„œ MediaController ì—°ê²°
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// MainActivity.kt (Media3)
class MainActivity : AppCompatActivity() {
    private var controller: MediaController? = null
    private lateinit var controllerFuture: ListenableFuture<MediaController>

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        // UI ë²„íŠ¼ ë¦¬ìŠ¤ë„ˆ
        playPauseButton.setOnClickListener {
            controller?.let {
                if (it.isPlaying) {
                    it.pause()
                } else {
                    it.play()
                }
            }
        }
    }

    override fun onStart() {
        super.onStart()
        initializeController()
    }

    private fun initializeController() {
        controllerFuture = MediaController.Builder(
            this,
            SessionToken(this, ComponentName(this, MusicService::class.java))
        ).buildAsync()

        controllerFuture.addListener({
            controller = controllerFuture.get().apply {
                // Listener ë“±ë¡
                addListener(object : Player.Listener {
                    override fun onIsPlayingChanged(isPlaying: Boolean) {
                        if (isPlaying) {
                            playPauseButton.setImageResource(R.drawable.ic_pause)
                        } else {
                            playPauseButton.setImageResource(R.drawable.ic_play)
                        }
                    }

                    override fun onMediaMetadataChanged(mediaMetadata: MediaMetadata) {
                        titleTextView.text = mediaMetadata.title
                        artistTextView.text = mediaMetadata.artist
                        // ì•¨ë²” ì•„íŠ¸ëŠ” ìë™ìœ¼ë¡œ ì²˜ë¦¬ë¨
                    }
                })
            }
        }, MoreExecutors.directExecutor())
    }

    override fun onStop() {
        super.onStop()
        controller?.let {
            MediaController.releaseFuture(controllerFuture)
            controller = null
        }
    }
}</code></pre>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>ğŸ’¡ ì½”ë“œ ì˜ˆì‹œ í•µì‹¬ ì°¨ì´ì :</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>Legacy</strong>: MediaBrowserServiceCompat, MediaSessionCompat.Callback, ìˆ˜ë™ PlaybackState ê´€ë¦¬</li>
                    <li><strong>Media3</strong>: MediaSessionService, ExoPlayer í†µí•©, ìë™ ìƒíƒœ ë™ê¸°í™”, Player.Listener</li>
                    <li><strong>ì½”ë“œ ê°„ê²°ì„±</strong>: Media3ê°€ ì•½ 40% ë” ì§§ê³  ê°„ê²°í•¨</li>
                    <li><strong>ìœ ì§€ë³´ìˆ˜</strong>: Media3ëŠ” ExoPlayerì™€ í†µí•©ë˜ì–´ ë²„í¼ë§, ì—ëŸ¬ ì²˜ë¦¬ ìë™í™”</li>
                </ul>
            </div>
        </section>

        <!-- Section 8: Media3 vs Legacy Comparison -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">8</span>
                Media3 vs Legacy ë¹„êµ
            </h2>
            <p class="section-description">
                Media3ì™€ Legacy MediaSession APIì˜ ì°¨ì´ì ì„ ìƒì„¸íˆ ë¹„êµí•©ë‹ˆë‹¤.
            </p>

            <div class="highlight-box">
                <table style="width: 100%; margin-top: 15px; border-collapse: collapse;">
                    <thead>
                        <tr style="background: var(--bg-secondary); border-bottom: 2px solid var(--accent-primary);">
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">í•­ëª©</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">Legacy (MediaSessionCompat)</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">Media3 (androidx.media3)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>íŒ¨í‚¤ì§€</strong></td>
                            <td style="padding: 10px;">android.support.v4.media<br />androidx.media</td>
                            <td style="padding: 10px;">androidx.media3.session<br />androidx.media3.exoplayer</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ì„œë¹„ìŠ¤ í´ë˜ìŠ¤</strong></td>
                            <td style="padding: 10px;">MediaBrowserServiceCompat</td>
                            <td style="padding: 10px;">MediaSessionService (ê°„ì†Œí™”ë¨)</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ì„¸ì…˜ í´ë˜ìŠ¤</strong></td>
                            <td style="padding: 10px;">MediaSessionCompat</td>
                            <td style="padding: 10px;">MediaSession</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ì½œë°± ë°©ì‹</strong></td>
                            <td style="padding: 10px;">MediaSessionCompat.Callback<br />ìˆ˜ë™ìœ¼ë¡œ ìƒíƒœ ì—…ë°ì´íŠ¸</td>
                            <td style="padding: 10px;">MediaSession.Callback<br />Playerê°€ ìë™ ë™ê¸°í™”</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>í”Œë ˆì´ì–´ í†µí•©</strong></td>
                            <td style="padding: 10px;">MediaPlayer ë˜ëŠ” ExoPlayer ìˆ˜ë™ ì—°ë™</td>
                            <td style="padding: 10px;">ExoPlayer ë„¤ì´í‹°ë¸Œ í†µí•©</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ìƒíƒœ ê´€ë¦¬</strong></td>
                            <td style="padding: 10px;">PlaybackStateCompat.Builder<br />ìˆ˜ë™ setState() í˜¸ì¶œ</td>
                            <td style="padding: 10px;">Player.Listener<br />ìë™ ìƒíƒœ ì „íŒŒ</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ë©”íƒ€ë°ì´í„° ì„¤ì •</strong></td>
                            <td style="padding: 10px;">MediaMetadataCompat.Builder<br />ìˆ˜ë™ setMetadata()</td>
                            <td style="padding: 10px;">MediaMetadata<br />ìë™ ë™ê¸°í™”</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Queue ê´€ë¦¬</strong></td>
                            <td style="padding: 10px;">ìˆ˜ë™ setQueue()</td>
                            <td style="padding: 10px;">Player.setMediaItems() ìë™ ì²˜ë¦¬</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ì»¨íŠ¸ë¡¤ëŸ¬ ì—°ê²°</strong></td>
                            <td style="padding: 10px;">MediaBrowserCompat<br />ConnectionCallback</td>
                            <td style="padding: 10px;">ListenableFuture&lt;MediaController&gt;<br />ë¹„ë™ê¸° ì—°ê²°</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Notification</strong></td>
                            <td style="padding: 10px;">NotificationCompat.MediaStyle<br />ìˆ˜ë™ ë¹Œë“œ</td>
                            <td style="padding: 10px;">MediaNotification<br />ìë™ ìƒì„±</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ìœ ì§€ë³´ìˆ˜ ìƒíƒœ</strong></td>
                            <td style="padding: 10px;">âš ï¸ ìœ ì§€ë³´ìˆ˜ ëª¨ë“œ (ë²„ê·¸ ìˆ˜ì •ë§Œ)</td>
                            <td style="padding: 10px;">âœ… í™œë°œí•œ ê°œë°œ ë° ì—…ë°ì´íŠ¸</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ì½”ë“œ ë³µì¡ë„</strong></td>
                            <td style="padding: 10px;">ë†’ìŒ (Boilerplate ë§ìŒ)</td>
                            <td style="padding: 10px;">ë‚®ìŒ (ê°„ê²°í•˜ê³  ì„ ì–¸ì )</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px;"><strong>ê¶Œì¥ ì‚¬í•­</strong></td>
                            <td style="padding: 10px;">âš ï¸ ìƒˆ í”„ë¡œì íŠ¸ ë¹„ê¶Œì¥</td>
                            <td style="padding: 10px;">âœ… ëª¨ë“  ìƒˆ í”„ë¡œì íŠ¸ ê¶Œì¥</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ”„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">1ï¸âƒ£</span>
                        Dependency ë³€ê²½
                    </h3>
                    <div class="card-description">
                        <pre style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.8rem; margin-top: 10px;"><code>// build.gradle.kts
// Legacy ì œê±°
// implementation("androidx.media:media:1.x.x")

// Media3 ì¶”ê°€
implementation("androidx.media3:media3-session:1.2.0")
implementation("androidx.media3:media3-exoplayer:1.2.0")</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">2ï¸âƒ£</span>
                        Service ë§ˆì´ê·¸ë ˆì´ì…˜
                    </h3>
                    <div class="card-description">
                        <ul style="margin-top: 10px;">
                            <li><code>MediaBrowserServiceCompat</code> â†’ <code>MediaSessionService</code></li>
                            <li><code>onGetRoot()</code>, <code>onLoadChildren()</code> ì œê±°</li>
                            <li><code>onGetSession()</code> êµ¬í˜„</li>
                            <li>ExoPlayer ìƒì„± ë° ì—°ê²°</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">3ï¸âƒ£</span>
                        Callback ë‹¨ìˆœí™”
                    </h3>
                    <div class="card-description">
                        <ul style="margin-top: 10px;">
                            <li><code>onPlay()</code>, <code>onPause()</code> ì œê±° ê°€ëŠ¥</li>
                            <li>Playerê°€ ìë™ìœ¼ë¡œ ëª…ë ¹ ì²˜ë¦¬</li>
                            <li>ì»¤ìŠ¤í…€ ë¡œì§ë§Œ override</li>
                            <li><code>PlaybackStateCompat</code> ìˆ˜ë™ ì—…ë°ì´íŠ¸ ì œê±°</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">4ï¸âƒ£</span>
                        Controller ë³€ê²½
                    </h3>
                    <div class="card-description">
                        <ul style="margin-top: 10px;">
                            <li><code>MediaBrowserCompat</code> â†’ <code>ListenableFuture&lt;MediaController&gt;</code></li>
                            <li><code>transportControls.play()</code> â†’ <code>controller.play()</code></li>
                            <li><code>MediaControllerCompat.Callback</code> â†’ <code>Player.Listener</code></li>
                            <li>ë¹„ë™ê¸° ì—°ê²° íŒ¨í„´ ì ìš©</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="warning-box" style="margin-top: 30px;">
                <strong>ğŸš€ ë§ˆì´ê·¸ë ˆì´ì…˜ ê¶Œì¥ ì‹œê¸°:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>ìƒˆ í”„ë¡œì íŠ¸</strong>: ë°˜ë“œì‹œ Media3 ì‚¬ìš©</li>
                    <li><strong>ê¸°ì¡´ í”„ë¡œì íŠ¸</strong>: ì¤‘ëŒ€í•œ ë¦¬íŒ©í† ë§ ì‹œ ë§ˆì´ê·¸ë ˆì´ì…˜ ê³ ë ¤</li>
                    <li><strong>ExoPlayer ì‚¬ìš© ì¤‘</strong>: Media3ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œ í†µí•© ì´ì  í¼</li>
                    <li><strong>MediaPlayer ì‚¬ìš© ì¤‘</strong>: Legacyë¡œ ìœ ì§€ ê°€ëŠ¥í•˜ë‚˜ Media3 + ExoPlayer ê¶Œì¥</li>
                    <li>Googleì€ 2024ë…„ë¶€í„° Media3ë¥¼ ê³µì‹ ê¶Œì¥ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì§€ì •</li>
                </ul>
            </div>
        </section>

        <!-- Section 9: Audio Focus & Session Management -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">9</span>
                ì˜¤ë””ì˜¤ í¬ì»¤ìŠ¤ & ì„¸ì…˜ ê´€ë¦¬
            </h2>
            <p class="section-description">
                AudioFocusë¥¼ í†µí•œ ë‹¤ì¤‘ ì•± ê°„ ì˜¤ë””ì˜¤ ì¬ìƒ ì¡°ìœ¨ ë° ì„¸ì…˜ ìš°ì„ ìˆœìœ„ ê´€ë¦¬ ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
            </p>

            <div class="mermaid-container">
                <div class="mermaid">
                    sequenceDiagram
                    participant App as Music App
                    participant AM as AudioManager
                    participant Phone as Phone Call
                    participant Nav as Navigation

                    App->>AM: requestAudioFocus()<br />AUDIOFOCUS_GAIN
                    AM-->>App: AUDIOFOCUS_REQUEST_GRANTED
                    App->>App: player.play()

                    Note over Phone: ì „í™” ìˆ˜ì‹ 
                    Phone->>AM: requestAudioFocus()<br />AUDIOFOCUS_GAIN_TRANSIENT
                    AM->>App: onAudioFocusChange()<br />AUDIOFOCUS_LOSS_TRANSIENT
                    App->>App: player.pause()
                    AM-->>Phone: AUDIOFOCUS_REQUEST_GRANTED

                    Note over Phone: í†µí™” ì¢…ë£Œ
                    Phone->>AM: abandonAudioFocus()
                    AM->>App: onAudioFocusChange()<br />AUDIOFOCUS_GAIN
                    App->>App: player.play() (ì¬ê°œ)

                    Note over Nav: ë„¤ë¹„ê²Œì´ì…˜ ì•ˆë‚´
                    Nav->>AM: requestAudioFocus()<br />AUDIOFOCUS_GAIN_TRANSIENT_MAY_DUCK
                    AM->>App: onAudioFocusChange()<br />AUDIOFOCUS_LOSS_TRANSIENT_CAN_DUCK
                    App->>App: player.setVolume(0.2f) (Ducking)
                    AM-->>Nav: AUDIOFOCUS_REQUEST_GRANTED

                    Nav->>AM: abandonAudioFocus()
                    AM->>App: onAudioFocusChange()<br />AUDIOFOCUS_GAIN
                    App->>App: player.setVolume(1.0f) (ë³¼ë¥¨ ë³µì›)
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ§ AudioFocus ìš”ì²­ ë° ì²˜ë¦¬
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// AudioFocus ê´€ë¦¬
class MusicService : MediaBrowserServiceCompat() {
    private lateinit var audioManager: AudioManager
    private lateinit var audioFocusRequest: AudioFocusRequest

    private val afChangeListener = AudioManager.OnAudioFocusChangeListener { focusChange ->
        when (focusChange) {
            AudioManager.AUDIOFOCUS_GAIN -> {
                // Focus íšë“: ì¬ìƒ ì¬ê°œ ë° ë³¼ë¥¨ ë³µì›
                player.volume = 1.0f
                if (shouldResumeOnFocusGain) {
                    player.play()
                }
            }
            AudioManager.AUDIOFOCUS_LOSS -> {
                // Focus ì˜êµ¬ ì†ì‹¤: ì¬ìƒ ì •ì§€
                player.pause()
                shouldResumeOnFocusGain = false
            }
            AudioManager.AUDIOFOCUS_LOSS_TRANSIENT -> {
                // Focus ì¼ì‹œ ì†ì‹¤ (ì „í™” ë“±): ì¼ì‹œì •ì§€, ë‚˜ì¤‘ì— ì¬ê°œ
                if (player.isPlaying) {
                    player.pause()
                    shouldResumeOnFocusGain = true
                }
            }
            AudioManager.AUDIOFOCUS_LOSS_TRANSIENT_CAN_DUCK -> {
                // Focus ì¼ì‹œ ì†ì‹¤ (Ducking ê°€ëŠ¥, ë„¤ë¹„ê²Œì´ì…˜ ë“±): ë³¼ë¥¨ ë‚®ì¶¤
                player.volume = 0.2f
            }
        }
    }

    override fun onCreate() {
        super.onCreate()
        audioManager = getSystemService(Context.AUDIO_SERVICE) as AudioManager

        // AudioAttributes ì„¤ì •
        val audioAttributes = AudioAttributes.Builder()
            .setUsage(AudioAttributes.USAGE_MEDIA)
            .setContentType(AudioAttributes.CONTENT_TYPE_MUSIC)
            .build()

        // AudioFocusRequest ìƒì„± (Android O+)
        audioFocusRequest = AudioFocusRequest.Builder(AudioManager.AUDIOFOCUS_GAIN)
            .setAudioAttributes(audioAttributes)
            .setOnAudioFocusChangeListener(afChangeListener)
            .setAcceptsDelayedFocusGain(true)  // ì§€ì—°ëœ Focus í—ˆìš©
            .build()
    }

    private fun requestAudioFocus(): Boolean {
        val result = audioManager.requestAudioFocus(audioFocusRequest)
        return result == AudioManager.AUDIOFOCUS_REQUEST_GRANTED
    }

    private fun abandonAudioFocus() {
        audioManager.abandonAudioFocusRequest(audioFocusRequest)
    }

    inner class MediaSessionCallback : MediaSessionCompat.Callback() {
        override fun onPlay() {
            if (requestAudioFocus()) {
                // MediaSession í™œì„±í™”
                mediaSession?.isActive = true
                // ì¬ìƒ ì‹œì‘
                player.play()
                // Notification í‘œì‹œ
                showNotification()
            }
        }

        override fun onStop() {
            // AudioFocus í•´ì œ
            abandonAudioFocus()
            // MediaSession ë¹„í™œì„±í™”
            mediaSession?.isActive = false
            // ì¬ìƒ ì •ì§€
            player.stop()
            // Notification ì œê±°
            stopForeground(true)
        }
    }

    override fun onDestroy() {
        super.onDestroy()
        abandonAudioFocus()
    }
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ“Š AudioFocus íƒ€ì… ë¹„êµ
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸµ</span>
                        AUDIOFOCUS_GAIN
                    </h3>
                    <div class="card-description">
                        <p><strong>ì˜êµ¬ì  Focus íšë“</strong></p>
                        <ul>
                            <li><strong>ì‚¬ìš© ì‚¬ë¡€</strong>: ìŒì•… ì¬ìƒ, íŒŸìºìŠ¤íŠ¸</li>
                            <li><strong>ë‹¤ë¥¸ ì•± ì˜í–¥</strong>: ì¬ìƒ ì¤‘ë‹¨ ë˜ëŠ” Ducking</li>
                            <li><strong>ì†ì‹¤ ì‹œ</strong>: ì¬ìƒ ì •ì§€</li>
                            <li><strong>ì¬íšë“ ì‹œ</strong>: ì¬ìƒ ì¬ê°œ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“</span>
                        AUDIOFOCUS_GAIN_TRANSIENT
                    </h3>
                    <div class="card-description">
                        <p><strong>ì¼ì‹œì  Focus (ì¤‘ë‹¨ ë¶ˆê°€)</strong></p>
                        <ul>
                            <li><strong>ì‚¬ìš© ì‚¬ë¡€</strong>: ì „í™” í†µí™”, ì•ŒëŒ</li>
                            <li><strong>ë‹¤ë¥¸ ì•± ì˜í–¥</strong>: ì¼ì‹œì •ì§€ ê°•ì œ</li>
                            <li><strong>ì†ì‹¤ ì‹œ</strong>: ì¼ì‹œì •ì§€</li>
                            <li><strong>ì¬íšë“ ì‹œ</strong>: ìë™ ì¬ê°œ</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ—ºï¸</span>
                        AUDIOFOCUS_GAIN_TRANSIENT_MAY_DUCK
                    </h3>
                    <div class="card-description">
                        <p><strong>ì¼ì‹œì  Focus (Ducking í—ˆìš©)</strong></p>
                        <ul>
                            <li><strong>ì‚¬ìš© ì‚¬ë¡€</strong>: ë„¤ë¹„ê²Œì´ì…˜ ì•ˆë‚´, ì•Œë¦¼ìŒ</li>
                            <li><strong>ë‹¤ë¥¸ ì•± ì˜í–¥</strong>: ë³¼ë¥¨ ë‚®ì¶¤ (20%)</li>
                            <li><strong>ì†ì‹¤ ì‹œ</strong>: Ducking (ê³„ì† ì¬ìƒ)</li>
                            <li><strong>ì¬íšë“ ì‹œ</strong>: ë³¼ë¥¨ ë³µì›</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”•</span>
                        AUDIOFOCUS_GAIN_TRANSIENT_EXCLUSIVE
                    </h3>
                    <div class="card-description">
                        <p><strong>ë…ì ì  ì¼ì‹œ Focus</strong></p>
                        <ul>
                            <li><strong>ì‚¬ìš© ì‚¬ë¡€</strong>: ìŒì„± ë…¹ìŒ, ìŒì„± ì¸ì‹</li>
                            <li><strong>ë‹¤ë¥¸ ì•± ì˜í–¥</strong>: ëª¨ë“  ì˜¤ë””ì˜¤ ì¤‘ë‹¨</li>
                            <li><strong>ì†ì‹¤ ì‹œ</strong>: ì¦‰ì‹œ ì •ì§€</li>
                            <li><strong>íŠ¹ì§•</strong>: ë°°íƒ€ì  ì˜¤ë””ì˜¤ ì‚¬ìš©</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="warning-box" style="margin-top: 30px;">
                <strong>âš ï¸ AudioFocus Best Practices:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>í•„ìˆ˜ ì‚¬í•­</strong>: ë¯¸ë””ì–´ ì¬ìƒ ì „ ë°˜ë“œì‹œ AudioFocus ìš”ì²­</li>
                    <li><strong>ì ì ˆí•œ íƒ€ì… ì„ íƒ</strong>: USAGE_MEDIA, CONTENT_TYPE_MUSIC ë“± ì •í™•íˆ ì„¤ì •</li>
                    <li><strong>LOSS vs LOSS_TRANSIENT êµ¬ë¶„</strong>: LOSSëŠ” ì¬ê°œ ì•ˆ í•¨, LOSS_TRANSIENTëŠ” ì¬ê°œ</li>
                    <li><strong>Ducking ì²˜ë¦¬</strong>: LOSS_TRANSIENT_CAN_DUCKì—ì„œëŠ” ì¼ì‹œì •ì§€ ëŒ€ì‹  ë³¼ë¥¨ ë‚®ì¶¤ (ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ)</li>
                    <li><strong>Focus í•´ì œ</strong>: ì¬ìƒ ì™„ë£Œ/ì •ì§€ ì‹œ ë°˜ë“œì‹œ abandonAudioFocus() í˜¸ì¶œ</li>
                    <li><strong>Media3 ìë™ ì²˜ë¦¬</strong>: Media3 + ExoPlayerëŠ” AudioFocusë¥¼ ìë™ìœ¼ë¡œ ê´€ë¦¬ (ìˆ˜ë™ êµ¬í˜„ ë¶ˆí•„ìš”)</li>
                </ul>
            </div>
        </section>

        <!-- Section 10: Media Buttons & Custom Commands -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">10</span>
                ë¯¸ë””ì–´ ë²„íŠ¼ & ì»¤ìŠ¤í…€ ëª…ë ¹
            </h2>
            <p class="section-description">
                í—¤ë“œí° ë²„íŠ¼, ë¸”ë£¨íˆ¬ìŠ¤ ì»¨íŠ¸ë¡¤ ì²˜ë¦¬ ë° ì»¤ìŠ¤í…€ ëª…ë ¹ ì¶”ê°€ ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-bottom: 20px;">
                ğŸ§ MediaButtonReceiver ì„¤ì •
            </h3>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                1. AndroidManifest.xml ì„¤ì •
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">&lt;!-- AndroidManifest.xml --&gt;
&lt;manifest&gt;
    &lt;application&gt;
        &lt;!-- MediaBrowserService ì„ ì–¸ --&gt;
        &lt;service
            android:name=".MusicService"
            android:exported="true"&gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.media.browse.MediaBrowserService" /&gt;
            &lt;/intent-filter&gt;
        &lt;/service&gt;

        &lt;!-- MediaButtonReceiver ì„ ì–¸ --&gt;
        &lt;receiver
            android:name="androidx.media.session.MediaButtonReceiver"
            android:exported="true"&gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MEDIA_BUTTON" /&gt;
            &lt;/intent-filter&gt;
        &lt;/receiver&gt;
    &lt;/application&gt;

    &lt;!-- í•„ìš”í•œ ê¶Œí•œ --&gt;
    &lt;uses-permission android:name="android.permission.FOREGROUND_SERVICE" /&gt;
    &lt;uses-permission android:name="android.permission.WAKE_LOCK" /&gt;
&lt;/manifest&gt;</code></pre>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                2. Serviceì—ì„œ MediaButton ì²˜ë¦¬
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// MusicService.kt
class MusicService : MediaBrowserServiceCompat() {

    override fun onCreate() {
        super.onCreate()

        val mediaSession = MediaSessionCompat(this, "MusicService").apply {
            // Flags ì„¤ì • (MediaButton ì²˜ë¦¬ í™œì„±í™”)
            setFlags(
                MediaSessionCompat.FLAG_HANDLES_MEDIA_BUTTONS or
                MediaSessionCompat.FLAG_HANDLES_TRANSPORT_CONTROLS
            )

            // Callback ì„¤ì •
            setCallback(mediaSessionCallback)

            // MediaButton Intent ì„¤ì •
            val mediaButtonIntent = Intent(Intent.ACTION_MEDIA_BUTTON, null, this@MusicService,
                MediaButtonReceiver::class.java)
            val pendingIntent = PendingIntent.getBroadcast(
                this@MusicService, 0, mediaButtonIntent,
                PendingIntent.FLAG_IMMUTABLE
            )
            setMediaButtonReceiver(pendingIntent)

            isActive = true
        }
    }

    override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int {
        // MediaButtonReceiverê°€ ì „ë‹¬í•œ Intent ì²˜ë¦¬
        MediaButtonReceiver.handleIntent(mediaSession, intent)
        return super.onStartCommand(intent, flags, startId)
    }

    private val mediaSessionCallback = object : MediaSessionCompat.Callback() {
        // í—¤ë“œí° ì¬ìƒ ë²„íŠ¼
        override fun onPlay() {
            player.play()
            updatePlaybackState(PlaybackStateCompat.STATE_PLAYING)
        }

        // í—¤ë“œí° ì¼ì‹œì •ì§€ ë²„íŠ¼
        override fun onPause() {
            player.pause()
            updatePlaybackState(PlaybackStateCompat.STATE_PAUSED)
        }

        // í—¤ë“œí° ë‹¤ìŒ íŠ¸ë™ ë²„íŠ¼
        override fun onSkipToNext() {
            playNextTrack()
        }

        // í—¤ë“œí° ì´ì „ íŠ¸ë™ ë²„íŠ¼
        override fun onSkipToPrevious() {
            playPreviousTrack()
        }

        // ë¯¸ë””ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ (ë”ë¸” í´ë¦­, íŠ¸ë¦¬í”Œ í´ë¦­ ë“±)
        override fun onMediaButtonEvent(mediaButtonEvent: Intent?): Boolean {
            val keyEvent = mediaButtonEvent?.getParcelableExtra<KeyEvent>(Intent.EXTRA_KEY_EVENT)

            if (keyEvent?.action == KeyEvent.ACTION_DOWN) {
                when (keyEvent.keyCode) {
                    KeyEvent.KEYCODE_MEDIA_PLAY -> onPlay()
                    KeyEvent.KEYCODE_MEDIA_PAUSE -> onPause()
                    KeyEvent.KEYCODE_MEDIA_NEXT -> onSkipToNext()
                    KeyEvent.KEYCODE_MEDIA_PREVIOUS -> onSkipToPrevious()
                    KeyEvent.KEYCODE_MEDIA_PLAY_PAUSE -> {
                        if (player.isPlaying) onPause() else onPlay()
                    }
                    KeyEvent.KEYCODE_HEADSETHOOK -> {
                        // ì‹±ê¸€/ë”ë¸”/íŠ¸ë¦¬í”Œ í´ë¦­ ì²˜ë¦¬
                        handleHeadsetHook()
                        return true
                    }
                }
            }
            return super.onMediaButtonEvent(mediaButtonEvent)
        }
    }

    private fun handleHeadsetHook() {
        val now = SystemClock.elapsedRealtime()

        if (now - lastClickTime < DOUBLE_CLICK_INTERVAL) {
            // ë”ë¸” í´ë¦­: ë‹¤ìŒ íŠ¸ë™
            clickCount++
            if (clickCount == 2) {
                onSkipToNext()
                clickCount = 0
            }
        } else {
            // ì‹±ê¸€ í´ë¦­: ì¬ìƒ/ì¼ì‹œì •ì§€
            clickCount = 1
            handler.postDelayed({
                if (clickCount == 1) {
                    if (player.isPlaying) onPause() else onPlay()
                }
                clickCount = 0
            }, DOUBLE_CLICK_INTERVAL)
        }

        lastClickTime = now
    }
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ›ï¸ Custom Actions ì¶”ê°€
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// Custom Actions ì¶”ê°€
private fun updatePlaybackState(state: Int) {
    val stateBuilder = PlaybackStateCompat.Builder()
        .setState(state, player.currentPosition.toLong(), 1.0f)
        .setActions(
            PlaybackStateCompat.ACTION_PLAY or
            PlaybackStateCompat.ACTION_PAUSE or
            PlaybackStateCompat.ACTION_SKIP_TO_NEXT or
            PlaybackStateCompat.ACTION_SKIP_TO_PREVIOUS or
            PlaybackStateCompat.ACTION_SEEK_TO
        )

    // Custom Action 1: ì¢‹ì•„ìš”
    val likeAction = PlaybackStateCompat.CustomAction.Builder(
        "ACTION_LIKE",
        "Like",
        R.drawable.ic_favorite
    ).build()

    // Custom Action 2: ì¬ìƒ ì†ë„ ì¡°ì ˆ
    val speedAction = PlaybackStateCompat.CustomAction.Builder(
        "ACTION_SPEED",
        "Speed",
        R.drawable.ic_speed
    ).build()

    // Custom Action 3: ë°˜ë³µ ëª¨ë“œ
    val repeatAction = PlaybackStateCompat.CustomAction.Builder(
        "ACTION_REPEAT",
        "Repeat",
        R.drawable.ic_repeat
    ).build()

    stateBuilder.addCustomAction(likeAction)
    stateBuilder.addCustomAction(speedAction)
    stateBuilder.addCustomAction(repeatAction)

    mediaSession?.setPlaybackState(stateBuilder.build())
}

// Custom Action ì²˜ë¦¬
private val mediaSessionCallback = object : MediaSessionCompat.Callback() {
    override fun onCustomAction(action: String?, extras: Bundle?) {
        when (action) {
            "ACTION_LIKE" -> {
                // ì¢‹ì•„ìš” í† ê¸€
                val currentTrack = getCurrentTrack()
                currentTrack.isFavorite = !currentTrack.isFavorite
                saveFavorite(currentTrack)
                updateNotification()
            }
            "ACTION_SPEED" -> {
                // ì¬ìƒ ì†ë„ ìˆœí™˜ (1.0x â†’ 1.25x â†’ 1.5x â†’ 2.0x)
                playbackSpeed = when (playbackSpeed) {
                    1.0f -> 1.25f
                    1.25f -> 1.5f
                    1.5f -> 2.0f
                    else -> 1.0f
                }
                player.setPlaybackParams(player.playbackParams.setSpeed(playbackSpeed))
            }
            "ACTION_REPEAT" -> {
                // ë°˜ë³µ ëª¨ë“œ ìˆœí™˜ (OFF â†’ ONE â†’ ALL)
                repeatMode = when (repeatMode) {
                    Player.REPEAT_MODE_OFF -> Player.REPEAT_MODE_ONE
                    Player.REPEAT_MODE_ONE -> Player.REPEAT_MODE_ALL
                    else -> Player.REPEAT_MODE_OFF
                }
                player.repeatMode = repeatMode
            }
        }
    }

    override fun onSetRepeatMode(repeatMode: Int) {
        // ë°˜ë³µ ëª¨ë“œ ì„¤ì •
        player.repeatMode = repeatMode
    }

    override fun onSetShuffleMode(shuffleMode: Int) {
        // ì…”í”Œ ëª¨ë“œ ì„¤ì •
        player.shuffleModeEnabled = (shuffleMode == PlaybackStateCompat.SHUFFLE_MODE_ALL)
    }

    override fun onSetRating(rating: RatingCompat?) {
        // ë³„ì /ì¢‹ì•„ìš” ì²˜ë¦¬
        rating?.let {
            if (it.isRated) {
                saveRating(getCurrentTrack(), it)
            }
        }
    }
}</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ“‹ Queue ê´€ë¦¬
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// Queue ê´€ë¦¬
private fun updateQueue(tracks: List<Track>) {
    val queue = tracks.mapIndexed { index, track ->
        MediaSessionCompat.QueueItem(
            MediaDescriptionCompat.Builder()
                .setMediaId(track.id)
                .setTitle(track.title)
                .setSubtitle(track.artist)
                .setIconUri(track.albumArtUri)
                .build(),
            index.toLong()
        )
    }

    mediaSession?.setQueue(queue)
    mediaSession?.setQueueTitle("Now Playing")
}

// Queue íƒìƒ‰
private val mediaSessionCallback = object : MediaSessionCompat.Callback() {
    override fun onSkipToQueueItem(id: Long) {
        // Queue ë‚´ íŠ¹ì • ì•„ì´í…œìœ¼ë¡œ ì´ë™
        val track = playlist[id.toInt()]
        playTrack(track)
    }

    override fun onAddQueueItem(description: MediaDescriptionCompat?) {
        // Queueì— íŠ¸ë™ ì¶”ê°€
        description?.let {
            val track = getTrackFromDescription(it)
            playlist.add(track)
            updateQueue(playlist)
        }
    }

    override fun onRemoveQueueItem(description: MediaDescriptionCompat?) {
        // Queueì—ì„œ íŠ¸ë™ ì œê±°
        description?.let {
            playlist.removeAll { track -> track.id == it.mediaId }
            updateQueue(playlist)
        }
    }
}</code></pre>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>ğŸ’¡ ë¯¸ë””ì–´ ë²„íŠ¼ ë° ì»¤ìŠ¤í…€ ëª…ë ¹ í•µì‹¬ í¬ì¸íŠ¸:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>MediaButtonReceiver</strong>: AndroidManifest.xml ë“±ë¡ í•„ìˆ˜, handleIntent()ë¡œ ì²˜ë¦¬</li>
                    <li><strong>í—¤ë“œì…‹ ë²„íŠ¼</strong>: KEYCODE_HEADSETHOOKìœ¼ë¡œ ì‹±ê¸€/ë”ë¸”/íŠ¸ë¦¬í”Œ í´ë¦­ êµ¬ë¶„</li>
                    <li><strong>Custom Actions</strong>: Notification ë° Auto/Wearì— ìë™ í‘œì‹œ, ìµœëŒ€ 5ê°œ ê¶Œì¥</li>
                    <li><strong>Queue ê´€ë¦¬</strong>: setQueue()ë¡œ ì¬ìƒ ëª©ë¡ ë…¸ì¶œ, Auto/Wearì—ì„œ íƒìƒ‰ ê°€ëŠ¥</li>
                    <li><strong>Media3 ìë™í™”</strong>: Media3ëŠ” ë¯¸ë””ì–´ ë²„íŠ¼ ë° Queueë¥¼ ìë™ìœ¼ë¡œ ì²˜ë¦¬</li>
                </ul>
            </div>
        </section>

        <!-- Section 11: Performance Profiling & Debugging -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">11</span>
                ì„±ëŠ¥ í”„ë¡œíŒŒì¼ë§ ë° ë””ë²„ê¹…
            </h2>
            <p class="section-description">
                MediaSessionì˜ ì„±ëŠ¥ ë¶„ì„ ë° ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ë„êµ¬ì™€ ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-bottom: 20px;">
                ğŸ“Š dumpsys ëª…ë ¹ì–´
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;"># ëª¨ë“  MediaSession ì •ë³´ ì¡°íšŒ
adb shell dumpsys media.session

# í™œì„±í™”ëœ MediaSessionë§Œ ë³´ê¸°
adb shell dumpsys media.session | grep -A 20 "Active sessions"

# íŠ¹ì • ì•±ì˜ MediaSession
adb shell dumpsys media.session | grep -A 30 "com.example.musicapp"

# MediaController ì •ë³´
adb shell cmd media_session list-sessions

# ë³¼ë¥¨ ë° AudioFocus ìƒíƒœ
adb shell dumpsys audio | grep -i "focus"</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ”§ adb ë¯¸ë””ì–´ ì œì–´ ëª…ë ¹ì–´
            </h3>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;"># MediaSession ëª©ë¡ ì¡°íšŒ
adb shell cmd media_session list-sessions

# ì¬ìƒ/ì¼ì‹œì •ì§€ í† ê¸€
adb shell cmd media_session dispatch play
adb shell cmd media_session dispatch pause

# ë‹¤ìŒ/ì´ì „ íŠ¸ë™
adb shell cmd media_session dispatch next
adb shell cmd media_session dispatch previous

# ë³¼ë¥¨ ì¡°ì ˆ
adb shell cmd media_session volume --show
adb shell cmd media_session volume --set 10

# ë¯¸ë””ì–´ ë²„íŠ¼ ì‹œë®¬ë ˆì´ì…˜
adb shell input keyevent KEYCODE_MEDIA_PLAY_PAUSE
adb shell input keyevent KEYCODE_MEDIA_NEXT
adb shell input keyevent KEYCODE_HEADSETHOOK</code></pre>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ
            </h3>

            <div class="highlight-box">
                <table style="width: 100%; margin-top: 15px; border-collapse: collapse;">
                    <thead>
                        <tr style="background: var(--bg-secondary); border-bottom: 2px solid var(--accent-primary);">
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">ì¦ìƒ</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">ì›ì¸</th>
                            <th style="padding: 12px; text-align: left; color: var(--accent-primary);">í•´ê²° ë°©ë²•</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Notificationì— ì¬ìƒ ì»¨íŠ¸ë¡¤ì´ ì•ˆ ë³´ì„</strong></td>
                            <td style="padding: 10px;">MediaStyle ë¯¸ì„¤ì • ë˜ëŠ” setMediaSession() ëˆ„ë½</td>
                            <td style="padding: 10px;">1. NotificationCompat.MediaStyle() ì‚¬ìš©<br>2. setMediaSession(token) í˜¸ì¶œ<br>3. addAction()ìœ¼ë¡œ ë²„íŠ¼ ì¶”ê°€</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>Android Autoì— ì•±ì´ ì•ˆ ë‚˜íƒ€ë‚¨</strong></td>
                            <td style="padding: 10px;">MediaBrowserService ë¯¸êµ¬í˜„ ë˜ëŠ” onGetRoot() null ë°˜í™˜</td>
                            <td style="padding: 10px;">1. MediaBrowserServiceCompat ìƒì†<br>2. onGetRoot()ì—ì„œ BrowserRoot ë°˜í™˜<br>3. AndroidManifest.xmlì— intent-filter ì¶”ê°€</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>í—¤ë“œí° ë²„íŠ¼ì´ ì‘ë™ ì•ˆ í•¨</strong></td>
                            <td style="padding: 10px;">MediaButtonReceiver ë¯¸ë“±ë¡ ë˜ëŠ” FLAG ëˆ„ë½</td>
                            <td style="padding: 10px;">1. AndroidManifest.xmlì— receiver ë“±ë¡<br>2. FLAG_HANDLES_MEDIA_BUTTONS ì„¤ì •<br>3. setMediaButtonReceiver() í˜¸ì¶œ</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì¬ìƒì´ ë©ˆì¶¤</strong></td>
                            <td style="padding: 10px;">Foreground Service ë¯¸ì‚¬ìš©</td>
                            <td style="padding: 10px;">1. startForeground(id, notification) í˜¸ì¶œ<br>2. FOREGROUND_SERVICE ê¶Œí•œ ì¶”ê°€<br>3. Android 12+ FOREGROUND_SERVICE_MEDIA_PLAYBACK íƒ€ì… ì„¤ì •</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ë‹¤ë¥¸ ì•±ì´ ì¬ìƒ ì¤‘ì¼ ë•Œ ì†Œë¦¬ê°€ ê²¹ì¹¨</strong></td>
                            <td style="padding: 10px;">AudioFocus ë¯¸ìš”ì²­</td>
                            <td style="padding: 10px;">1. requestAudioFocus() í˜¸ì¶œ<br>2. OnAudioFocusChangeListener êµ¬í˜„<br>3. AUDIOFOCUS_LOSS ì‹œ ì¬ìƒ ì •ì§€</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>PlaybackState ì—…ë°ì´íŠ¸ê°€ UIì— ë°˜ì˜ ì•ˆ ë¨</strong></td>
                            <td style="padding: 10px;">setPlaybackState() ë¯¸í˜¸ì¶œ ë˜ëŠ” Callback ë¯¸ë“±ë¡</td>
                            <td style="padding: 10px;">1. setState() í›„ setPlaybackState() í˜¸ì¶œ<br>2. MediaController.Callback ë“±ë¡<br>3. onPlaybackStateChanged() êµ¬í˜„</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 10px;"><strong>ì•¨ë²” ì•„íŠ¸ê°€ í‘œì‹œ ì•ˆ ë¨</strong></td>
                            <td style="padding: 10px;">MediaMetadataì— METADATA_KEY_ALBUM_ART ëˆ„ë½</td>
                            <td style="padding: 10px;">1. MediaMetadata.Builder.putBitmap() ì‚¬ìš©<br>2. Bitmap í¬ê¸° ì ì ˆíˆ ì¡°ì • (512x512 ê¶Œì¥)<br>3. setMetadata() í˜¸ì¶œ</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px;"><strong>Serviceê°€ ì¦‰ì‹œ ì¢…ë£Œë¨</strong></td>
                            <td style="padding: 10px;">MediaSession isActive = false ë˜ëŠ” Foreground Service ë¯¸ì„¤ì •</td>
                            <td style="padding: 10px;">1. mediaSession.isActive = true ì„¤ì •<br>2. ì¬ìƒ ì‹œì‘ ì‹œ startForeground()<br>3. onTaskRemoved()ì—ì„œ stopSelf() ë°©ì§€</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ“ˆ ì„±ëŠ¥ ë©”íŠ¸ë¦­
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">â±ï¸</span>
                        Latency
                    </h3>
                    <div class="card-description">
                        <p><strong>ëª…ë ¹ ì‘ë‹µ ì‹œê°„</strong></p>
                        <ul>
                            <li><strong>Play ëª…ë ¹</strong>: &lt;100ms</li>
                            <li><strong>Pause ëª…ë ¹</strong>: &lt;50ms</li>
                            <li><strong>Seek ëª…ë ¹</strong>: &lt;200ms</li>
                            <li>Binder IPC ì˜¤ë²„í—¤ë“œ ì¸¡ì •</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ’¾</span>
                        Memory Usage
                    </h3>
                    <div class="card-description">
                        <p><strong>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</strong></p>
                        <ul>
                            <li><strong>MediaSession</strong>: ~500KB</li>
                            <li><strong>MediaController</strong>: ~200KB</li>
                            <li><strong>Notification</strong>: ~1MB (Bitmap í¬í•¨)</li>
                            <li>Android Profilerë¡œ ëª¨ë‹ˆí„°ë§</li>
                        </ul>
                    </div>
                </card>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”‹</span>
                        Battery Impact
                    </h3>
                    <div class="card-description">
                        <p><strong>ë°°í„°ë¦¬ ì˜í–¥</strong></p>
                        <ul>
                            <li>Foreground Service ì™€ì¼€ë½</li>
                            <li>Notification ì—…ë°ì´íŠ¸ ë¹ˆë„ ìµœì í™”</li>
                            <li>AudioFocus ì ì ˆíˆ í•´ì œ</li>
                            <li>Battery Historian ë¶„ì„</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“Š</span>
                        Binder Transactions
                    </h3>
                    <div class="card-description">
                        <p><strong>IPC íŠ¸ëœì­ì…˜</strong></p>
                        <ul>
                            <li>Systraceì—ì„œ binder_transaction í™•ì¸</li>
                            <li>ëŒ€ëŸ‰ ë©”íƒ€ë°ì´í„° ì „ì†¡ ì‹œ ì£¼ì˜</li>
                            <li>Bitmapì€ 1MB ì´í•˜ ê¶Œì¥</li>
                            <li>ê³¼ë„í•œ ìƒíƒœ ì—…ë°ì´íŠ¸ ë°©ì§€</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="warning-box" style="margin-top: 30px;">
                <strong>ğŸ’¡ ë””ë²„ê¹… Best Practices:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li>dumpsys media.sessionìœ¼ë¡œ í™œì„± ì„¸ì…˜ ìƒíƒœ ì‹¤ì‹œê°„ í™•ì¸</li>
                    <li>adb cmd media_sessionìœ¼ë¡œ ëª…ë ¹ í…ŒìŠ¤íŠ¸ (UI ì—†ì´ ë””ë²„ê¹… ê°€ëŠ¥)</li>
                    <li>Android Auto Desktop Head Unit (DHU)ë¡œ Auto í™˜ê²½ ì‹œë®¬ë ˆì´ì…˜</li>
                    <li>Logcat í•„í„°: <code>adb logcat -s MediaSession MediaController</code></li>
                    <li>Media3ëŠ” ìì„¸í•œ ë¡œê·¸ ì œê³µ, ExoPlayer ë¡œê·¸ë„ í•¨ê»˜ í™•ì¸</li>
                </ul>
            </div>
        </section>

        <!-- Section 12: AOSP Source Code Reference -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">12</span>
                AOSP ì†ŒìŠ¤ ì½”ë“œ ì°¸ì¡°
            </h2>
            <p class="section-description">
                MediaSession êµ¬í˜„ì„ ì´í•´í•˜ê¸° ìœ„í•œ AOSP ì†ŒìŠ¤ ì½”ë“œ ìœ„ì¹˜ì™€ í•µì‹¬ ë¡œì§ì„ ì†Œê°œí•©ë‹ˆë‹¤.
            </p>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-bottom: 20px;">
                ğŸ“‚ ì£¼ìš” ì†ŒìŠ¤ íŒŒì¼ ìœ„ì¹˜
            </h3>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“±</span>
                        Framework (Java)
                    </h3>
                    <div class="card-description">
                        <p><strong>Public API</strong></p>
                        <pre style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.75rem; margin-top: 10px;"><code>frameworks/base/media/java/android/media/session/
â”œâ”€â”€ MediaSession.java
â”œâ”€â”€ MediaController.java
â”œâ”€â”€ MediaSessionManager.java
â”œâ”€â”€ PlaybackState.java
â””â”€â”€ MediaMetadata.java</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">âš™ï¸</span>
                        System Service (Java)
                    </h3>
                    <div class="card-description">
                        <p><strong>MediaSessionService</strong></p>
                        <pre style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.75rem; margin-top: 10px;"><code>frameworks/base/services/core/java/com/android/server/media/
â”œâ”€â”€ MediaSessionService.java
â”œâ”€â”€ MediaSessionRecord.java
â””â”€â”€ MediaSessionStack.java</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“š</span>
                        AndroidX (Legacy)
                    </h3>
                    <div class="card-description">
                        <p><strong>MediaSessionCompat</strong></p>
                        <pre style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.75rem; margin-top: 10px;"><code>androidx/media/media/src/main/java/androidx/media/
â”œâ”€â”€ MediaSessionCompat.java
â”œâ”€â”€ MediaControllerCompat.java
â””â”€â”€ MediaBrowserServiceCompat.java</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš€</span>
                        Media3
                    </h3>
                    <div class="card-description">
                        <p><strong>androidx.media3.session</strong></p>
                        <pre style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.75rem; margin-top: 10px;"><code>androidx/media3/libraries/session/src/main/java/
â”œâ”€â”€ MediaSession.kt
â”œâ”€â”€ MediaController.kt
â””â”€â”€ MediaSessionService.kt</code></pre>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--accent-primary); font-size: 1.5rem; margin-top: 40px; margin-bottom: 20px;">
                ğŸ’» í•µì‹¬ ì½”ë“œ ìŠ¤ë‹ˆí«
            </h3>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                1. MediaSessionService.java (System Service)
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// frameworks/base/services/core/java/com/android/server/media/MediaSessionService.java

public class MediaSessionService extends SystemService {
    private final SessionManagerImpl mSessionManagerImpl;

    @Override
    public void onStart() {
        publishBinderService(Context.MEDIA_SESSION_SERVICE, mSessionManagerImpl);
    }

    // MediaSession ìƒì„± ìš”ì²­ ì²˜ë¦¬
    public ISession createSession(String packageName, ISessionCallback cb, String tag) {
        final int uid = Binder.getCallingUid();
        final int pid = Binder.getCallingPid();

        // MediaSessionRecord ìƒì„± (ì‹¤ì œ ì„¸ì…˜ ê°ì²´)
        MediaSessionRecord session = new MediaSessionRecord(uid, pid, packageName, cb, tag);

        // MediaSessionStackì— ì¶”ê°€ (ìš°ì„ ìˆœìœ„ ê´€ë¦¬)
        mSessionStack.addSession(session);

        return session.getSessionBinder();
    }

    // í™œì„± MediaSession ëª©ë¡ ê´€ë¦¬
    private final class MediaSessionStack {
        private final ArrayList<MediaSessionRecord> mSessions = new ArrayList<>();

        public void addSession(MediaSessionRecord record) {
            mSessions.add(record);
            clearCache();
            mHandler.post(MessageHandler.MSG_UPDATE_SESSIONS);
        }

        // ë¯¸ë””ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¼ìš°íŒ…
        public MediaSessionRecord getDefaultMediaButtonSession() {
            // ê°€ì¥ ìµœê·¼ í™œì„±í™”ëœ ì„¸ì…˜ ë°˜í™˜
            for (MediaSessionRecord record : mSessions) {
                if (record.isActive() && record.isPlaybackActive()) {
                    return record;
                }
            }
            return null;
        }
    }
}</code></pre>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                2. MediaSession.java (Framework API)
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// frameworks/base/media/java/android/media/session/MediaSession.java

public final class MediaSession {
    private final MediaSessionLegacyHelper mLegacyHelper;
    private final ISession mBinder;
    private final CallbackStub mCbStub;

    public void setCallback(Callback callback) {
        if (callback == null) {
            mCbStub.setMediaButtonReceiver(null);
        } else {
            mCbStub.setMediaButtonReceiver(
                callback.mMediaButtonReceiverComponentName, callback.mMediaButtonReceiverIntent);
        }
        mCallback = callback;
    }

    public void setPlaybackState(PlaybackState state) {
        mPlaybackState = state;
        try {
            // Binder IPCë¡œ System Serviceì— ì „ë‹¬
            mBinder.setPlaybackState(state);
        } catch (RemoteException e) {
            Log.wtf(TAG, "Dead object in setPlaybackState.", e);
        }
    }

    public void setMetadata(MediaMetadata metadata) {
        // Bitmap í¬ê¸° ê²€ì¦ (TransactionTooLargeException ë°©ì§€)
        if (metadata != null) {
            metadata = new MediaMetadata.Builder(metadata, mMaxBitmapSize).build();
        }
        try {
            mBinder.setMetadata(metadata);
        } catch (RemoteException e) {
            Log.wtf(TAG, "Dead object in setMetadata.", e);
        }
    }

    // Callback Stub (Binder IPC ìˆ˜ì‹ )
    private static final class CallbackStub extends ISessionCallback.Stub {
        @Override
        public void onPlay() {
            mCallback.onPlay();
        }

        @Override
        public void onPause() {
            mCallback.onPause();
        }

        @Override
        public void onCommand(String command, Bundle args, ResultReceiver cb) {
            mCallback.onCommand(command, args, cb);
        }
    }
}</code></pre>

            <h4 style="color: var(--text-primary); font-size: 1.2rem; margin-top: 30px; margin-bottom: 15px;">
                3. MediaController.java (Framework API)
            </h4>

            <pre style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; overflow-x: auto; border-left: 4px solid var(--accent-primary);"><code style="color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">// frameworks/base/media/java/android/media/session/MediaController.java

public final class MediaController {
    private final ISessionController mSessionBinder;
    private final TransportControls mTransportControls;

    // Transport Controls (ì¬ìƒ ì œì–´)
    public final class TransportControls {
        public void play() {
            try {
                mSessionBinder.play();
            } catch (RemoteException e) {
                Log.wtf(TAG, "Error calling play.", e);
            }
        }

        public void pause() {
            try {
                mSessionBinder.pause();
            } catch (RemoteException e) {
                Log.wtf(TAG, "Error calling pause.", e);
            }
        }

        public void seekTo(long pos) {
            try {
                mSessionBinder.seekTo(pos);
            } catch (RemoteException e) {
                Log.wtf(TAG, "Error calling seekTo.", e);
            }
        }
    }

    // Callback ë“±ë¡ (ìƒíƒœ ì—…ë°ì´íŠ¸ ìˆ˜ì‹ )
    public void registerCallback(Callback callback) {
        if (callback == null) {
            throw new IllegalArgumentException("callback must not be null");
        }
        try {
            mSessionBinder.registerCallbackListener(callback.mIControllerCallback);
        } catch (RemoteException e) {
            Log.e(TAG, "Dead object in registerCallback.", e);
        }
    }

    public static abstract class Callback {
        public void onPlaybackStateChanged(PlaybackState state) {}
        public void onMetadataChanged(MediaMetadata metadata) {}
        public void onQueueChanged(List<QueueItem> queue) {}
    }
}</code></pre>

            <div class="highlight-box" style="margin-top: 30px;">
                <strong>ğŸ”— AOSP ì†ŒìŠ¤ ì½”ë“œ íƒìƒ‰ ë§í¬:</strong>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/media/java/android/media/session/" target="_blank" style="color: var(--accent-primary);">MediaSession Framework (Java)</a></li>
                    <li><a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/core/java/com/android/server/media/" target="_blank" style="color: var(--accent-primary);">MediaSessionService (System Server)</a></li>
                    <li><a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:media/media/src/main/java/androidx/media/" target="_blank" style="color: var(--accent-primary);">MediaSessionCompat (AndroidX Legacy)</a></li>
                    <li><a href="https://github.com/androidx/media/tree/release/libraries/session/src/main/java/androidx/media3/session" target="_blank" style="color: var(--accent-primary);">Media3 Session (GitHub)</a></li>
                </ul>
            </div>
        </section>

        <!-- Section 13: Related Documentation -->
        <section class="content-section section">
            <h2 class="section-title">
                <span class="section-number">13</span>
                ê´€ë ¨ ìƒì„¸ ë¬¸ì„œ
            </h2>
            <p class="section-description">
                MediaSessionê³¼ ê´€ë ¨ëœ ë‹¤ë¥¸ ìƒì„¸ ë¬¸ì„œ í˜ì´ì§€ë¡œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>

            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ—ï¸</span>
                        Media Framework Core
                    </h3>
                    <div class="card-description">
                        <p>Android ë¯¸ë””ì–´ í”„ë ˆì„ì›Œí¬ì˜ ì „ì²´ ì•„í‚¤í…ì²˜ì™€ ê³„ì¸µ êµ¬ì¡°ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>Framework â†’ Native ê³„ì¸µ ìƒí˜¸ì‘ìš©</li>
                            <li>MediaPlayer, MediaRecorder API</li>
                            <li>Binder IPC í†µì‹ </li>
                        </ul>
                        <a href="media-framework-core.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ¥</span>
                        Media Playback Pipeline
                    </h3>
                    <div class="card-description">
                        <p>ë¯¸ë””ì–´ ì¬ìƒ íŒŒì´í”„ë¼ì¸, NuPlayer, ë²„í¼ ê´€ë¦¬ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>NuPlayer ì•„í‚¤í…ì²˜</li>
                            <li>ë²„í¼ ê´€ë¦¬ ë° Zero-Copy</li>
                            <li>PTS ê¸°ë°˜ A/V Sync</li>
                        </ul>
                        <a href="media-playback.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ”Š</span>
                        Audio Framework
                    </h3>
                    <div class="card-description">
                        <p>AudioFlinger, AudioPolicyServiceë¥¼ í¬í•¨í•œ ì˜¤ë””ì˜¤ ìŠ¤íƒì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>AudioTrack/AudioRecord API</li>
                            <li>AudioFlinger ë¯¹ì‹± íŒŒì´í”„ë¼ì¸</li>
                            <li>ì˜¤ë””ì˜¤ ë¼ìš°íŒ… ì •ì±…</li>
                        </ul>
                        <a href="audio-framework.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸš—</span>
                        Car Media Service
                    </h3>
                    <div class="card-description">
                        <p>Android Automotiveì˜ Car Media Serviceì™€ MediaSession í†µí•©ì„ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>CarMediaService ì•„í‚¤í…ì²˜</li>
                            <li>MediaSession ìš°ì„ ìˆœìœ„</li>
                            <li>Last Media & Autoplay</li>
                        </ul>
                        <a href="carmedia.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“</span>
                        MediaProvider
                    </h3>
                    <div class="card-description">
                        <p>ë¯¸ë””ì–´ ìŠ¤í† ë¦¬ì§€ ì ‘ê·¼, MediaStore, Scoped Storageë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>MediaStore API</li>
                            <li>Scoped Storage ë©”ì»¤ë‹ˆì¦˜</li>
                            <li>FUSE Passthrough</li>
                        </ul>
                        <a href="mediaprovider.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">
                        <span class="card-icon">ğŸ“±</span>
                        Media App Layer
                    </h3>
                    <div class="card-description">
                        <p>MediaPlayer, ExoPlayer, Media3 ë“± ì•± ë ˆì´ì–´ APIë¥¼ ë¹„êµí•©ë‹ˆë‹¤.</p>
                        <ul style="margin-top: 10px;">
                            <li>MediaPlayer vs ExoPlayer</li>
                            <li>Media3 í†µí•© ë¼ì´ë¸ŒëŸ¬ë¦¬</li>
                            <li>Best Practices</li>
                        </ul>
                        <a href="media-app-layer.html" style="display: inline-block; margin-top: 15px; padding: 8px 16px; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem;">
                            ìƒì„¸ ë³´ê¸° â†’
                        </a>
                    </div>
                </div>
            </div>

            <div class="highlight-box" style="margin-top: 40px;">
                <h3 style="color: var(--accent-primary); font-size: 1.2rem; margin-bottom: 15px;">
                    ğŸ“š ì¶”ê°€ í•™ìŠµ ë¦¬ì†ŒìŠ¤
                </h3>
                <ul style="padding-left: 20px;">
                    <li><strong>Android Developer - MediaSession</strong>: <a href="https://developer.android.com/guide/topics/media-apps/working-with-a-media-session" target="_blank" style="color: var(--accent-primary);">developer.android.com/guide/topics/media-apps</a></li>
                    <li><strong>Media3 ê³µì‹ ë¬¸ì„œ</strong>: <a href="https://developer.android.com/jetpack/androidx/releases/media3" target="_blank" style="color: var(--accent-primary);">androidx.media3</a></li>
                    <li><strong>Android Auto Developer ê°€ì´ë“œ</strong>: <a href="https://developer.android.com/training/cars/media" target="_blank" style="color: var(--accent-primary);">developer.android.com/training/cars/media</a></li>
                    <li><strong>Universal Android Music Player (UAMP) ìƒ˜í”Œ</strong>: <a href="https://github.com/android/uamp" target="_blank" style="color: var(--accent-primary);">github.com/android/uamp</a></li>
                </ul>
            </div>
        </section>

        <!-- Footer -->
        <footer
            style="text-align: center; padding: 40px 20px; color: var(--text-muted); border-top: 1px solid var(--border-color); margin-top: 60px;">
            <p>Android MediaSession Framework</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                í†µí•© ë¯¸ë””ì–´ ì¬ìƒ ì œì–´ í”„ë ˆì„ì›Œí¬
            </p>
            <div style="margin-top: 25px; display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                <a href="mediasession-api.html"
                    style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: linear-gradient(135deg, rgba(249, 115, 22, 0.2), rgba(0, 212, 255, 0.2)); border: 2px solid #f97316; border-radius: 12px; color: #f97316; text-decoration: none; font-weight: 600; font-size: 1rem; transition: all 0.3s ease;">
                    ğŸ¯ MediaSession API í”Œë¡œìš° â†’
                </a>
                <a href="index.html"
                    style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: rgba(26, 31, 53, 0.5); border: 2px solid var(--border-color); border-radius: 12px; color: var(--text-primary); text-decoration: none; font-weight: 600; font-size: 1rem; transition: all 0.3s ease;">
                    â† AOSP Media Framework
                </a>
            </div>
        </footer>
    </div>

    <script src="scripts/mermaid-theme.js"></script>
    <script>
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(30px)';
            section.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
            observer.observe(section);
        });
    </script>
    <!-- Navigation & Copy Features -->
    <script src="scripts/copy-code.js"></script>
    <script src="scripts/toc-generator.js"></script>
    <script src="scripts/page-navigation.js"></script>
    <!-- Interactive Diagram Features -->
    <script src="scripts/diagram-data.js"></script>
    <script src="scripts/diagram-interactive.js"></script>

    <script src="scripts/theme-toggle.js"></script>
</body>

</html>